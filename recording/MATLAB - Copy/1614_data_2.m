function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Oct-2016 12:04:21.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.3125;-84.8125;-179.5;-9.96;-12.03;-9.46;0.75;-88.875;-179.625;-24.89;-15.38;-15.21;0;-84.1875;-179.6875;-25.58;-20;-35.66;0.6875;-86.75;-179.125;-22.08;-25.25;-42.33;0.0625;-87.625;-179.375;-16.06;-27.97;-44.65;0.125;-87.375;-179.375;-19.82;-25.72;-42.46;0;-87.8125;-179.4375;-20.46;-28.91;-43.54;0.125;-86.125;-179.3125;-13.09;-29.9;-35.77;0;-87.8125;-179.25;-10.51;-17.61;-25.88;0.1875;-87.0625;-179.6875;-5.17;-8.34;-7.99];
x1_step1.gain = [0.00556328233657858;0.0129764801297648;0.00556909154194222;0.0822706705059646;0.0986193293885601;0.0681895669962496;0.00557103064066852;0.0124465188642552;0.00556424969570509;0.0376222723852521;0.0577200577200577;0.0431034482758621;0.00555941626129256;0.0127186009538951;0.00556618542355192;0.0336530371866061;0.0537923614846692;0.0303536196691455;0.00557200069650009;0.0125293657008614;0.00558561703613196;0.0426075841499787;0.0446428571428571;0.0276204944068499;0.00555941626129256;0.0125097732603597;0.00558659217877095;0.03813882532418;0.0442575791104227;0.0259437021662991;0.00556424969570509;0.0125638005496663;0.00557200069650009;0.0322268772155978;0.0419287211740042;0.027311211252219;0.00555941626129256;0.0125539427226363;0.00556618542355192;0.0316906987799081;0.0355808574986657;0.0270160745643658;0.00556134862704206;0.0126532226176354;0.00557588430040077;0.0382409177820268;0.0374041518608566;0.0299625468164794;0.00556038227628149;0.0125146656237779;0.00558659217877095;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00556231531374935;0.0125934671389217;0.00557394182198223;0.0446229361892012;0.0906207521522429;0.0518806744487678];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.1118514741019476;0.89928790911596168;-0.89593168117371158;-0.98775571912649962;-1.2831720077413329;-1.5064021211158329;-1.5948446629837694;-1.7795725293669564;-0.45467206079123146;0.80775775551655127;0.91614315198542806;-0.26297166382778636;-0.49700414321184677;-0.6347686762914313;1.0076630976616567;-0.834166591754535;2.2850460016475216;-1.8444091941578595;-1.4142607779986514;1.6540702738459332];
IW1_1 = [-0.038867317623367773 0.36381748040229162 1.0109952709766656 0.81524665170134258 -0.44209932954044617 0.18860472210214477 0.39334105140460041 0.40451445616945664 1.614066765008813 2.6006797143655591 -0.21232271544507939 0.40095816363138737 -0.49058519446885468 1.0377844950327961 1.074443882051582 1.6133797112981114 0.093740262954982667 0.61966978392609129 0.45617468059117788 1.2981289938500502 0.19929594848776136 1.0044767147203144 0.055597167329171998 0.28485811269496408 -0.081820013191063912 0.78047892444011335 -0.091227947586726144 1.1559746966587445 0.2363709960857284 -0.33290355536161859 0.25998445108472273 -0.20623779309014312 -0.78129952040072093 -0.22967640552842669 -0.08264740479708306 -0.22261411493770197 0.16202858366023987 -0.47161803864358326 -0.79156833480240474 -0.38900119620725104 -0.046627669986452513 -0.20518524728484369 -0.34516360747607749 -1.010584817641943 -1.0328640586404114 -0.78993086981380622 -0.54773381843558022 -0.66881872658354047 0.52866992573831806 -1.1969204330234018 -1.0782134701711699 -0.7783363052579978 0.04970732105845431 -0.10818160024784884 -0.4589700292581177 -1.0665232609334967 -0.6154681855091938 -0.23266898905292666 0.082937492886249783 0.48783941094899474;-0.337959879442847 -0.45849521190427384 0.33224519487405352 -0.21178860219987475 -0.038077426229715335 0.33559357844144017 -0.20124408479256342 0.12232605120255727 0.085195722541082375 -0.71543610767259891 0.51039108282499079 -0.50779701136189104 0.13450136003328181 -0.0030740713595523526 -0.16388836258437983 -0.61629537390589828 0.442700820699515 -0.87071893050931981 -0.47567220016262785 1.221505174144218 0.059814738705693649 -0.65919651418992009 0.5538621642083853 -0.0093612877022801588 -0.33217442371370476 1.3542991636157158 -0.025529497083944835 -0.78918184391183344 0.216008146096514 0.68484916590934608 0.21891610210036411 0.97740673103247466 0.14964569158456756 -0.85285806310852419 0.37653575156887753 0.34463950040491154 0.19057086954195085 1.2143851392256739 0.22393972474171828 -0.64805047739132748 -0.085946107667743452 -0.18847780203076253 -0.020860854962675784 1.0583057928540136 -0.091572044367929317 -0.22746765518039297 -0.005532804410892907 -0.0064897220745916574 0.32924884269355847 0.8263125162215923 0.021200608592341741 -0.25063135955757831 -0.11179448060978389 0.21918232338841653 0.1395695960933464 0.63617967625778815 -0.012880053776208367 -0.033096916594718737 -0.13400859480868296 0.088688490950523335;-0.45282540375095592 -0.26178005033319396 -0.071161338426852599 -0.18597619136399962 -0.11574168484813546 -0.55683690011087372 -0.98827178644794411 -0.52846055210718457 0.57537738038387631 0.27923564420693858 -0.07195254491216746 -0.94445601329444295 -0.42573057266568631 -0.57952704758996476 -0.13900399546569278 -0.17910961249267268 -0.47565068297462415 -0.39484417571301389 0.021818645816311745 -0.35825400743181224 -0.079718058664643626 -0.84044183566811292 -0.89098215277525716 -0.32976926030366882 -0.43764566378942116 0.010151417653066467 0.11089187992906335 -1.0057993760823323 -0.18594122867596585 -0.21057441907284119 0.090156398758631948 0.018687874350839691 0.18823959971548188 0.25013984809491246 0.30778800413810853 -0.003146690084803676 -0.069048701964297146 0.0066905439739673072 0.0060370379651329539 0.13977088991005593 -0.020139845838952168 0.32537500030561617 -0.20843495218711577 0.49546792988404947 -0.39497330222215971 -0.11777572152492236 0.61253539382370714 0.67033589453093112 -0.26825154011111052 0.3833174431103617 -0.15483985669412767 0.25346630485301552 0.19529787235192206 -0.1620009968269995 -0.011699754479802137 0.54714308100802067 -0.19445871675678056 -0.13689196452405578 0.15146570467681228 -0.18096539482670262;0.15167349120671894 0.038372442168846138 -0.027970751406975046 0.63941120063592871 0.0030169067180775113 -0.54166408473929128 0.6466803311209014 0.38865206961986448 -0.44799978428791226 0.62376434408587311 0.71827824884443103 -1.2650558838803325 0.14029253756344845 0.070851520563230103 0.2753854700713802 -0.15999849721697001 0.77323645496039639 -0.85663489762107392 0.03903132448945032 -0.13532838160260763 0.043484995793415991 0.20395958696236752 0.52407379734649295 -0.59423565097439945 -0.16038195338511646 -0.50691703756699313 -0.14872035404721035 0.18684472605589555 -0.098209333883172906 -0.4089756298687709 -0.11188138160643923 -0.36497407172898666 -0.88488647763953399 -0.090929583603184289 -1.0305268850837572 -0.12087370954423393 -0.35633160528345831 0.29036098713048319 0.040999445799112869 -0.5646999941658587 -0.87643231492788298 0.32489755368838114 -0.32696149973745797 0.75348465533618125 -0.34160903125482689 -0.28096615730784658 -1.1882890957107068 0.4774279501267632 -0.018037387533273514 0.9399768747867655 0.27793002876415318 -0.057263759496039401 -0.89923253314595297 0.24551093545838068 0.09312091031080022 0.42590680277437909 -0.16870611169078814 -0.40512449462757144 -0.77151077447201444 0.064683814418318608;0.19762972448825181 0.12463095916796217 -0.30703212336574498 -0.11976568921507652 -0.31111276606553612 0.35513033658123966 -0.20696252350337496 0.0053875342620726997 -0.087347118673865909 -0.18991804288468986 -0.36838806468987056 0.34627437514536863 -0.28022725205418864 0.19584428835745799 0.19036244356093335 0.15547717568591965 -0.20905887155048225 0.088476758656534371 0.38642772992579172 -0.11763059603996187 -0.082700779526108159 -0.34650108938636798 -0.27020911088195876 0.0015900791789973897 0.02402558957510946 0.32757163472923978 -0.00011701258208546175 0.091492798717617368 -0.13583705697414758 -0.028213381467153555 0.038307867517854817 -0.22717793766216279 0.046115651536116457 0.09632954651945469 0.12241004370971058 -0.021110139992697601 0.092293999714945535 0.10391679370589385 0.28348764352673222 -0.092606758336581899 -0.018175986460469723 -0.0089765145502052942 0.066154299036107755 -0.14368183311583407 0.38031310548643588 0.29382097179987449 -0.049168080894539661 -0.11531674521569517 0.0049847595699839473 0.18263286657161842 0.31815164472595242 0.29197439726528324 0.20701073518439936 -0.21528448018063409 -0.34147679224451005 -0.16462314238142181 0.08939072199437445 0.39079831896816747 -0.086178472824797347 0.37133527474432793;0.11422778566085047 -0.099843112173490858 0.85122151446068617 -0.20393905454922798 -0.11381219453300594 0.50221106719357267 0.018232596075766244 0.026092209550213116 0.55372749599949855 -1.1096383939966132 -0.73765770095851246 0.18364894589463254 0.3839517792371876 0.4200180928360519 1.3962298083328355 -0.16381931737447702 -0.00052092846213841297 0.6748403457928952 -0.13800868072734124 0.18036200214096051 0.55897635647810096 -0.8350015749933658 0.3955775658284163 0.45224930763832927 -0.40903117337526601 0.032833597479459339 -0.19129039413222601 -0.13172279444816565 0.030795589650541293 -0.26463668155371206 0.10693285944173032 -0.2020984325291009 -0.45716545462596697 -1.2358471245449358 0.49749536951695955 -0.18528799725180967 0.043055440318218695 0.11398533000467272 -0.78171955909920476 -0.94331998015779617 0.4013911265236127 0.12694845190092041 0.17052645913674289 0.037259532985030541 -0.51424713368038411 -0.90483232334467911 0.27619815120711017 -0.18713307834014686 -0.16305494950528665 -0.56682935182561545 -0.70264868007332493 -0.52739139379632038 0.44854326055591992 0.33687497463190974 -0.27216951767215625 -0.95874440789545967 -1.0093885880027618 -0.2310257927258646 -0.10935470911622332 0.36708853234443167;-0.051359377972590263 0.070024118111533099 0.17418532471843756 0.26201759401411889 0.017071217801101525 0.15461915963047781 -0.28737263895958554 -0.2634266419336217 -0.20287987452137507 0.23456023291068215 0.41392348381306648 0.18054713515367063 0.06257962803713181 0.2854340090461851 0.031081590151185459 -0.21830833494742125 -0.033499498975912582 -0.095790931521117881 0.066873515880951959 -0.16406803790065405 -0.019592612309436191 -0.067810230072263 0.31665669395172363 -0.048017492162453643 -0.089537931885466368 -0.021475879498283442 -0.35720312360814965 0.04119499081091553 -0.1407949730790711 -0.30937409216807604 0.19412824456934166 0.069871333736896746 0.049504838873552517 -0.10617129252327476 -0.34040739346521887 -0.049257152397651181 0.0082646276988268749 0.004935965004844084 0.018967938373176025 -0.060905807217027354 -0.14971624723487548 -0.14220964481163401 -0.13663423983498024 0.23249735406232744 0.10804004265127089 0.20517663104198083 0.065408842585695806 -0.12167257388773976 0.039511959724409532 0.14923135065962029 0.10347328514130869 0.59809006254542973 0.004660282046977238 -0.032653740322903094 0.036533821946548736 -0.12550297282808923 -0.32411519288561613 0.5283641071883195 0.02733851820312419 0.14463461510936759;0.40813786991221845 -0.66026363505141439 0.15739210845694096 -0.86657397769635436 0.41944640527946286 0.49767593831811374 -0.066969464800807302 -0.78378475581069285 0.015706269145812551 -1.7347643755284194 0.43911323425197268 -0.14490653339606416 -0.18120151562336453 -0.33872622185845641 -0.15127290894949297 -2.2366297072851071 0.31627279375256995 0.61842555714788283 0.62662512149546101 -0.05926326489224621 -0.16146515250539231 -2.1548207381002893 0.68385792719477778 0.49729516431113618 0.2546329907589383 0.47754491511420988 -0.43527428816979702 -1.0849188037277904 0.29757108033008445 -0.36397439515359087 -0.19768698153968672 0.10036950375928885 0.76914643922678716 -1.1935071575532132 0.68983123547801062 0.13073854494875226 -0.26045215458862869 0.14438222649387866 -0.088389125796885487 -1.2498701452700951 0.47558756144782777 0.5564386990897926 0.40232911623253231 -0.14213434071194095 -0.18343588140703038 -0.56690108886918278 0.61529826157478784 0.82420189428918034 -0.27003032720245812 -1.0099932838027446 -0.03230629053064555 -0.15431128293519442 0.47220887393089384 0.78282042611494829 -0.38261144896691479 -1.5227236622741953 -0.15481600859517364 0.20692991990988455 -0.010621309609602961 0.36626473618402022;-0.27587099167725498 0.19501658921682161 -0.73939270276952263 -1.1192313113643968 -0.18174530684862267 0.49691442238745587 -0.033571625884174977 0.075347852288311465 -0.74121099009360469 -1.0340820098956764 0.31762933825885648 0.12856698586500123 -0.16174814064658349 0.19265004506530939 -0.43400339427583534 -0.80658729282291897 0.31517057404613846 0.1807470674662944 0.19758743085999295 0.092070143440702815 -0.23717533537619287 -1.4315742335383446 0.12308277247671159 0.046215606158069689 -0.11459053313164665 0.082881970763299201 0.50099369929458382 -0.94305628180644119 0.088462345182134208 -0.10971941957735441 0.12176400015352386 0.012427248553152734 0.47201736595894356 -0.36338925004118411 0.19347507335618588 -0.23422685787371639 0.0633133331564701 -0.24042106779731195 0.27493462210487757 0.2046005938478335 0.19408287380365316 -0.24968790946345262 -0.045961972972125772 0.34845485678048049 0.40256994903221022 0.1083933318324837 0.30942534761072876 -0.26067273122291185 -0.089993150805658756 -0.23020311349906064 0.44366473046771299 0.037300227096456029 0.19893775012848353 -0.010623103217586626 0.17090062611295492 -0.52203925225845516 0.65260329254404414 0.60126817248554587 0.19400200105405466 0.39902023436651285;0.11817546289754884 -0.84312783697742444 0.11043568686466647 -1.7809501046126324 0.098890340928761131 -0.12924251868542522 -0.36302663398006146 -0.29043325338952064 -0.1651624993738445 -3.0963233741306633 -1.7089615983053386 -0.58804549780817983 -0.21035618122810956 -0.32799985667463039 -0.30716485331986132 -1.8316654722304748 -1.5913137945288323 0.0069392561027379306 0.097565635248571703 -0.37202592820289471 0.21048882763419516 -0.039365490633211514 -0.22846346268433107 0.073609374340674813 0.33125836632641775 -0.28835043964941781 0.058791986532387444 -0.14583754034796895 0.14003465113729691 0.0077097291912453193 0.060580025149759346 -0.36329906684756574 0.77763035541259107 -0.36960365822359359 1.0695954707911512 0.093499422432771775 -0.20925967651768126 0.33808804409184429 0.79369666097976987 0.91600112663028843 0.80570308706019544 0.087665066331504088 0.11719869024266683 0.29559687291376363 0.63758086955794879 1.0852868029901364 2.2741758527439382 0.3266786552436412 0.013665866249210911 0.76552398793216625 0.084076664690156233 1.104874884183537 1.5707932810894347 -0.37289770567674579 -0.039918480149988014 0.46654876005354801 0.41405786423214719 0.80009563486376245 1.8467613559687637 -0.53262814146355841;1.78156391313981 0.2328708880546832 -0.38092658320098505 0.6079858739641012 -0.25866634378594888 -0.56877584903560052 1.6487980105941422 -0.25430284549035115 0.20586975975796715 1.829031254320076 -0.46243529299854974 0.19367563105844507 0.88709632002778926 -0.49776051278974348 -0.17563378213486494 1.4815008245325294 -0.96242584508977991 0.15343648652220332 0.047143743215482259 0.13852688372762251 -0.39671132737157805 1.1104841120750486 -1.0436360740309523 0.086886750989630418 -0.83545936502208762 0.26609490351821652 0.089145595784099863 0.8908008013135903 -0.66894175242838583 0.37113513519447083 -0.48350963877949826 0.050028906589879733 0.17359851359568193 1.1962561267482812 0.23274334015919057 -0.14201210590202137 0.10843025795167355 -0.056794025680923045 0.011049266637921815 0.75017968621772291 0.56563528428312138 -0.34161914871623922 -1.3606116892599884 -0.070105851230841482 0.3016614024631617 -0.084472306299632663 0.94555392513356951 0.055508960180707577 -0.38030533580371439 0.21534014167458654 -0.086141048047857396 -0.19138134188200712 0.50868254824926418 -0.050430256049349906 -1.6216518886461238 0.093515707324602737 0.1390383026026859 -0.34508625259933601 1.225737565089148 0.0019090270417793757;0.10367280803367004 0.2822153654475793 -0.1546844161685445 0.11361542845873729 -0.045148536927351962 0.20624574912346319 0.1289152191996204 0.046261696450424258 -0.20770527625306212 -0.19325194345932209 0.47270220821619752 0.55330350135950013 -0.021537812728311248 0.088605029415780384 0.055880497568722577 -0.18737160487499308 0.14100613741138365 0.51254854777957948 -0.009985623844758049 -0.044522626388130593 0.23648381561337251 1.3285499756280554 0.46572634935659313 0.68976883306627601 -0.198477131216027 -0.13322373781259805 0.42169445299362335 0.88084357545767411 0.24757183729360613 0.073090817613532907 -0.38742395845574262 -0.26340322653291731 0.095093372719305347 -0.29569729904230413 -0.49410421672474225 0.0076013443047943767 -0.81765547084809787 -0.52875271228604581 0.0049592867583172738 -0.090832609014233193 -0.076335295180674667 -0.52099154428103323 0.12274391189903686 -0.22460152916671214 0.33650220541874087 0.25412887453229693 -0.82966507818194735 -0.088769241626194123 -0.30650097234490098 -0.60034598604747003 -0.23952831936139207 0.051186309534913536 -0.19738192109540972 0.25642121831033482 -0.095275196222878999 -0.54254095405363212 0.61647829682963851 -0.71158085048747788 -0.31953347362984352 -0.059511055671603599;-0.093371671867529898 -0.86339193075914222 0.28241909771534912 -0.062492044755224956 0.17588853259439344 0.61231897264235902 -0.075828637987285702 -0.45615097972641316 0.42611393235296108 -0.26744234060813282 -0.10872829474706923 -0.085557059086714252 -0.31350447460982345 -0.18462633716236512 0.92933401321839826 -0.45121969514102556 -0.018420293071395373 0.21708506032654856 -0.5356462308011023 0.025588148813492501 1.1158538059356353 -0.18620877194592536 0.49673202186575843 -0.36090849787761714 -0.52717143161274183 0.035310825968308264 0.17053660382112265 0.41090480559777876 0.27900286631601506 -0.081042031562530648 0.054302499370009472 -0.036892033961533746 -0.29296143692308707 -0.2216044540362013 0.29547167893750576 -0.010579624117613675 -0.25430685366656136 0.30553207050105557 0.00080091630076875499 -0.30791010806168329 0.14031751784184768 0.20564968036355041 -0.053983157287509631 -0.13663353674668882 -0.039186547534024216 0.033942644182087249 -0.23287635295905681 0.083841118381009216 0.32670847271154269 -0.34622445918212036 -0.30433356811982737 0.63899822652055094 0.17544462953455767 0.21902049148507668 0.029197992768614359 -0.14418790446162505 0.13088965408165729 0.25284398018937282 0.24765140848343106 0.62559070638248249;-0.25900047440227203 -0.61947634514636085 -0.31331270649957665 0.32066547355209513 0.4333370020652994 -0.16278552887949202 -0.29489227823057862 -0.26830014028650012 -0.12572516670398748 0.3506090363221897 2.3975690348687513 -0.6536679146429285 0.017194987170188802 -0.29436173600154691 -0.72508064837017927 -0.35539669948090724 0.5655891117853511 -0.76842857154645794 0.36061570234194601 -0.21041782800693926 -0.047774730096850952 0.85211225625612574 0.78288105115264972 -0.5731425831293353 0.010863475849073378 -0.030607063165581018 0.39889388940204512 0.42207167015844871 0.46147451315862459 -0.05497980637237903 0.099597684706006176 -0.17181613919828823 1.2969799316898512 0.44266798910241734 -0.090074382242304615 0.37223825493738755 0.28422410310103552 0.099198909620560577 1.5153110191803065 0.2037573157359327 -0.60298802645067051 0.45095240780517859 -0.25380105216938331 0.16347264182482027 0.84955704543027089 0.41544110809885626 -1.5045014303247775 0.23134189666107371 -0.062220464475334636 0.079534948052043947 1.1378507939363676 0.14946694704069291 -1.0121297598719685 0.01977652348649377 0.1539195663721423 -0.17596524227981722 2.3805863838977657 -0.17083847921917067 -0.74062117268343997 -0.13269706036763826;0.47999101991277709 -0.20018069032431571 -0.51798648532356173 -0.86616197336642875 0.36413892079655363 0.23253020117631973 0.16811551209476555 -0.010508172934282328 -0.13738369365406147 -0.67613572941931621 -0.25187337705306367 0.13800532902454485 0.02430050170526929 0.37298658937463941 0.2347252031253082 -0.10172243399170998 0.29495980215717688 0.34216569512295919 -0.18894987096790494 0.577828033924073 -0.39452079863050177 -0.67019297303550218 0.39629235677637309 -0.14643488145287936 0.034335696724419988 0.3532256841982947 0.7276089963430713 -0.68550006354372262 0.76688791200237283 -0.044843974779859914 0.63606729935503281 0.12111822507106565 0.022528868120301158 -0.7622098375208094 0.51231849913260086 0.20428504042076667 0.58877239099997014 -0.27980706439640363 -0.32033259065250336 0.35285497152190698 0.26794029130891006 -0.14529509496778537 0.15252921366007671 -0.58349649566400164 -0.082065463569265348 -0.085968178401355538 0.45459467544421939 -0.2292581123234067 0.19725558229623458 -0.81499369368057484 -0.42544661879240847 -0.51226407523138306 -0.23951513342822664 -0.36199868298251653 -0.22103376773111763 -0.60955345008300121 -0.45516823319711414 -0.26989212930430306 0.35561713742351153 0.12628562657168954;-0.30941502321682079 -0.86186801248111233 0.83734597265758859 0.34634849273624602 0.2749027269870577 -0.21258940178216271 -0.43594781813727257 -0.54452111633065448 0.35389934395159439 0.87217531278072691 -0.87035077490796176 -0.78392894536667768 -0.15316530661060168 -1.098775025819823 1.5977975112531948 0.79747262265477814 -0.51302590594479536 -0.68373790957523806 0.21743751578848322 -0.99722608658468392 0.62510422484107553 0.8118771534607887 -0.65732449940001259 -0.51700299939698535 -0.12041139812199961 -0.57359821919285348 -0.75827904352814091 0.90303236406880882 -0.35912498177368773 -0.26386610171850666 0.58449345419435261 -0.33582201639523757 -1.0911944803038174 -0.8571924428722113 -0.28599566106455598 0.11326457865216297 0.10444200834932443 0.48473887507609248 -0.41702432905849235 -1.2506416998824124 0.079898403271567359 0.5944939628562913 -0.069698203416420468 0.42047755101835033 -0.45859796324520091 -0.46118292214528134 -0.14517970512314202 -0.20424719615200781 0.26674702801631051 1.2625941220412595 -0.40145027766750491 0.4502910575894411 0.26626002880703892 0.56472842392033917 -0.19595607841436599 1.1700063986249734 -0.46840434115023588 0.066674235477732366 0.20102340484535297 -0.21952941180385807;-0.020941456970182785 -0.69590418375091923 1.0449890044075651 -1.2299173289606107 -0.0026595419278681205 -0.09570280167607137 0.18108667105215187 -0.25571029810433138 1.279702196624529 -1.1510524881365529 -0.95858523085718883 0.035539936157927846 -0.52649609513115492 -0.79041827074914628 1.1594991908422174 -0.55015200501572736 0.95589622327540869 -0.80773758606410639 0.18680845477188374 -0.52176756246198752 0.44649709049250685 0.13521973531793993 1.3715214945747354 -0.78177333763992751 -0.18340381178304435 -0.24208948596285121 0.17622895935974778 -0.19543037973590976 0.20893429945650102 -0.14418841267660909 0.21210560316683491 0.018293242554915563 -0.62141860873449184 1.3335087786218893 -0.43775827526166933 0.18872606095172098 -0.050091837477778553 0.24816421705508188 -0.61768110035126589 1.7189743136603819 -0.39100998714720542 0.43890176277027443 -0.11507599062663325 0.23177775194555009 -1.1493190233517181 2.2648334642106933 -0.50616311865489272 -0.035212680605392184 0.031211671484474138 0.91943510859134936 -1.043397750019132 1.8448958348358895 -0.1304954910506797 -0.091660069492139798 0.10405941369193238 1.189745877762499 -1.2119900902456613 0.62326580746241866 0.82776527156325219 -0.60252327352622137;0.040358826866361441 0.43776720841533112 -0.22449867925539579 1.4162047511580722 -0.47672145382585335 0.31415108090004967 0.15477652060260486 0.46690608421224639 -0.019516897987634382 2.3052869019014963 -1.3550519609561662 0.19514797489503286 -0.38282689594067293 0.88555746841807204 -0.057751490486957276 1.5130918407824758 -1.1289892113499058 0.27626662928910523 -0.060656590360962312 0.45410600322602768 -0.11478111041061878 0.041960069747598625 -0.44864878327697755 0.17673818263877081 -0.13391663310355381 0.19613582818920799 -0.26792735968037529 0.13627749590025001 0.19919048669828318 0.13787009003776807 -0.18232762707813094 -0.0077966940053914909 0.94497622924741309 -0.72270164935153269 0.70344771608571388 -0.18192263431364938 0.12787389339836641 -0.1359645887468075 0.78445480567957837 -1.3892439806310701 0.50096214188011623 -0.23446303360889703 -0.37555647790830099 -0.14828582754106956 0.54021900355700303 -1.3740637089093359 0.82612766594852816 0.19908135139233182 0.36290952315552655 -0.8502537977631498 0.47985565667269747 -0.88037279406251245 0.79821712300883585 0.14744610697633989 0.41993410266322828 -0.83731002383420172 -0.22134894153952445 -0.54421601476653669 -0.0034673201582736887 0.033236468163389737;-0.24911067398227418 0.23186669670598212 0.41361947795547988 0.05975667751138336 0.15106906788525326 0.20243031493466987 -0.81547307028500393 0.13889709334751144 0.44035800553260707 0.3942358842617496 0.60770341667036343 -0.087003703078308139 -0.70671178168612703 -0.060818663817876942 -0.47537642804484115 0.094016225714425278 -0.53139594847116522 0.52096651636429836 0.023077425832196345 -0.16900108680816742 -0.7256816646248192 0.75494885902563125 -0.39227574042370955 0.62354351293863786 0.13187667061560185 -0.27532550697914426 -0.58996992047533547 0.91704279967464952 0.24722805550809979 0.63193261822740965 -0.067682286394466454 -0.027608775773011386 0.4069978818893219 0.19002528504606436 0.36700461084934038 0.023120786162198318 -0.00016609571559158339 -0.81192073531966014 0.18728791447187523 0.01108705555100481 0.2773288208501864 -0.082452268427266523 0.44454638083799042 -1.2165108492964143 -0.07078452635015231 -0.15249617795702741 0.17442264107657335 -0.1584740571001543 0.21500121852783169 -1.1928288196451773 -0.19710118888562728 -0.017658442894503631 0.43132282630706653 0.1457997380915356 0.27823684681886518 -1.3859221649465416 0.17651863787254846 -0.7545869226658577 -0.089845473197007683 -0.14341515879978076;0.45481881182618467 -0.13992080329955578 0.40171234148452722 -0.14939649823839318 -0.31428016080945226 -0.32573742013914747 0.15944995594521044 -0.034499611927204223 0.32355439502770533 -0.20113841026501944 0.20037522981450803 -0.53777403958133085 0.049088597923579905 -0.3031022150841457 -0.098679346587325648 0.32134681999567283 -0.24648308976973579 -0.24733996621544721 0.24318563419873074 -0.43423320120135928 0.25437363513535916 0.3628157783737726 0.27139225506801717 0.24962763596705823 0.030112734502785725 -0.23780672617715112 0.27885554673615026 0.057312630165154456 0.11656500235292275 0.16295852109210743 0.23239343579271865 0.056983384657106922 0.36335452727022099 0.032311931291629258 -0.011668136768855634 -0.0068606982218808741 0.10972650297669956 -0.2420518002496877 0.31951143897291134 -0.12567831170849836 -0.11582872791144844 0.23313985811399701 0.33412697886318299 -0.23880713507802984 0.28438570413866943 -0.26348073233912456 -0.226216406538641 0.0923175721357158 -0.21630536092372554 0.18073356452127562 0.53156937283853256 0.14773207234458025 0.17996591285209521 0.22927956789088808 0.25061508304833657 0.052348951375816244 0.47955857287418258 0.022898024070983378 0.061646285175866504 -0.23465145187302902];

% Layer 2
b2 = [0.0012175556837200189;-0.92533245378460416;-1.4248216998523535;0.72131609456514378;-0.72402065633320634;0.23413977794132293;-0.3140372353198379;0.87798296804018394;-0.50710550145335487];
LW2_1 = [1.256782065394382 -1.4210569757711953 1.1742920514799926 0.2732487273371686 -1.0136879828895105 1.2049489951252699 0.36601641455908512 1.1799289190901283 -0.51712095677698178 1.1604692118137268 -1.652061920053332 -1.218416975471625 1.0371521545729239 -1.2759676217833116 0.18984556125418287 -1.3116058665506485 -2.5497968467838104 -0.85922972272847253 -0.39319935802044231 -0.19576579106362882;-2.4922947106211981 0.95366783713845626 -0.53201987732278966 -0.85471766736568078 0.085140737314928619 1.33787021540601 -0.30877132806898588 1.6752354240677232 1.4946954795826217 3.0667336078939491 -1.8118435331001463 0.49609650108052755 0.78550159696809385 -1.8450270010969521 0.15336753686653987 -0.085596454677749276 2.1651219091647422 -3.1925763235393259 -0.67683070616094965 -0.29600443906674906;1.6220114510721473 1.0123739189223606 -0.027246891415996424 1.0151519950599412 -0.067389415064954258 1.4245759055053124 -0.4481458237574566 -0.087911203260301829 -0.52738070939418769 -2.5485197302241591 -0.49554667777603068 0.36657794939079358 0.53480010045994275 -0.38131005755678443 -0.56230333458581083 1.9340055977512636 -3.3174451811351191 2.7775969473955895 -0.011518010808844435 0.26065412145723127;1.3403311022791993 -0.038625697065324795 0.60331645203735984 -1.5121019168964469 0.74800105956523333 -0.5599613616157636 -0.75420565648026572 -1.2232397518408809 -0.13873574721461193 2.6479447267868839 2.885548361557134 -1.1078138323078646 -0.57732671113784684 -1.9308099943059356 1.2845447729582857 0.7125551442471898 0.56167729274450506 1.0532971601875638 0.26405579764039089 -1.000971941478709;2.0813836526998597 0.3238359217369205 -0.51397104039121533 0.43289422287131951 -0.52099493804875163 -0.7815448841308319 0.40011499015623897 -1.8692113942605098 -0.86991695167989314 -2.5425840702537612 -1.3169862980178315 1.2761087118259491 0.49279642076358177 2.5548445799780723 0.2325887541328687 -0.38934634701429188 0.92072655126682879 -1.6690010687736967 0.33360478082326078 0.75618553136957012;-1.2873501046126148 -1.4959439821083711 -1.1141291256386812 0.1809263140979972 -0.51922101571609391 -2.2235189219717046 -0.73089458113010108 -4.2339726684216776 -0.81301870952101851 -0.16859791715121503 0.79045030191486465 -0.2459060373665389 -0.19855970896683162 -0.21290846058609517 -1.5383013819408713 1.2120985977988863 1.7053183625203474 -1.6233995995925841 -0.14266784045649369 0.70386623931514825;1.3972624132395264 -2.3097392161198456 -1.4294178882817734 -1.2627273659076292 -0.31422847646354163 1.078396427439902 -0.54708596438321411 -0.83963351120724883 0.049215567652769084 -0.55412941838087337 -0.08000258958394274 1.1745567226389282 -0.12453775466982693 -2.623013070409892 -0.01023764391383309 -1.5418546216569895 -1.9697489377175545 1.1767202890631083 1.3300171701054295 0.097287756200593045;-0.5294912790453562 0.63882409205736124 0.56281906506511126 0.95707889707995064 -0.55676123797747556 1.4654492405437467 0.43777443619347933 0.26348195893665605 1.3480462958643726 -0.5889783852200362 -1.2988570598483757 -0.67589752602652176 -0.082771191426473101 1.5438365887274899 0.94974460426002283 1.1629222753528556 2.4626572818247867 0.17840109891245309 -2.3554791370042998 -0.81985620578358165;-1.4115810043117472 1.3145893329749996 0.95023286253737793 -0.25113858167056141 0.36511453693627627 -0.034257448446873673 -0.23812651506730814 2.6070137564509515 0.50868083674866982 -0.43478106375630909 0.5823966352940706 -0.48954771921697887 -1.5587416888883319 1.0598689777611614 0.54489023634657496 -0.41065461321768343 -0.0086027939957010677 -0.78622990030180218 1.6264605186208891 0.81046644531306578];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
