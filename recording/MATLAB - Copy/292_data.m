function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Oct-2016 13:18:20.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [1.25;-47.6875;-178.3125;-5.65;-4.33;-5.96;0.6875;-68;-177.3125;-9.41;-11.36;-9.54;0.3125;-86;-176.6875;-12.03;-14.36;-12.8;0.0625;-77.5625;-176.375;-9.43;-25.86;-13.62;0.4375;-86.1875;-176.3125;-6.21;-13.26;-16.9;0.125;-89.5625;-179.875;-8.35;-12.35;-18.21;3.375;-87.9375;-178.875;-5.87;-13.09;-8.48;7.125;-88.6875;-178.6875;-3.95;-7.33;-5.94;11.4375;-87.875;-178.5;-3.96;-4.64;-3.09;0.125;-87.625;-177.875;-5.94;-2.9;-5.75];
x1_step1.gain = [0.00557977332170881;0.0284444444444444;0.00746442733846513;0.1230012300123;0.151975683890578;0.119189511323004;0.0056012602835638;0.0230880230880231;0.007495900679316;0.104384133611691;0.0944733112895607;0.0693000693000693;0.00558366777176758;0.0200375704445836;0.00753118380795481;0.069468565474123;0.080032012805122;0.0674308833445718;0.00557491289198606;0.0211780277961615;0.0070780800707808;0.0776096235933256;0.049862877088008;0.0582750582750583;0.00556618542355192;0.016359918200409;0.00697928026172301;0.0677966101694915;0.0655522779416585;0.0656383327863472;0.00561206594177482;0.0144339197113216;0.00563976031018682;0.0587544065804935;0.0672268907563025;0.049079754601227;0.00564075445090781;0.0136054421768707;0.00560714911512178;0.0810701256586948;0.0656814449917898;0.0749063670411985;0.00568282720653525;0.0133779264214047;0.00562884784520668;0.144508670520231;0.0898472596585804;0.10989010989011;0.00575850278927479;0.0140597539543058;0.00561502017897877;0.171379605826907;0.0854335753951303;0.136986301369863;0.00561502017897877;0.0145520691223283;0.00561206594177482;0.174216027874564;0.247218788627936;0.0969461948618517];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.0418980672030431;1.019129912498941;-0.9308293597800712;-1.0078131140098856;0.94155232489749574;0.89612245308606098;0.95905424769133496;-1.1902440632438165;-0.1879033782175582;-0.016867736751565811;-0.1827944978678594;0.41211560748968817;-0.28730131479725796;-1.0140713800207191;0.63551952757624575;0.55507060201103031;-1.040609365398089;1.1431113506978536;-1.2603309981115407;1.3590460045176185];
IW1_1 = [0.058475845870233294 -0.037025491890365199 -0.19530542687104763 -0.19610849122416352 0.0016435445746179117 0.055144364001365048 0.080969740414185892 -0.24697126516416448 -0.043059035781068358 -0.15611645874342378 0.045462368071124665 0.019143394353109723 0.19754674014423945 0.42945841254217948 -0.18025933683036574 -0.59218036645290972 0.19252098962369144 -0.31544274238914072 -0.16482329087908096 0.16884164905433716 -0.28580990013227159 -0.49418765619847205 -0.24956793897954518 -0.27573065974604766 0.22750590882012145 0.32761535475334974 -0.3147055547116801 0.095923903911476649 -0.36344031435236246 -0.26866809949322895 -0.24963624020690608 -0.15531758820973079 -0.3901548330665538 0.44624369422395921 0.095699223757487059 0.26922993589783129 -0.021304584782263221 0.35845209972164943 -0.10317706785651121 0.29508103733500324 -0.4079692419826435 -0.0013208454127164766 -0.12187287832926477 0.33694938098209748 -0.041748505757128622 0.33501400290413974 -0.44057131317429105 -0.22067893865317775 0.32165885111615827 0.44298159985315561 -0.11787057732507429 0.16546912746316406 -0.13182258507372616 0.035408009793642031 0.18939978834355733 -0.079996308150038067 -0.42495999662935718 0.31934882759953376 -0.40018309981705691 -0.23252515882556873;-0.30215721362043119 0.28668903371367604 -0.8872054290038901 -0.54885380833372255 0.40405446322678074 0.29236227186910169 -0.01414590597449872 0.18410813288599287 -1.0747691241978372 -0.53164672232475219 0.41944315074300254 0.055996620892934446 0.063639419937397135 -0.086888583202677477 -0.90000100144953399 -0.54957447429637996 0.60155333965941882 0.0054948107724215236 0.43699848088835835 0.093115802178467239 -0.20031021454313358 -0.27324218132157646 0.09804779340767919 -0.44665657150197796 0.037172273917068503 -0.17991277758579258 0.26897046236183586 -0.39445712291819124 -0.060056235320797728 0.18843420069313996 -0.15471344519169467 0.082992486667263901 0.1967629820221663 -0.13922170543160503 -0.33928102486993 0.062180539122574069 -0.37530466412816005 -0.27011617109593578 -0.063181272991761087 0.07258852186452909 -0.47098977263328118 -0.10724345653187912 0.25428135819536601 -0.32390910224839425 0.36787322408749262 0.13543638988004542 -0.58528542901507263 -0.29291956237890843 -0.10943768509146549 -0.29329908962126411 0.16381053660166375 0.35279456700377404 -0.19648661782233048 0.61945793847280173 0.25048921505832389 -0.45370447928463847 -0.089629286641948067 -0.48723775772815192 -0.18754772562849292 0.42225899364663333;0.27914047562546868 -0.29575668062815225 0.88924304792227471 -0.91955986802827416 -0.22488173739841852 -0.35608773391887727 0.15845216704936402 0.043415943052885306 0.57298178435143565 -1.4648118342148146 -0.84392194786683761 -0.82880949861646369 0.15502916989714427 0.20384391445997782 0.72427812862305496 -1.5341061628740587 -0.2852785709564275 -0.18322009178970955 -0.20609406549761103 0.11817058262099676 -0.30105729946896204 -0.59506907537584219 -0.16036825287595721 -0.27956162419240216 -0.18352182840786754 -0.21239738944938161 0.018835813406656993 -0.305029784504879 0.68096719868955269 -0.18683222391835391 0.063983484985564512 -0.027895482701652628 -0.38029988668640352 0.047064521884062398 0.28137246600002552 0.25616920058229981 0.55917315396165646 -0.14746217006180529 -0.19184686743542537 0.17727200243738681 0.30781700448628518 -0.43794406461566981 -0.33496072490952444 -0.50152404445168108 -0.37952784185690508 0.64947739776397062 0.10939681382872973 0.10064006814388012 -0.38393598315651506 -0.27111891131981131 -0.16401114271656109 0.55361178786299325 0.2268994031765991 -0.57363781479819886 0.02111515229010737 -0.81044251802103273 -0.31517040662873713 0.18288199257704588 0.13759307153789985 -0.10999914919227108;0.14033984513208167 -0.37074640993655877 -0.27014719705560764 0.022653638325426131 0.054799455889089507 0.039982134343488324 0.073013751259719123 -0.4563907530179816 -0.11609158028624289 0.22197594251463093 -0.018794239041619528 0.04100993436090343 0.10818852164874015 -0.0013636847707900802 0.17083964565318557 -0.011820050502391878 -0.2446886845673491 -0.23153937409956715 -0.19356288524610193 -0.26792267742638243 0.14281789923808191 0.024943472571028229 -0.19943054729278986 -0.12819298601293647 0.20533662912687928 -0.14191581363581715 0.27790715896809104 0.28516873313608632 0.15376965273595913 0.14604898665195509 0.3958055034434802 0.21896008321617372 -0.2274104638299736 0.26086184034270837 0.26030387208897227 0.0037205890596763982 -0.15892066695607102 0.54650949052830844 -0.2320266774892506 -0.081099139155799055 0.34511472428992918 0.32419150660144402 0.31598402953825838 0.49071556732611055 0.15102269693761289 -0.2569521607851406 -0.15994249852626236 -0.19422015351657437 0.32990316374595124 0.25953464585867586 0.22763839540585029 -0.13590059503510638 0.17519951613495874 0.10805172921528813 0.1689243845036511 0.10856442984668487 0.066202069928739851 0.10209701540245104 0.20973183630545264 0.12024083486506888;-0.067363802660500363 -0.16091582450704969 -0.60943013975520099 -0.27790027862111005 0.23347627294067697 -0.39766253556148706 0.33978751930291523 -0.43904200751057892 -0.1986922828645091 -0.26336146257382226 -0.04564924139515833 0.47329480211017183 -0.085193055441710658 0.04680930907773926 -0.26321343621164167 -0.11430183859771047 -0.24463688699664546 0.25179159980652971 0.033018556259480733 -0.38706689070236744 0.38792013073418663 -0.35448385767701762 0.036370317478571335 0.48163179831881986 -0.16941595952934632 -0.16059390208441199 0.31986629050725912 -0.25822383056470838 -0.008084679615516949 0.4402797535288176 0.54015947681893151 -0.20988431264678359 0.32276068203411501 -0.25015518345669424 0.59050876374328376 -0.025188267196773896 0.050420824273332034 -0.79531946389246666 0.48702782231835029 0.24023104381550386 -0.090011700987306806 0.015772926953962513 -0.0625462037325486 -0.69532120395779662 -0.04690001736534409 0.47631619631156213 0.10318081591607685 -0.20127095972481723 -0.38645148848429661 -0.90955082221744221 0.41948711514583209 0.21452981744274841 -0.4032561362645225 -0.48942788110990199 0.0017617363023922535 -0.62440158218240915 0.3765425285954736 0.25475791606998766 -0.26768551843861876 -0.1108032914319393;-0.39837579764983194 -0.32306522970261509 -0.35383716439849749 -0.15798159250744223 -0.084492487031542135 -0.19859528053764355 0.25980011688245741 -0.06098537778086667 -0.68958934208684453 -0.8052756940817043 0.79896822715637983 0.18545707160425295 -0.21501286527362529 -0.56056584647464713 -0.22346668221842875 -1.0497135435348348 0.065680766992754311 -0.25288978032879234 -0.2691808887082151 -0.47849742931769762 0.031489382957079745 -0.72833154568230885 0.28518761512026519 0.058253943719151602 0.31975062543840466 0.14060626202956963 0.32048153169992494 -0.0052709753043454098 -0.25790720738200862 -0.20385103319799308 -0.1955881311023317 -0.012124001793965038 0.010703713172485044 0.12307023254931558 -0.12970168125737194 0.2745415260692684 -0.10415069068287366 0.42712937431536729 0.50339360049238135 0.7121940876209365 -0.22151890492354023 0.23819823387275585 0.03520651503842321 0.28776891622831036 0.45745693847095886 0.41650681724524791 -0.080304367066731705 -0.010414460755048736 0.34347404410224042 0.89229256982019123 0.51067992160286002 0.26965671061256263 -0.041137426513847997 -0.062243505194478972 -0.12267366429984809 0.42123933244136641 0.29285418830806204 -0.26506882326928277 0.0741089225494896 0.10067536677448406;0.081217266199048177 -0.23047413596923769 0.040495395881719159 -0.5629210722818766 0.15639511765571129 0.045755186805068931 0.22467423555299751 0.20976904255791815 0.26797977513388438 -0.45769357873610367 -0.30611988871756513 -0.14996524542841896 0.43849930692421341 0.16872454154283428 -0.21554438857526176 0.10335215721568153 0.15672406906401165 0.20756978481720612 0.28516387783528846 0.15911902629917715 0.11587945244383682 0.39204468515264762 0.10018473669870301 0.32677560343122081 -0.19083910723762629 -0.044230622605487692 -0.3056357628269129 0.31549599598061723 0.46423831736029147 -0.13406858274280317 -0.054617864679031222 0.047667816525151965 -0.1218911507434748 0.083414937055605598 0.42244720817062781 -0.097308400885702459 0.1427120556870391 0.034042368665615198 0.06798711515516867 0.099529229688511356 0.042901296936052685 0.12673358550159358 0.056406433216496125 0.58899064545765878 -0.25303093609226962 -0.46908677243388114 0.046572927486660164 -0.31111656590696141 0.22563061226536058 0.50999348039906756 -0.42377746141892897 -0.39103497541485116 0.34292244397958122 -0.22772406772430565 0.12605014116294364 0.29055368183974722 -0.074729247551932901 0.13341095534828867 -0.07981827543075562 -0.38506394543165828;0.15632270325946995 0.57100165786965995 0.24576087596478985 0.19787854158088289 -0.26351886784323986 0.43936595309904808 -0.39914561450022285 0.24638960637120222 0.14262828800461827 -0.14853587897755591 -0.26831169299778374 0.17647115690635184 0.078210389853618875 0.28508777383423833 -0.61165570750994358 -0.12186481952482656 0.083947172880098869 0.5519382787825452 -0.43056813431658331 0.49924010596542284 -0.9751555522282368 -0.1357910358018069 -0.34925157544995689 0.09930027125951281 0.012026105274948667 0.32607537795721725 -1.2707909889080018 -0.77418171782932443 0.33600537307253459 -0.019773072629552718 0.51479802961138132 0.13390321593345719 -0.73561974016930287 -0.94078509993529591 -0.062759927806513516 0.090581549397944147 0.51111001062947636 0.14287829362972929 -0.70356941273997486 -0.63622000659019162 0.11008845416040183 -0.28943159004239855 -0.54967714931584144 -0.31935439048988812 -0.71174080147271135 -0.29703678299665232 0.13419499408193866 0.1532309941024054 -0.021045473268699665 -0.20490863252138344 -0.64959436092079081 -0.29489441527217047 -0.015496895548886239 -0.010405003406292742 -0.073224207308592942 -0.58103298428364503 -0.43804164873005341 0.022687763628847807 0.28021003118556403 0.21696263195785218;0.18613428878131261 0.28077436713222959 0.49083385940525132 0.062597869505196094 -0.023775879477915762 -0.23100348564709089 0.15923967131677932 0.095445606792733728 0.22980432913727977 -0.36679252520394484 0.091528732194842338 0.29944711872048707 0.18854853453623346 -0.16895399978108769 0.28012131958882053 -0.80184222237045522 -0.53232655725151934 0.3415849436260272 -0.15566866197450518 -0.56478698396414828 -0.30149106652415181 -0.23414102482992941 -0.12098425451549119 0.16578193815483611 0.25871376289942166 -0.40008987772330751 -0.16635110138013826 0.43413247504664643 -0.15657011064199147 -0.14308857579086273 0.21589452514778557 -0.11753492825380527 -0.13163656419723244 0.2880323782038115 0.06509511126156399 0.2742757220994434 0.33798922368257456 -0.42426033283985598 -0.37438414320346403 0.27871627300587248 -0.15587688723335524 -0.039985891625787418 -0.17904492589278279 -0.44815841479046381 -0.004432040008740399 0.55826824345946391 0.013895753573876837 -0.54669460297972761 0.081815812813331196 -0.18799389794715093 0.019650681486577486 0.87334497795967347 -0.21383765100947216 -0.058864949090216064 -0.50523192472402978 -0.23347347986757105 -0.1098623954755153 0.075923578232550734 -0.35784781853417869 -0.19680371932585236;-0.13105231724348884 -0.2647317908961086 -0.56352438035184083 -0.16473491811352756 0.47203115078219932 0.10928578326972264 -0.23465103402929632 -0.14172719330776362 -0.27208370689561368 0.24927260037536408 0.18966806928630109 -0.22978760794536296 -0.14451022565819477 -0.0039610376087762678 -0.34780539486944118 0.36490413727177562 0.44095651613868658 -0.18587938101409471 0.32084077677071438 -0.19056342378174165 -0.66332149205877944 0.017142336372371503 0.095463191232919853 -0.54183643575803586 0.10031020547862508 0.24822735593817719 -1.0121787076360462 -0.095458535573966108 -0.27518379843619789 -0.38196474609681791 0.18001409182405023 0.35952797629548666 -0.95321165546729025 0.27728647854361083 -0.51804324397648038 0.0063265108534924248 -0.34339614924815587 0.32016623708603897 -0.34170295667553574 0.14860195378072708 -0.22942086600293146 0.10658623940800041 0.24220762573456153 0.45679588111965441 -0.82464267834942617 -0.37875050914674707 -0.5201705223080535 0.41852766381627005 0.030008576111050223 0.54852401332390543 -0.73792085908264804 -0.12401529489683971 -0.27120495728511973 -0.16442843475171479 0.46324722102553384 0.59478064488685412 -0.50165417774964982 -0.35894706153984757 -0.1170339359376539 -0.28831755070151965;0.46048629301016164 -0.073705506638752513 -0.33606255947158714 0.22717737918013439 -0.71979466504232603 0.20119617570995221 0.12220067094927552 -0.023380455811260629 -0.05087291061086828 0.91050665569232658 -1.1266613468172793 0.07995866390831334 -0.15897991483020413 0.31989001532406452 0.010377570851624851 0.8076014716827552 -0.47131840731872737 -0.16693677245377267 -0.26731079213413206 0.44644689859979264 0.51156832225417337 0.21581343354817131 -0.043773508597574118 0.041683170992254839 -0.053055784470265543 0.30498465038758693 0.77906095389521968 -0.52867053297565991 0.63648657475118819 0.33962063843566176 0.55805664786241982 -0.031842444271536187 0.44435372782253202 -0.81692240426605833 1.3597084298975826 0.20018881907820335 0.040697217607672552 -0.021682802228969254 0.53145332016101532 -0.7569648371265012 0.65060551442682868 -0.049674145923774365 -0.17116661184169543 0.0003232732347541727 0.58618867712426181 -0.44438537740307582 0.86483947079458079 0.19783792337893677 -0.2027605760224559 0.15753514499063551 0.10578275860040742 -0.52322168244991851 0.24321996629330248 -0.10587313874391592 -0.062109185499986327 -0.165539845487817 0.286186952791182 -0.16406501884128202 0.32954734985083933 0.2520379883738833;-0.13439521530129661 -0.0080051130959725124 -1.1129641675615238 0.07924748713005951 0.15751860529967077 -0.094796399367678613 -0.13481596730512324 0.13553521377432137 -0.88019454453079771 -0.15168755979810319 0.75960963758392053 -0.22573260870648479 -0.12637704576881326 0.4308822714587216 -0.10834530196478881 0.22726953154018284 0.0032564514882282578 0.27899877300101555 -0.49608966547629502 0.5050291901550954 -0.5036703363477576 0.50105297131331972 0.12574656005709722 0.82748062300312897 -0.18418327466056134 -0.23828018828097536 -0.17402541046636799 -0.22649638004822611 0.2417759108704286 0.40587107108479892 -0.19934900339069472 -0.47930248408167314 -0.39805831820378601 0.17390346746834007 0.11892138223181972 0.1343776344558841 0.59690314670618916 -0.55206890356860594 -0.070724485679754576 -0.080141461322341262 0.0043051553982620299 0.36597044979593335 0.36203848737041244 -0.75950542135250065 -0.45679459256940541 0.25924691213344403 0.1168026919790157 -0.13627110524652783 0.36757169202860462 -1.2424499984528239 -0.100140359975981 0.033458226523879454 0.064473480655144882 0.023489366174638426 -0.082812472336574142 -1.1054919459528549 -0.30161053462924203 0.3573779186417903 0.25530510604923023 0.32650222054759315;-0.17717125073446924 0.93105403712912138 -0.11059636676001038 0.13878515183856871 -0.44430547439198348 0.14313123015239054 0.12266551333825247 0.66554229163632439 -0.63255955358702598 0.16760416869014316 -0.10132282259418841 -0.085759812826863929 -0.23584834812064065 0.030227000632753596 -0.11326719075373079 -0.35380989494612847 -0.70354452706281378 0.038647280311252225 0.027262719979661679 0.52139310201106737 -0.072966223193759283 -0.19108133062650073 0.39505584268483951 0.28916881969538716 -0.12701367001749722 0.25845205806160065 -0.14760084398199996 -0.021803480650404192 0.12451699846168832 -0.4077175761943021 0.12183815706854731 0.097199978002229598 0.12195941639368693 -0.59585243282234934 0.59948533754011868 0.1709371855522088 0.17778817803827374 0.82627438877776016 0.025924237819271514 -0.29725887770975723 0.7453834017875326 -0.029746536717130831 0.34226499210481948 0.92534207054544015 0.14994398688839758 -0.31427591257123688 0.68894831592914574 0.1846155562511736 -0.169196361117393 0.89807356981092545 0.11551518197450414 -0.091578103815783268 1.0238855999761785 -0.14577543540178409 0.40285974392037227 1.119234610898773 -0.23039596439353871 -0.30650079454596479 0.68221219368931196 -0.23538666714973033;-0.55702255370298748 0.45034621638441374 0.89454480128034908 -0.0056729933495267525 0.11552681390293322 -0.12285698728485189 0.0054446737911876264 0.6298968429296532 0.95172347153900361 -1.1593141713949007 0.83379337830390454 -0.45111845596874572 0.23284408739126269 0.66794527423779582 0.23159711714968337 -0.29376388315351676 0.73162072014584068 0.062039610354095262 0.29550872855045734 1.0413344081918963 -0.34734804931866614 -0.075576506916665731 -0.06888711757791055 -0.20152725509182318 -0.027871983263239645 0.35224505633942699 -0.34711155801270155 -0.52978117380337708 -0.17080642881241467 0.04182753760231947 -0.11001395020377354 0.036660768449805051 -0.29202544857894447 -0.088891854737783549 -0.78656309175865613 -0.010659636233553618 -0.22606630059830327 -0.47280041300214071 -0.25492573062036467 0.45528861341114424 -0.7954597757431876 -0.061262912066674488 0.023672444553974319 -0.89460462475182245 -0.61855753251154499 0.58516720886730778 -0.41454641065840508 -0.20809349774514035 0.016136165521581949 -1.1051265285061809 -0.56615620931739608 0.75702975049359478 0.35129146152543539 0.47970088522998838 0.38037880766307436 -0.67367568520287147 -0.17016957183278905 0.16653962250053606 0.41762925601728812 0.043589908554556696;0.31631446295209065 -0.23201649117849707 -0.30753734068676825 -0.24288973689012167 -0.38417184556824535 0.097195568719542283 -0.18330292637214912 0.080641187750426849 -0.72727605959540609 -0.43948516921771785 -0.41209162002554905 -0.32644522459195152 -0.024735722466268928 -0.070916330160775656 -0.12260349752754283 -0.13926923106011119 0.25263569185576734 -0.367392739123032 0.18092614700370832 -0.56889307776290921 0.30180632568651516 0.049043940545318278 -0.51920788768711157 -0.69737152573293226 0.28294818523924314 -0.02393976894862929 0.54628160980895468 -0.16557265432477369 -0.25418855052948491 -0.025198791155627717 0.10300954730030888 -0.48028632665506171 0.24038793912943524 0.12124377159631067 0.14303195934475732 0.27594059529999199 -0.21280979013402604 -0.35730492246506984 0.24144721679821735 0.62158566184806796 -0.13338182544936242 0.13183961992787094 -0.10370551009378615 -0.39374485127332287 0.29472252269925897 0.51168072450125146 -0.28521223190378631 -0.0068155823107012466 0.19957138911909836 -0.45821445058986093 0.24162354574540112 0.22328683991172948 0.20464646312559392 0.37639945675851966 -0.012096663818154128 -0.29627895398165327 -0.096617090354172624 0.044490946246742838 -0.60039052177335672 0.26111329245843357;-0.047699994063763879 0.40465675031359644 -0.42896629221971666 -0.18085923131672385 0.46094164573545149 0.047247079945825138 -0.24852865154551942 0.14222636917278925 -0.070358080403888273 -0.0072483159840918262 0.5104104694688959 0.16750082698076532 -0.23216981289334473 -0.075097836418627453 0.012581067033283336 -0.30003068706403346 0.80156200357642982 0.022359477773046674 -0.0085638047279996566 -0.10632896428626559 -0.077544683459369421 -0.45912041596504088 0.033696957511494569 0.13719509240561209 -0.063370483280409007 0.040531509586196335 -0.03716378802794934 0.14016246270283639 -0.68283739600739246 -0.27166359055976941 -0.1806524915812609 0.33657020992297715 0.021542724461337946 0.036631086198062317 -0.082159536478402032 -0.1432755459188188 -0.17662087786142697 0.88037998366963899 0.25885622439435135 0.10466486884793358 0.12307668132826835 0.063535456795926107 0.17417077346359866 0.72688729526316243 0.32901782067262819 -0.23594890431615567 0.055566326155043338 -0.061260681608330647 0.28750529500992517 0.82865121476809223 -0.073299998745841782 -0.40824088934253705 0.11455688839865089 0.14201299681769805 0.2765021769325377 0.59822693980241914 -0.21504543003826462 -0.27786110575046652 0.096707749456127381 -0.24864963318754968;-0.31106525271677299 0.079620902105357341 -0.35255827056423711 -0.21459915016794207 0.55581780879500986 0.079458350205177025 -0.32082292333997547 -0.38426063471988242 -0.51770049370620053 -0.071851145291911445 1.9159614341347171 0.36547895096650179 0.23074329198918303 -0.078581207102568315 -0.36996486743751739 -0.5904755382323853 0.94955737417391273 -0.19956938663735643 0.61215949168710482 -0.22731478886605566 0.039614284588200897 -0.15995213318877025 -0.083021597866756558 -0.0029983404465319047 0.11077709675037209 -0.087179081510454337 0.55245517550004897 0.13766501310554113 -1.1267291938335566 0.20166679123331549 -0.31728817963166223 0.33963818443549726 0.16942075149955499 0.31430552073483536 -0.8669624167553055 0.36416627805713153 0.28601318477399601 0.1633899767122915 0.55952553731076926 0.30541802467323209 -1.0775962983141985 0.10782249630402525 -0.22088966724892184 -0.34045316377163704 0.2388292066736056 0.28792748169266991 -0.99466834962766282 -0.041776589937393305 0.026339083635824195 -0.021194156342511671 0.072166746427675579 0.002099511644494647 -0.95719664488098855 0.0089246898435797403 0.17143671619070072 -0.10665284541067567 0.44194701182184076 -0.46266104178424505 -0.61613144053523361 -0.25740683749376675;0.26267279515877584 -0.59411487923583872 0.24404342435931572 -0.14958140904973549 0.29598466386945432 -0.18796289128076304 0.39216819905544265 -0.7327313031966074 0.0074928226517605324 -0.85191109050402247 -0.4049489886514141 -0.2778916671081621 -0.085415625336093731 -0.74260072796316401 0.052322709370723232 -0.68123294624271125 -0.086455389163227273 -0.32734652043759904 -0.14687210148252497 -0.26557660042856523 -0.72872962555282117 -0.096552904376957585 -0.31193321049470091 -0.51002834130467045 0.12167955350450449 -0.083478264085883699 -0.72361098696642601 0.18026511675474519 0.44342574284932179 -0.62275536167607315 -0.11733293468779944 0.093990945687018393 -0.61393144780801101 0.39906337670542347 0.48913405936513205 -0.40527788341424686 -0.50080717321538182 0.20790655957331672 -0.29734337288011847 -0.070750372662700831 0.36401034353197742 -0.0021586847042421742 0.053263835170660787 0.27986503441526162 -0.51552254043979162 0.39802712018865538 0.37662110957412354 -0.10753424969800789 0.26224588167521057 0.46099073130508861 -0.28737677723342747 0.49635973809165557 0.61403845686759395 0.062136747658430247 -0.30920851033431923 0.46243659502751566 -0.26003675198656628 0.081513503157878933 -0.17716993461966607 -0.2112194896228389;-0.17093401859222707 1.0636117301170425 -1.235205373724555 -0.35667447996575763 -0.53923970774364172 -0.025857049391797178 -0.47580882498190546 1.0192811740166887 -1.1425631075703584 -0.91646424826988448 0.67956866839300645 0.19086774973637774 -0.10459274620162534 0.46923008160959145 -0.62483505913364834 -1.1081322349701208 0.010231058812804979 0.55467184065965425 -0.15123636552966688 -0.33330378388270354 -0.073659980433554012 -0.86082928675618309 -0.26426698330389869 0.28072542882898277 -0.074500177360896855 0.25542646426354043 0.84633599284143335 -0.67737265691763549 -0.14445838118120113 -0.246755979057486 0.72348546226847044 0.32902847274892949 0.80693422480893318 -0.91424090462307228 0.25084457411495553 0.12538239186007305 0.52026036502102901 0.46431738341671869 0.67152447134404114 -0.68509965306765874 0.015481740891643458 -0.19702598598071264 -0.21994024405349413 0.083533866717542635 0.048171669290455625 0.33913015475749886 0.22407475675232041 -0.38337023310457286 -0.42622311642665855 0.056324103822473298 0.53840072803277594 -0.082354761904740906 0.092030178370993851 -0.097135567857708521 0.11947006733945736 -0.19156029494263355 0.097932492590153478 -0.23950942409668771 0.65573921949337011 -0.043714574017407117;0.43413197913635626 0.15919764009753906 0.48988615967344895 0.66526117632873882 0.22758059566759231 -0.092155627774682031 0.45078192533933609 -0.0080553967437578568 0.25254270935215639 1.2382646283439456 -0.42073204105083867 0.067442263465466584 0.00014718070530088737 0.32607578906582385 0.011600690214036539 0.92840103014325204 0.01942905724454963 -0.19498237967178106 0.31165462289463264 0.28102139783715624 -0.18210091773721943 0.18120584399915454 0.1057621119948583 -0.20154295412991133 0.28705197611236255 0.39265625083545924 -0.4018582871058673 -0.31325515515983432 0.23114535539798572 -0.11341526078405161 0.4043599774284995 0.03647458087514182 -0.45007380826858534 -0.19910927595222927 -0.013393679367362904 0.22579549274244234 0.14435976340439499 0.081453842929161635 -0.037670767720153764 -0.13723968015995394 -0.0080120866532214577 -0.14782010453284566 0.33100537959349408 0.1593633138634413 -0.38600853661762047 0.014739951465586151 -0.11225220103059794 0.043438972448847556 0.33925289390160879 0.42227131737540191 -0.42081931818877655 -0.26236871422315489 -0.3892223884919051 0.20052975490691094 0.11708971384051203 -0.12686007483069117 0.084279863695246079 0.2315105587623687 0.13606748033919611 -0.037889413703256034];

% Layer 2
b2 = [-0.35495092758261665;-0.1697936441080794;-0.8140935553499975;0.021872958673339559;-0.12302124670033573;-0.85028330026581944;0.78668846437225171;0.27393207652141777;-0.17680371977205459];
LW2_1 = [0.22465444829422149 -0.90590814475061576 1.2175686599994635 -1.2627040307109956 0.016903819083721742 -0.035988708239606808 1.5509710911998917 0.81229685939438911 -1.0142755563242731 -1.7920320505165432 0.36533035173803946 2.3629256554725124 1.2916955273490252 1.3313301482604856 -1.0165170996472295 0.97734283470631467 -0.94779340603249285 -0.38406196830561434 2.3197133106139844 0.0028995010910878873;1.0188381205014778 0.90708782135042376 1.9164653278038513 -0.48663686525112698 -0.1670818082716149 1.2490451409010865 -0.1178596645993385 0.4479727145697171 0.88802118364750959 0.18183173859500373 -1.5879168068543439 -1.1000982259983494 -0.24230343312492122 0.21842447263899584 0.37794094692116526 0.2159125119121133 0.91900537187359199 1.782491591050428 0.9880202767786922 -1.3050311958949263;-0.92073379573385672 -0.49934791381216431 -1.4953391853690967 -0.62678163646279117 -0.99439977355972964 -1.1315553195864085 -0.55356406609193864 1.4027709187060979 -0.17859567869797752 0.58809194623230321 1.4405296596067811 -1.01509238897842 1.0796315615358216 -1.5916653060542116 -0.83823103030839596 0.13721399487759106 -0.29396664154972169 -0.43568518078530438 0.61733509539460019 0.099042724553314643;-0.35323196510131849 -0.35254894049454016 0.73532483360640888 -0.45026466561982947 1.0055625958155885 -0.77841625108346635 1.2033912239647904 -0.18510765909901108 0.18583253044778442 -0.48372199342192918 1.6583579075645125 0.078315922070541208 -1.1634839036752336 -1.4636332535945675 0.50292342326177031 -1.4233505686293348 -1.6979355839499044 0.69215163908368316 -1.4973081078893247 0.04468484094861648;0.76851963231060105 0.12889289316606353 -0.95017345408112641 -0.36470112303776853 0.31573271972450279 -0.28873349255491598 0.12447540418497605 -0.67195588795580463 -0.75574753175454523 0.59859536969116456 -0.61780171916096449 0.40445745746372053 -1.9611643043885643 1.0790879200753478 -0.023698293019501285 -0.0094639496622682014 2.2200186618334259 -1.0261183773610374 -1.1320310477457682 1.1604086529177611;0.86730804230339353 -1.3144329910564088 -1.1095686084459087 0.50883735650272799 -1.6141635329564179 0.093934697852981419 0.86123303804282481 -1.8585848460989813 -0.29144680200293321 0.29147558431345794 -0.31904342301785377 -0.1141665371305543 0.94048813986124702 -1.3564393283113878 0.049813470982623329 -0.41176048672222021 -0.81196631810451936 1.0406311945825097 -1.6180253628814993 0.19032642318489712;0.093933441343163823 0.32742002792146324 0.53546215381972384 -0.39532296193603322 1.006466233839501 -1.5913740172400488 -0.88764058103252097 -0.23810058857228861 1.8289020333031196 -1.1446750710020748 -0.060229556715164258 0.71377387815701432 -1.7285671790338046 0.10233477236391843 1.3300763053068163 -1.8714604951840652 0.19110123133338999 -1.0611151239366092 0.30903628819264123 -1.0558421859964793;0.41220702326564174 -0.6428290717449725 1.4852127564840041 0.23138126144065932 -1.1288832371441637 -1.7404178573431237 -0.87669666737745777 2.2244611143787734 0.035796488164399766 0.87092340531145551 0.12168622070400509 -1.3039316006150872 -0.81930805111890448 1.4040800853949365 0.04184749688338707 -0.73806206292253362 -1.1559489156005123 0.7965202816646566 -1.175423294561488 0.58879770135303933;-0.098093075553590175 1.2660263371616585 -0.59848225678874656 0.66067344023996644 0.57730804943123504 0.12084196048016478 -0.50783767850546091 -1.488345723760313 -0.78135630404331247 -0.70067086755449925 1.5548342608824581 -0.93550622902530456 -0.072853680984312053 -0.59797319255788273 1.3875506134019377 -0.2876704121478969 1.7472045101366454 -0.57962966351704526 1.1494772236442725 -0.93591975898915114];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
