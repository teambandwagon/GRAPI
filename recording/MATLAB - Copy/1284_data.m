function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 10-Oct-2016 15:05:38.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.3125;-84.8125;-123.3125;-6.73;-7.32;-9.46;0.75;-84.3125;-120.6875;-11.02;-12.43;-12.01;0;-84.1875;-122.0625;-25.58;-20;-35.66;0.6875;-86.75;-175.9375;-9.77;-21.72;-42.33;0.0625;-87.625;-176.875;-16.06;-23.64;-44.65;0.8125;-87.375;-177.4375;-14.61;-25.72;-42.46;0;-87.8125;-126.9375;-11.72;-28.91;-43.54;0.125;-86.125;-177;-13.09;-19.96;-35.77;0.5625;-87.8125;-127.75;-10.51;-17.61;-25.88;0.1875;-87.0625;-178.1875;-5.17;-8.34;-7.99];
x1_step1.gain = [0.00556328233657858;0.0173253925284245;0.00663762704833022;0.129198966408269;0.128452151573539;0.0681895669962496;0.00557103064066852;0.0167890870933893;0.00667919014819453;0.0509035377958768;0.0630914826498423;0.0462962962962963;0.00556038227628149;0.0165118679050568;0.00664727877025343;0.0336530371866061;0.0537923614846692;0.0303536196691455;0.00557200069650009;0.0169941582580988;0.00563876651982379;0.0577533930118395;0.0484613520717228;0.0276204944068499;0.00555941626129256;0.0147194112235511;0.00562587904360056;0.042256496936404;0.0489476260401371;0.0259437021662991;0.00557491289198606;0.0143112701252236;0.00561896400351185;0.0351802990325418;0.0439463854098;0.027311211252219;0.00557394182198223;0.0139009556907037;0.00655066530194473;0.0367849917233769;0.0355808574986657;0.0270160745643658;0.00559342772242615;0.0141655599822931;0.00562884784520668;0.0382409177820268;0.0459453250631748;0.0299625468164794;0.00556909154194222;0.0137634408602151;0.0065252854812398;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00557200069650009;0.014807959278112;0.00561502017897877;0.0446229361892012;0.0906207521522429;0.0518806744487678];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3271902878630251;-1.5983980670423037;-0.089245940861486683;0.90481212031924851;0.64142622444269393;-1.45448162947728;-1.5066256618527956;0.4208402101483853;1.0789834177674706;0.326928212583733;-0.1972876245728131;-0.42870663505642947;-0.50589253156277625;0.12992416438374063;1.0725918888303081;-0.10211523872464012;1.2827539734147888;-0.6364106800693683;1.6679117593012349;-0.98902387838883932];
IW1_1 = [0.054217335461483183 -0.016128280788055886 0.73700488535556941 -0.14072106691350092 0.051432373604244165 1.141707352503083 -0.16909879389779706 0.16012305728113568 0.90674381420717687 -0.15171153853283931 1.2014439604777076 1.4999905254475181 0.17769963998892363 -0.23464723936731821 0.90852403632172796 -0.97543764230297447 1.0005482813901034 1.1010304303228897 0.040575635503310795 0.066009328435847267 0.44142882685383211 -0.48191231221572095 0.88932517286632617 0.49136373645200487 -0.11667655013906399 0.46480710244969459 0.2048100948291782 0.036220084933495524 0.45744823676925717 -0.27460547987859651 -0.011895912955966282 0.581710330626803 -0.1710545342476722 -0.51583010387940575 0.048123129944243476 -0.69298967150608193 -0.10001275198941437 0.28986043130726702 -0.67327740200213537 -0.34806612372411244 0.022923122432816755 -0.1931755519707454 0.1874362091248705 -0.077133917763187898 -0.58968101790905125 -0.06145197527712145 -0.58624879766281612 -0.58828823904572147 0.25392652041862857 -0.59596596437236327 -0.99382803125880237 -1.0437720457427631 -0.26418874460091146 -0.4716825839397939 -0.23280387888555942 -0.52903389272524104 -0.86022687846006551 -0.84039415575322662 -0.31654283139008815 -0.82882920632366719;0.03555018511421433 -0.63654347998810001 0.74704028893144836 -0.79607563637835987 -0.32028292872726338 0.22030094471289016 -0.13274755474047864 -0.85844213938565728 0.58098603029789198 -1.4206043546491516 -1.2318120780570547 0.34800923845893 0.016994774660646004 -0.79060294578188206 0.50678367017006787 -0.33147504795631189 -0.24387331831216186 0.453571723981539 0.071807124435514277 -0.45374053722864538 0.19543511795026816 -1.9116536183154804 0.11633981065518627 0.21856268893150482 0.066681031884905276 -0.3122035625462331 -0.2978738916349884 -1.0056143473485604 0.52891791238585328 0.15831744082413959 0.16618144396296261 0.065686749722808357 0.13834872662003128 -0.75471406790408457 0.9868777597542604 0.1425469971744909 -0.85408618043011564 -0.56569458412804818 -0.11251847283329666 -1.0497332879320753 0.30399459680176349 0.33836403691097239 -0.013944279871059131 -0.22769046984178043 0.12624686898844961 -1.0541255707869257 1.1051495848603936 0.42086708760432551 -0.061270518092963244 0.18206797956803381 0.19902639035847042 -0.36454598424413709 0.43176372061467821 0.52475477303472229 0.37411625755209732 0.42673405503020578 0.73951678469075033 0.46812401925807484 -0.19036872814040881 0.45000297386491939;-0.37007821722886486 -0.52756287098258248 0.54058234544232264 -1.0412241331966385 0.8473648476422011 1.3450461660826505 -0.30510759747771504 -0.41604284164527677 0.11671303913196891 -0.41298018230235339 1.8174399307162594 0.69167845434906428 0.47824317501693292 -0.10433326088796126 -0.12369581074141048 -1.6263640634428282 0.83977069065962207 0.79126168589583723 -0.22689224016225762 -0.089046694581654012 -0.086055162554596443 -1.7465471251877942 0.56263204507161502 0.047031772782367212 -0.0085021855808190983 0.019214913832615602 0.20480602933842007 -0.84520434373000408 0.31411316382723586 -0.35692201951438857 -0.1461208226445089 0.081912141289177745 0.33028492726153674 -0.4847472992570277 -0.12063259279666175 -0.51781300928514051 -0.23979284375696422 0.23582805712927324 -0.0021246666963192001 -0.1656460924646812 -0.12067932528266889 -0.5011638138006157 -0.056030879586129401 -0.5289486910907405 0.20537426055549562 -0.56377630599457962 -0.32757507214228843 -0.1139434749802746 0.11544085383202457 -0.87611528877052447 0.69296657171925269 -0.37082640289897423 -0.91951856287544709 0.36255296658010705 0.035704760013041396 -1.2140536720265072 0.23236527727848297 0.23178494954621853 -1.0492083470072509 0.18785420748608436;-0.02720880270513713 0.72127363817328849 -1.4638360491471649 0.84730935578883593 0.90642622362746783 -0.31645081883392784 -0.23266718961647967 0.14018300934608593 -1.1279820738119157 1.5343975154493765 2.2377028209166769 -0.39662676077140152 0.07539309310437449 -0.103974036560113 -1.3918125055869708 -0.039876124762307862 1.0257178521109487 -1.2355408792524811 0.11387340421701778 0.03275164673109042 -0.33491228687879432 2.6182771712452015 1.0116216145474068 -0.67818061480125569 0.40580007090852144 0.26982485806515255 0.096103025247884333 1.1970306502393393 0.37733469362923561 0.089344854433349816 -0.30117567531911338 0.12815235678812473 1.000945960234999 1.1416253159367107 -0.8128063682608726 -0.15601017679316698 0.16806926712831771 0.28782561427333991 1.5204384093995149 0.55034131331881897 -0.59025123672281576 0.041713196920156424 -0.75242412055449859 0.46827871366559642 1.2692092077241193 0.29528037153599895 -2.1701215087447165 0.025840422028446674 0.13777217536520475 0.14706362474421517 2.4828598757009854 -0.031819748753999802 -2.4186117279114456 0.25590509810848788 0.5149616718848532 1.1017323263017866 1.5414345141013222 -0.14770472689009306 -1.0066467473728464 0.33015373846110185;0.033141002020714801 -0.2599936492480418 0.10089988764554009 0.064869617987857883 -0.15977609672564869 -0.43725183475026363 0.36754456763675009 -0.36326997520883925 0.20936376996067355 -0.0046423097361876714 -0.1854491496257831 -0.55679453818433233 0.090482096217301619 0.10359798097222482 -0.028826807504412987 -0.08550775990841715 -0.01406798036233046 -0.15708126441948936 0.082104261771508605 -0.037773371258342084 0.086267848872434716 -0.57509405737978425 -0.028492360739920147 0.14120891272747316 0.092195930083897537 0.012692686400255032 0.22730833569703376 -0.06772723389765159 0.32422964648587721 0.17027940101927413 -0.10294864283038462 0.38713854071269416 0.29767988646285193 -0.063619675747049728 -0.43874270263605908 0.41535833534361549 -0.35836474635266319 0.54375508769419933 0.082479289602045758 -0.091224656561428058 0.019290816755333728 0.25322639798249064 -0.36836864953887111 0.51347110169855525 0.1161065957365176 -0.12373211662248025 -0.056458639165079184 0.22721601634332197 -0.12779291724754849 0.76072717802691003 -0.17898798768829768 0.39728964404130468 0.016570943442887891 -0.21849480051721071 -0.32708000641801199 0.37902577508970503 0.17884350531730767 -0.10436137286665514 -0.22008409001848322 0.11348442455668528;-0.35911483331192068 -1.0259774492483793 -0.71473730567659932 2.1913352560497064 -0.66746946376506855 -0.0030242394067720516 -0.080637093146361791 -0.55809252894413464 -0.81159671338346617 1.6238854299314005 0.076960692194936106 0.27093112819139459 0.042395846688774753 -0.19636786478267224 -0.75996705452566893 1.1332171748431998 -0.059754068800971921 0.14585986631860196 0.18473901606108137 -0.044824095885127167 -0.77944941123562694 0.54810533303952746 0.087814693541545349 0.05462623821391404 0.49135072485868742 0.16967337691533924 -0.007897869893693326 0.22781571046985036 0.50210728619859923 -0.13774681180017118 0.2288553195030949 0.02583618819967624 0.054591132530729558 -0.60001295166854585 0.88930235054690709 -0.46040165857381199 0.32330174670839151 -0.17530937435497743 0.51181571270730852 -1.220648282107047 0.24887662578963346 -0.14157555896348317 0.17973942515551758 -0.29479659597986108 0.55272455215515681 -2.0387861315186675 -0.009550967391226196 0.065495932824390632 -0.20061743353687025 -0.8705841230129554 0.60853151018931939 -1.8768826108531154 -0.15934022140284052 0.55187341697331016 -0.23306664091053234 -1.4617782236553569 0.39403429910254928 -1.310005446844966 0.25515322890117148 0.25119551124076445;-0.088272996700197767 0.8832776010741058 -0.92174655194864907 0.16021141062019864 0.47547499279844574 0.68493512321531491 -0.042090945633685983 1.4168326111480947 -0.7745791471204192 0.10830401094386234 1.5343350730520855 0.46225419545289037 0.3858387310251134 1.3720956906266284 -0.70188375603821973 -0.24214365425063003 0.80881146389801661 -0.20199647867378656 -0.34076207746543685 0.5189075605733402 -0.6313986253777365 0.77449386156188449 0.1314845558494491 -0.63930069434370651 -0.14613771685166169 0.22609174366273935 -0.61059833265983554 -0.12852863671673351 -0.6651455613035836 -0.1354382401916725 -0.29090044561100764 0.0063111760444061757 -0.63046544920370884 -0.10281144539104164 -0.76886457723810808 -0.89602079168086091 -0.3426069027405193 -0.20768761638026884 -0.16934867545801352 -1.1688039859312027 -0.64544968393846724 -0.68497929897270993 0.039530898903846187 -0.13007922415771661 -0.45142388454345417 -1.0042582390813406 -0.99795127850303322 -0.22065544729929376 -0.095819290998509873 -0.15596419362251976 -0.46126793692801754 -0.76462760554050491 -1.3837411093297109 0.17631060803842302 0.48572128258448488 -0.23164780754857986 -0.21502461380947913 -0.14592647790982263 -1.4981424263131253 0.55146199569385435;0.35958551677422973 -0.12180208102780139 -0.67764794726169719 0.98252918068360373 0.013183497073891512 -0.52428305884533899 -0.18042161190814499 -0.24128426315787233 -0.64342040822095936 0.60051295065117694 -0.092698744857383067 -0.27110495458094558 0.22598947349165738 -0.052386783037822474 -0.41810562797561451 0.93883013355383949 0.32572108533671851 -0.10411172827383791 0.046512559326489858 0.8326886186770367 -0.0094002078736217243 1.0260271402221373 0.29345881304669758 0.11652402854939096 -0.14058317624091743 0.63478123481185644 0.39117548535387681 0.06951228636156781 0.60375356127070312 0.5577867976490033 0.24781646057946283 0.49409807876449413 1.0466746903400019 -0.69895876044233318 0.21588591691516626 0.1435472947253201 0.10044570488716421 0.10778492578941551 1.5893345861488033 -0.70038219715674832 0.074116412622674738 -0.11555762121762478 0.22339471480017481 0.037995127490038139 1.4990127713769552 -0.91357694988880245 -0.32479124948635246 -0.0096884544358437474 -0.034658206217560258 -0.28158472810076107 1.788279471576818 -0.51924517346406873 0.35382067044103582 0.0039922363916824535 0.052403766423531589 -0.033922733256446805 1.6389238201812948 -1.0147231495987701 0.10538089045854221 -0.56816931853676833;-0.29494786305785875 0.63268493149623972 -1.1330246774147523 -1.047768835359246 0.29677350317766132 -0.29074459447598744 -0.32116918248568177 0.39418732021752012 -1.1242024414528669 -1.0717674629962306 0.136277751622535 -0.7258489105400654 -0.47922723867310718 -0.24112974264243694 -1.0678176387464995 -0.69138785376768364 -0.24764761761301302 -0.18126826465075238 0.23530311044130972 -0.51539352949609563 -0.16815099784441187 -0.84978874522778802 -0.63630735358939283 -0.060785101441928197 0.56230479579230264 -0.56131947098216506 0.15062973781471567 -0.043853345114064822 0.028266638496609285 0.21032479220633724 0.02292621616552418 -0.19821003041161558 0.10022775451126979 0.61004413947207525 0.036797090920229689 0.51937220381141058 0.1539030449725112 -0.13722878956642057 0.80748041698306949 0.92634373391671831 -0.17751256519285838 0.14297576045958502 -0.09610860911945078 -0.0026537112118613943 0.37231509367395488 1.2113287725766306 -0.16623926200075401 -0.09267193453735581 -0.16149235615636875 0.7770034500541646 1.1039237152904715 1.883871539907781 -0.12666736644544357 -0.46055760859881084 -0.065040925874861891 1.6360929150175585 0.79923856817882133 1.17882422187976 0.22486211964978078 0.17353854789687592;0.82414992139215792 -0.6776129834293465 0.10736033986488699 -2.2165676032911579 -0.24443438786908459 0.62586651850754016 0.57716591718882715 -0.32463125353924549 0.29556571444989005 -1.8212351709208807 -1.0954915454252694 0.66723860131175183 0.4142396420568083 -0.39333492632613892 0.38866636520623754 -0.58749721609350092 -0.93412059213639087 1.3667939785776417 -0.071385576095594663 0.023635081004161999 0.099964518280776613 -1.6971859010209362 0.03593494388720507 0.33207153803739675 -0.48942760940852709 -0.11331971878180828 0.78812418001907736 -0.49907807348824157 0.92151550886849298 -0.087070744067064831 -0.46849494765744376 -0.38656175511044022 0.4411521661560196 -0.26481301402508212 0.48528198824135299 -0.32796244181198458 -0.6126653692542674 -0.28554300817827966 0.72323928948353489 -0.32784737918974638 0.2737998130022648 -0.25670510547503361 0.35838567674403105 -0.58768435354039539 0.70556249646264646 0.16145355111563772 1.4900816221671056 -0.042374086263395228 -0.03139387730380571 -1.1289038112488434 0.61680760422004233 0.65890470053207661 1.4238368885602222 -0.61068437669871756 -0.42802970811309426 -0.97351591875832966 0.94002598153395756 0.62524636475578488 0.37675134348819328 -0.62429983538259937;0.045959524499904467 0.52629339625418203 0.12446537521443804 0.12106243145828738 -0.094057034506733445 1.1899718632368665 0.21000513884577804 0.25267701861588093 -0.015655566189793198 0.45219767457728954 0.36870708798087959 1.1793284547785292 0.24595236900687373 0.43558356085290911 -0.42797648543955724 0.21560597184051122 0.20078078153605419 0.66463339222471129 -0.091765882017093708 0.22882907554958182 -0.2473951277016864 -0.3731361747696208 -0.012611698430040204 0.34344715568843526 0.083788351682812096 0.14675224495004441 -0.32277902373691142 -0.95666886823061503 -0.089956270838258467 0.45210149105300784 -0.18453490196344871 -0.43473448654402397 0.036649888791180973 -0.32000439996211011 0.21707690486095751 0.3246400829631661 -0.49584680538753656 -0.19312542017192053 -0.17324965274556142 -0.11789002339274592 -0.10897859747905125 -0.3584476391181935 -0.23996828518521582 -0.72913460509811212 -0.41690612933295362 0.031608416271750567 0.06255477083638232 -0.09027700125343982 -0.060863214780074761 -0.02953714982806438 0.11482609368807943 0.64398350547452354 -0.3703267461871847 0.008972754210144103 0.030743754448927359 -0.14409081758602513 0.1551515689638519 0.26542141921979329 -0.19641048420834933 0.039294259708622083;-0.029262922278091703 -0.024123173755780224 0.32502709426011689 0.71074256010324854 -0.79480471501656291 -0.063788571227111596 -0.11319202791526191 0.24615212568626288 0.054706644206066107 0.51914927464629046 -1.2914425560123974 -0.022055581929359084 -0.30205292873945905 0.60511745489178315 0.59297997296357452 0.11890718916723504 -0.9512080362475831 -0.079600981035897661 -0.49067484886833962 0.80371652692483786 0.089906390875657521 -0.40966523761360862 -0.47934808305060306 0.3478824615171433 -0.65874749766103013 0.60209238321512026 0.18560842468676012 -0.63055874710662529 0.27791560805155407 0.03201455014528469 -0.36819345322333269 0.030768205150645385 -0.027773404698808471 -0.34101047954498459 0.77605198921218776 -0.44062794992599802 -0.092790914849687239 0.21019935298793985 0.30531703284607842 -0.89927436341132538 0.4765698694538868 -0.13171165617334635 -0.11972932761176315 -0.10081147147232608 -0.17778986059519217 -0.59056833885059756 1.0688340371265159 -0.050551608565926366 -0.056984359474363026 -0.24808321879046474 -0.56825598527781718 -0.18590942670484795 1.0278252496803761 -0.065047587422822267 -0.59061974524452598 -0.50506731170390717 -0.27505301019256539 -0.030929197349549294 0.4896062412532064 -0.2313325831781943;-0.47568516118775689 0.15627268194467334 0.59317980105689661 -1.8558797901775232 0.1929400999676972 1.1453020333457262 -0.42135180644592168 -0.11038762212851419 0.43963395396964933 -2.0137317561485997 0.77026397968791604 0.79700408419486468 0.11122467403942746 0.2207518293328761 -0.1397542768401922 -1.456089025324256 0.90216934019927597 0.59828707826329397 0.17136208130945707 -0.067092145343698978 0.050922265594586791 -1.7029862536324669 0.61875254051934825 0.24766374295210028 0.44229182997401312 -0.013114291040734555 -0.064356445313459312 -0.39652720229017874 0.50948773034383632 -0.28784430316910647 -0.044168738560681396 -0.35272422709762957 -0.30956247295472333 -0.47738345503870133 0.18410897477972538 -0.17103900192695523 -0.077155326827450341 -0.031158358328793927 0.022610503268103585 -0.035464823629641755 0.19611698034492944 0.075300582038173164 0.23756500720020846 0.073673575126292842 -0.038406573717662325 0.64064888368639217 -0.49322054100320933 -0.25715840018381764 0.19053355150943105 0.046141072531931622 0.067645353269339473 0.83806514674327326 -1.1226354611308111 -0.10428561818364718 0.25934020747119219 -0.14435193807004382 0.077967515000676141 0.5608573200663669 -0.56983385221695448 0.28818421359759627;0.21428875023550076 0.68757772158734831 -0.58239591032885574 1.2256639193518899 -0.77300469125674853 -0.20447775051143596 -0.11637414351695678 0.59868228737040441 -0.45119309392736434 1.0081438059420944 -1.1992854813475893 1.5499900363595256 -0.4147417062358818 0.67600036897278226 -0.42139047130450719 1.5230680912891401 -0.98601218065038221 0.99368334827221427 0.0980680017672418 0.96059483730752671 0.0064405089765391093 1.6659345779726042 -0.71671501943340266 0.94332892808516011 -0.47379242115339687 0.30874813889971309 0.075201375647303365 1.3014661100737503 -0.27053940322661618 -0.037454643431346614 -0.22024114793277019 0.21297055428777137 -0.19058720668812409 1.015608913593258 0.28208269017045007 -0.53523986023426318 0.069885542366687994 -0.70924987091093517 -0.61727459510538674 0.6043225165594982 0.92908491649768654 -0.64313482316726012 0.094235444347968642 -0.75824976667797572 0.033328905206886708 -0.23872512770820259 0.90277709649495552 -0.56798714204135925 0.082730658046607619 -0.30076288544369528 -0.44934848031179248 -0.33900100547823275 0.60012086603055192 -0.55502917296583043 0.066700973358985019 -0.23112371544306845 -0.1224320123506554 -0.21576153546832605 0.58054670328614344 -0.16192597888916174;0.48353479599388949 -0.79267563979260691 -0.47284075952372318 0.32689310003224042 -0.26472605877267813 -0.14876741639488664 0.23973057101296846 -0.65625999236358856 -0.79714165586072649 0.14440432566601197 -0.44623304727989171 0.17789282038686741 0.3494760462445507 -0.76188965264770492 -0.71134517554417764 0.0092066837349807987 -0.59046297988701935 -0.21293894515339132 0.17253588836020772 -0.39718135930404425 -0.38500439448155599 0.31071271341793755 -0.23282736376268132 0.15099157837321842 0.078634524864184804 -0.20465306125090174 0.081101770556346015 -0.29099412970476091 0.017309686217496456 0.48468763636107332 -0.041533325518560517 0.03434448001877087 -0.10197160858702911 0.22581505732610926 0.81493476043932522 0.16960277647690813 -0.37946937978511941 -0.29746680194030783 -0.014116344644110521 0.36559170979116451 0.57200130879213695 -0.061276591471437207 -0.65277610174398593 0.27634337380898261 0.54378752171994205 0.74009921610039453 0.40954151109948739 0.56030861854737557 -0.91213709319788838 0.24532675177384064 0.42764589539119652 0.16356031026145798 -0.011175146526543143 -0.10373957128221334 -0.52472690750352102 0.70940793666155755 0.81159204343697045 -0.27829042283924943 -0.37745364964725542 0.028397629426714116;-0.20841967208660203 -0.40233363694845636 -0.24430643256106407 -0.5918186632355853 -0.18363375378237198 -0.67733069260629142 -0.081318488819306728 -0.35564029660297058 -0.41584604765502975 -1.2149038877874005 -1.3027683695873105 -0.96969094026317471 -0.31114253021609573 -0.24881237507191609 -0.44549982913843644 -0.63216005677002729 -1.209910866460276 -0.50320383277298064 -0.12481286255459544 -0.26424639786902543 -0.027335013717090118 -0.72072134573995661 -0.40137502861007296 -0.28096292060466493 0.1177662832391292 -0.3436180633958914 -0.55866896428740065 0.021149868828625441 0.42412058519563323 0.14330659407303561 -0.067728196067928556 -0.53840164445769711 -0.20384478580512275 0.022324274298538643 0.20176248688825293 0.14826155136314803 0.19345351574070421 -0.28272344587746934 -0.54973095699655672 0.22165290738481294 0.41928529428304889 0.48364802466454843 -0.055169085870687619 0.22156777124255536 -0.39547808983855054 1.1288933321544987 0.84023515036615071 0.33875468617678423 0.18779930065205117 0.76573638128197408 -0.34074334866877259 0.8578858328186566 0.77508076273225379 0.28164831588638806 -0.48574199496180948 1.3202199379463908 -0.74590803888196233 0.69747809426296992 1.1766399875079914 -0.16361881795937125;-0.020897447809543005 -0.035256995588730099 -0.016324864496690576 -1.6075785709456922 0.3142507082679778 0.41416645386851797 0.08299479023707694 0.13918021941729483 0.1525673033513846 -1.2883832734518628 0.9768177109671714 0.26912219545491267 0.22764065231699071 -0.27758513354048331 0.34961665193929559 -0.62937950760765082 0.82537553100572303 -0.053549153419559084 -0.61388377713951126 0.43003300596379279 0.35268124214967017 -0.66997325838163857 0.39164855785670283 -0.028059547753808312 0.21257314637504102 0.084564131542600215 0.5923963243439232 -0.16941093548836547 0.13330939549101639 0.48406935818956642 0.16416796273089657 0.2843134614644347 -0.12168836456129131 0.31520725045614539 -0.55897947496917355 -0.13809951980353491 0.57305848095912437 -0.041382181406398655 0.16046991672937755 0.41483449355523605 -0.44492809100242503 -0.48061499544572367 -0.055143755548558888 -0.37539099731044023 -0.10456934232438921 1.0232064072151104 -0.60199771805902402 -0.7927341912207404 -0.15587183487912454 -0.3982967912968115 0.29735460819368353 1.0457164614068679 -0.63621054204963945 -0.22791482593460299 -0.11399792674058282 -0.38378333316171065 -0.093166448033038154 0.4142966218471722 -0.17544694591320625 0.14853149617192951;-0.19604350921116134 -0.2984804670876231 -0.31960606421968735 0.066168804446369592 -0.55632292479241863 0.048552541053058826 -0.017782939464666553 -0.036492008252709915 -0.27337244714835057 -0.017780453984114868 0.57255893805904234 -0.47526675682706099 0.19370503494673086 -0.38580222602758513 -0.36976117878004838 -0.0053813405860988839 0.45736381303617651 -0.22242266409532338 -0.055750328540841838 -0.42386991216801506 -0.42930973607372397 0.39955828938599242 0.39689182150880442 -0.49553966896146207 -0.00091613443469517166 -0.46655707428739307 0.096012539524608323 0.07002509319155463 0.33623583329794532 -0.28248273543689895 -0.200835819068338 -0.22411367700945081 -0.11489673877529645 -0.34325124745228036 -0.26556894050525248 0.080176484156981559 -0.40901588679468065 -0.1505281949169755 -0.42552698002285766 -0.77616650683929878 -0.48952403159966623 -0.048968411904146122 -0.51233993222999918 -0.3559124411055859 -0.13900163059182119 -0.65237961580869386 -0.57735588215177502 0.20435325970083121 -0.39516447003337063 -0.65030843392782145 -0.30397544035528701 -0.32546477803327695 -0.34125500257085628 0.1714390094823075 -0.91488230081157274 -0.55437875309127949 -0.2024802123745644 -0.24471211482066418 -0.80585540363307995 -0.65251955581217691;0.59171710523002297 0.70413346150296252 -0.52631249860797513 -0.34155316550916526 -0.1041306353063642 -0.064068904919134639 0.33243787943067676 0.71659352198410542 -0.31117672747279118 0.049755975813993464 -0.99621756795246386 0.379475100310805 -0.33632735077447234 0.12974707600684768 0.27133132606215232 0.59686971095183861 -0.55549668617421977 0.2806239808214237 -0.24189682495278098 -0.10218105621925849 -0.21280478434434841 1.167991424975477 -0.45155685900068376 -0.022459184460721086 -0.31514430501944524 0.17288678285078099 0.19037773354145038 0.69924550694365806 -0.28228664019288829 -0.15997726884772653 -0.33995850644575981 0.1134673991339622 0.35419761075172257 0.06696179378728509 -0.37800784081731792 -0.47919135353084347 0.51633843247301536 0.14394389563462204 0.38303075429451999 0.28041025832813549 0.26267393124510457 -0.7017852903590942 0.39577919900439901 0.12821540574254123 0.26311318792479499 0.92710733159230518 0.48307216661898467 -0.26317052246051964 -0.11779147660826136 -0.12690093343051859 -0.41008736274187574 0.64188660473839443 0.99622344604609703 -0.72625490474379673 -0.24338333721731881 0.30466731734916802 -0.20636138305541984 0.41339316276136284 0.7909925692532106 -0.712550205451702;0.0072687641681401811 0.85499042297218608 0.24760730687803342 0.5525199532992745 -0.22249935089546047 0.17126481200392127 0.024324275792776979 0.46228362165423792 0.29433491891228597 0.063091618582396689 0.2040412761649415 0.56631114521975001 0.32298366702510917 0.33343751155040918 0.24702900723967741 0.34290362274066066 -0.28793298220831981 0.098333485269024967 -0.018099734050849449 0.053652910970247991 0.16376162628765611 0.93386375028534629 -0.39289737686983095 0.43331942158189035 -0.26143273551675184 -0.25239862352670023 0.25755301197161812 0.82207681854518966 0.050280427371320185 0.27543776504298445 -0.1155785439712642 -0.81884260239388262 0.21124234448086909 0.43021972372687695 -0.24800513080962572 -0.5468674326093097 -0.1242376326364053 -0.90078208342955268 -0.20746185028549161 0.43004360015291632 0.046906221325315689 -0.55025676533470713 -0.57813231270336574 -0.73132053051159052 0.13889474457917833 0.1148127462326458 -0.33919061783436799 -0.23021549921944279 -0.30133314725693816 -0.68073558177964011 -0.18214976986768106 -0.12674859853916381 -0.075613900147539867 -0.44418100431786656 -0.24680903528556142 -0.46121632479450436 -0.083349253502378942 -0.28336996362663369 -0.41465920655336708 -0.61121127945689202];

% Layer 2
b2 = [-0.13986697514946952;-0.49629306480920837;-0.9200900360148061;0.55429960530899691;-0.078654906742640612;1.3824745060979917;1.5145836253684783;1.8195872968333309;-1.5068435533080118];
LW2_1 = [-0.36008546833293509 0.48658404441987085 0.42675525699116773 -2.9777513432470584 0.20634489677418999 0.86626838257355776 0.54947836371327752 2.3199710281329686 -0.44762188281564524 0.44744235076093986 -0.70913723105602799 -0.47816729254497387 -0.64778830987056046 -1.0216376680036754 -1.2478986425845542 0.1568425838286818 -0.30734531052937392 0.8531995958619496 -0.49462691033666728 0.1077020860245405;0.46641312297135001 2.7002923513079691 0.94443123390007477 -2.4022150932996138 0.35990861305816724 -2.865386212565181 -0.82358154223767643 -0.73757978164541671 2.5385246268380053 2.1274285811987887 1.2149969530372569 -1.1327087572045968 2.7908806369233861 -1.3908121277712042 -0.87144497683152644 2.2604156983624333 1.5360245392611898 -0.76729338581064799 -0.61207661471419494 -0.20602878008609615;0.68686661068836252 1.1009442378768972 -0.61107989009831831 0.21160740999246358 0.73881787629603524 3.6121810915204464 0.62022176460466338 2.281521772062816 -2.2594053367765019 -2.4095878072503072 0.64170815625909317 1.3602507742705208 -1.4872015987394784 0.95570220333780553 -0.96670693723750045 -0.99285492521808738 -1.9334599770912555 0.063061346447028627 -1.7046907954531771 0.020046374593592878;-0.82796817691744473 -0.30179091678137854 -2.2202905858163837 -1.9825107136680604 0.34218478425144855 0.99524735207742832 -2.5472857329132963 0.30896893456171731 0.1998046610539807 1.6248794921248575 -0.085414419352196042 2.6715663069534332 -2.2777739862116624 2.0826262900043262 -0.1923702236946212 1.5199226427102495 -0.32297974827549947 -0.78773645536869796 2.372073685662063 -0.58135629498298336;2.572217185062001 -2.2561093028271193 1.7428097792765906 3.1394050204043968 0.17319250315398144 -0.29888949931024861 0.40227723024973427 1.6925550672185981 -1.1122282826842917 -1.490517581078435 -0.24298184943064552 -0.5458973628351631 0.55312199404923323 -0.60097533174646001 -1.4933992452943723 -0.738287445479055 1.7577407263510896 1.8430166547345961 -0.3491736728833395 0.55671140868798397;-2.1160379474680151 -1.4637611828021939 -1.9964362203514339 2.6899505092192171 0.2588353708549011 -1.4926545738758084 -0.43297996442956194 -0.72872018079876844 2.0925824404176407 -3.0135319583653706 0.24582388140872338 -1.1164483208853202 -1.3579022875516678 0.53145349673992293 0.70524772266362323 0.90879781087214206 -0.39638300251167902 0.041270323341470926 0.78851245576717721 0.84682019629073901;2.3431901655454812 -0.39593150020318918 1.2684710474440806 -2.2943385688596365 -0.52131593364733786 0.15023836507969918 1.4981447243476393 1.5886581515853895 -0.7057624921403044 1.3023288455615003 1.6516152626547229 0.81213375696149648 0.16729892977104807 2.093004984222929 -1.1544842229480288 -0.9998882215805015 0.38220243272129678 -0.24170560634757485 1.2176334171066709 1.730638935025643;-0.83115662427912551 -0.26998651657677641 0.013369411544874633 2.4138124592416745 0.4182781062754703 0.37841829235713415 2.5257839611506641 -5.2125951386084557 -0.40183343189264087 0.33743247884335548 -1.5817641030391842 -0.13158465074924083 0.0098173573144124497 -1.3819802859718933 -0.44373807488778971 0.10992264437437667 0.18485772289725494 0.68804313576344189 0.74711117585428888 -1.80861914860788;-0.57868740799813145 2.5313504517870822 0.77621263901907767 2.0412100162276658 -0.17970927636021855 2.2166599472372859 -0.9840082294939102 1.2321017108379555 2.2119585554857544 1.6533617273643213 1.0804186112677534 -1.096661821250049 0.70055446230568152 -0.9252844572278287 1.2622084192308438 0.22057087420555532 0.097562003036954517 -0.012521299524102405 -1.0659078199158123 -0.10910353237747317];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
