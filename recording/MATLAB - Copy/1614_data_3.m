function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Oct-2016 12:12:41.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.5;-84.8125;-179.5;-9.96;-12.03;-9.46;0.75;-88.875;-179.625;-24.89;-15.38;-15.21;0;-84.1875;-179.6875;-25.58;-20;-35.66;0.6875;-86.75;-179.125;-22.08;-25.25;-42.33;0.0625;-87.625;-179.375;-16.06;-27.97;-44.65;0.125;-87.375;-179.375;-19.82;-25.72;-42.46;0;-87.8125;-179.4375;-20.46;-28.91;-43.54;0.125;-86.125;-179.3125;-13.09;-29.9;-35.77;0;-87.8125;-179.25;-10.51;-17.61;-25.88;0.1875;-87.0625;-179.6875;-5.17;-8.34;-7.99];
x1_step1.gain = [0.00556618542355192;0.0129764801297648;0.00556909154194222;0.0822706705059646;0.0986193293885601;0.0681895669962496;0.00557103064066852;0.0124465188642552;0.00556424969570509;0.0376222723852521;0.0577200577200577;0.0431034482758621;0.00555941626129256;0.0127186009538951;0.00556618542355192;0.0336530371866061;0.0537923614846692;0.0303536196691455;0.00557200069650009;0.0125293657008614;0.00558561703613196;0.0426075841499787;0.0446428571428571;0.0276204944068499;0.00555941626129256;0.0125097732603597;0.00558659217877095;0.03813882532418;0.0442575791104227;0.0259437021662991;0.00556424969570509;0.0125638005496663;0.00557200069650009;0.0322268772155978;0.0419287211740042;0.027311211252219;0.00555941626129256;0.0125539427226363;0.00556618542355192;0.0316906987799081;0.0355808574986657;0.0270160745643658;0.00556134862704206;0.0126532226176354;0.00557588430040077;0.0382409177820268;0.0374041518608566;0.0299625468164794;0.00556038227628149;0.0125146656237779;0.00558659217877095;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00556231531374935;0.0125934671389217;0.00557394182198223;0.0446229361892012;0.0906207521522429;0.0518806744487678];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4621704689741357;1.5054067938205928;1.4579581859713191;-1.5003432489384598;-1.2052189778931603;0.8141261406090724;1.4129865335173379;-0.4620092022923693;-0.65766764958740354;-1.4321151417441889;-1.5915326172293729;-0.66777768772213464;-1.0588771177290337;-1.7418078365146865;-0.94199084279935763;-1.4819028845969557;-1.0314101917642307;-1.253016140516563;0.52084742441571519;-0.58725879486401245];
IW1_1 = [0.23930120116034273 0.63727861443057665 -0.68829420698997879 -0.1189985555355222 0.10801140707558408 0.53265443499686405 0.14058636362207591 0.22655463353949662 -0.20280832866879508 -0.69123562903069535 0.1096402545143858 0.17347018239142217 0.1401568058215395 -0.0088672204595254041 -0.21601517151251229 -0.32890535415962951 -0.11542157963398418 0.017963610603941294 -0.29688673905793389 -0.16655312668064376 0.2550625580130837 0.095491870914404253 0.0046900283341626357 0.19576942902064323 0.27173182740675955 -0.22383683245928918 0.38826534376162908 -0.12101657985889526 -0.093893306587340866 0.19309334079856758 -0.0081094075903798343 -0.042021669567638489 -0.11922741856374762 0.019876324695392425 0.018678896463329028 0.03254303116713228 0.25845965293143142 -0.38372486723221305 -0.18429362186009496 0.42261108863061825 0.011436139280234596 0.088357603787743919 0.64769979891909402 -0.47945432819369832 0.13886630458318805 -0.2864871045636444 -0.18161379853318285 0.20964077174493834 -0.075318096896637599 -0.39009449056048912 -0.28302665049505643 -0.38303385911491161 0.068225939196207439 0.30028373433264244 0.25071165390211142 -0.82750479398981036 0.18747381106409336 -0.76914024852631369 -0.16807964137798778 -0.41223006159678605;-0.62979474239644972 -0.29587096764472914 0.27436542525890711 0.26836716685359874 0.049911351311940556 -0.033119851956998958 -0.60881654855549894 -0.48879481084147663 0.34261645096777488 -0.35744414107747652 0.86180126015642233 -0.89668766991211035 -0.15054598772036235 -0.88507124251139924 -0.92803888678910573 -0.38969050956252343 -0.2738218677600307 -0.43546307832371645 0.8384521237201904 -0.89457148114640395 -0.61555584246929773 -0.01770847137960746 -0.36136611851286288 -0.28452207499426846 1.024051457828324 -0.69112395617759981 0.13488748504949674 -0.043072589166205995 -0.238468403806192 0.1262842855645474 -0.51550414892510643 -0.010636021759228887 -0.53631282538684333 0.02330569914183947 -0.39465393587574821 -0.13669293994438059 -0.5084108273218485 0.18448037672227277 0.29312217044995198 0.11229141138803106 -0.030639918468255496 0.21077412761497696 0.18384846272514221 0.51468539148872106 -0.08882825694373106 0.31655362534285464 -0.085635423172030753 0.50500126628875641 0.36475178166291888 0.57459415799400715 0.6647653813665354 1.1349303489301095 -0.71601686333750103 -0.081337145754092205 0.54508607477484194 1.5177060912299998 0.2375881729444945 0.76292027701502452 -0.27300803902759757 0.36478003358644517;-0.03487029654067917 -0.052472247801536108 -0.31485937869894498 -0.99575911732895439 0.026228155368181971 -0.23087073216786558 0.13214013096006047 -0.16894372616482556 -0.29097209373201716 -0.93052871754436761 -1.0194198509344248 -0.48919429683557653 -0.073395307836837786 -0.016836526884940407 -0.054987600169151774 -0.18258878216358307 -1.2643646414825749 0.17584909301196322 -0.20815689614647165 -0.18999953184784948 0.34330029126141909 0.3555862618425239 -0.36764001420579179 0.3459837888981348 0.11861015994154914 0.028468466975200626 0.75427248801761115 0.14687349822924511 0.12681949291403685 0.070683173856765438 0.35630900851633329 -0.11910041945128352 0.46497258897817156 0.55703992373538136 0.73369074467980466 -0.54560716223709549 0.030998016291525071 0.051535351669133624 0.98583183436079092 1.1780671254700825 0.26400390664601947 -0.12586803145760761 0.02569008938062806 0.088341082738016982 0.57773796131554189 0.75216222142311773 0.92377077090094994 -0.11880185801578994 0.30381856935639612 0.41252128039729613 0.47836899608309885 0.99136676514524746 0.77407617454184741 -0.31310853270708944 0.16865720402048728 0.40802653341375578 0.56091922097827229 0.66208039657769091 0.63794434703769465 0.1311100579185677;-0.25497114154574968 -0.19136731446644864 -0.012958257008578845 0.049203069770135555 -0.18287573693539724 0.061242199068319667 -0.63575386243845633 -0.091669553201439616 -0.22770297553997321 -1.1413811700788938 0.074994481729682164 0.13306817473649468 -0.1675270387708932 -0.27109390970888414 0.2112592791650191 -0.62550676049735188 -0.16730605269111865 -0.14039443574167407 -0.40274977633012937 -0.25455455115184084 0.015901876983475012 -0.47772296681812088 -0.33712819253912196 -0.14100950364085468 -0.062884262439590846 -0.28589180244935208 -0.020800323356931737 -0.28843148943888541 -0.56518439116345598 -0.039758008525566664 -0.3742435278241879 -0.13616758978470245 -0.041300863165872219 0.14641993615749938 0.21067604444109775 -0.00030939886365689254 -0.74955004356525057 0.357570835865337 0.2612411848515509 0.19292883067065503 0.021896145728375799 0.26941327774511187 -0.54307592100978841 0.28378356204121458 0.27305862081593263 -0.37937303907874137 -0.010743208906348639 -0.29747099708555685 -0.55892394584915872 0.30546988496708116 0.051482224621850876 0.8320379378354007 0.075018814166549361 -0.045522735875404667 -0.62348846393478874 0.56722935220902682 -0.29357244722971437 0.56014037944669393 0.12295916324413689 0.41777028439696856;0.34436097864695026 1.4519954024659638 -0.001372137776711275 0.23468725795101733 -0.32145556656933161 0.459073819744239 0.48913444154376429 1.6972032931891876 -0.050760448254675933 1.3194428660993276 -0.7956557346103561 0.84232045492812224 0.25999259777633454 1.1234055053506597 1.077090818806971 0.87229288051281262 0.43443977015026192 0.82996182857294676 0.24907114540825848 0.31751623119207067 0.90451140085995596 1.0452960007458669 -0.6190862130907725 0.76973604026924358 -0.14563838045955646 -0.26828656168128534 0.45777915381860446 0.78682087559708536 -0.36319820389697011 0.16646518940663119 -0.91175148592662481 -0.087631916607103691 -0.21993110427044177 -0.2830067179098214 -0.12269593799857498 -0.4102361384346121 -0.38487062037964631 -0.24720967184245723 -0.90062085321893037 -0.63556355512557206 0.10213863253427251 -0.60940876729052329 0.3351786364280871 -0.62526601625601386 -0.37272451902948539 -0.056100509916375996 0.14233998281893218 -0.38573917788985246 -0.04769625873096392 -1.3210281908060713 -0.51175987571966597 -0.89644827296212459 -0.16336906475993812 -0.37707479399843369 -0.049671511171670582 -1.343588151617483 -0.72989606176494004 -0.28386428762635957 -0.55143642360132883 -0.55808447100284442;-0.049659621500468397 0.5585252002416542 -0.23232539644772493 -0.3019127350587536 0.24006567721086144 -0.3443561738695704 0.075179978921612947 0.73681665863529933 0.14830544852918839 -0.2277492844580471 -0.016997807183762519 0.044748261574178862 0.17045139654708824 0.61157641361136594 0.06074919045427464 -0.22539670699095304 0.13415189600264757 0.083231302895765871 -0.11971215545242918 0.54678070615743402 -0.1835397594608571 -0.10704781253270489 0.33810576215765969 0.21419019243631737 0.21659595823869318 0.64061202269153039 0.095222900158427409 -0.59054869593185144 0.35870416242103187 -0.3326959595734032 0.12381782199190385 0.90615450999269653 -0.11672918438466773 -0.2333345211615788 0.21890918169276832 0.49382943544934094 0.13419591869183536 0.86048983683128655 0.31479301249962177 -0.071388182758232943 -0.0062695883710975064 0.13122887448992721 0.048943196500425654 0.55931423595373952 -0.14298754998987845 -0.13165475139394153 0.065312941629574725 -0.24519357542943343 -0.09748023001751667 0.49240281449677836 -0.030944365599275284 -0.37331178670989024 0.037134658073343207 -0.30255015987071826 -0.39082830070423336 0.27664214922546471 -0.048111050124713964 -0.40015517540233714 0.31025758813584509 0.1869845867197078;-0.28110031540529001 -0.34442650947560338 -0.54103874705699084 -0.88171137342268668 -0.083126962131360602 -0.31013247417108558 -0.67351385923259954 0.18211539135787486 -0.75995856667388528 -0.95513850993996119 -1.1609967996597568 0.37055186024924747 -0.026262077492998779 0.13388185276448197 -0.33997858214835369 -0.51795003217275215 -0.96256675338414355 0.33406921615961388 -0.27613252576383124 0.43990131546896161 -0.10684833547079517 -0.52167727560876131 -0.68437958117380715 0.3445508224943658 -0.19451977639686699 0.14054640212726108 0.49266556237058923 -0.97361272967414025 -0.26578173211967887 -0.098816646134175304 0.22313578671176104 -0.22774054460165741 0.51435112451012333 0.88393820923895416 0.67269577685020943 -0.44580674784519447 0.25996618143490946 -0.58628668550923657 0.61392379793312624 1.5961725121889885 0.93061823105040808 -0.40787903636793393 0.22133261949717639 -0.41040156445246123 -0.043455608957464746 0.80535580056723899 1.1856398500674812 -0.2723859243294573 -0.032239318354359246 -0.37115036076171226 0.12073680851157224 0.41396795195139996 0.95484551978818077 -0.081986340181231451 0.013353653617236868 -0.16167099416791916 0.39015249347033887 -0.35799528576748069 0.23798329780405061 -0.58744899026866826;-0.33986999122316347 0.81341703683244937 -0.064668533503683706 1.5901441575338298 -0.071041480620320493 -0.149234375630379 0.29471655502626465 0.32442162316926809 0.17452329539486031 2.3005873167008883 -1.4696521842525194 -0.30423879852084806 -0.058330115142598719 0.7968269238298914 0.83610218075174336 1.4039502685685528 -0.4500361099782455 -0.54309164814995636 -0.42605761693992172 0.11004551325515391 0.042179989290130962 0.40118425573071947 -0.17030675736631154 0.0015376320936819846 -0.27428678878109597 0.14936916671207393 -0.50307521118087439 1.1062029522144412 0.027463554366258341 -0.38509333762336001 0.5623421448695769 -0.38277746770484383 0.18114648791152971 -0.60454467740339068 0.29981119398601291 -0.23839175157275011 0.28323827379398414 0.23057495203284725 -0.21369997938309515 -1.3966720583553793 -0.06193604631812067 -0.2070605080280713 0.0043980135598456335 -0.49131186719349779 0.076861404519677601 -0.9698382755852053 -0.036175456058751672 -0.29107106277107198 -0.22784991710477648 -0.56537161818524573 -0.31175306792183544 -1.0116557382803835 -0.059028363932425873 -0.1777251054387185 -0.055834049327335947 -1.1334201079501138 0.5318017372416457 -0.32693144722524264 -0.12262352681964447 0.13438957074453273;0.6983639416772387 -0.6329152154014912 -2.0642634065454728 1.7617519657624874 -0.38576681235422189 -0.63531966142645613 0.25700063464947742 -0.46523778280479666 -1.8604787014168946 2.5451092043423689 0.21959447944971608 -0.72231783856118636 0.38934950080398484 -0.3877035540630504 -1.3965389749398986 1.6713397753136536 -1.0292548934099857 -0.84112958399091009 0.31140963663615118 -0.22152222906545208 -0.22066517164534996 0.78965547894806076 -0.32881733497713844 -0.65464148837760661 0.11243071099946089 0.058164671267881107 0.085271128593277193 1.0130652989199498 0.43420031223240307 0.16809658297366417 0.39505293576047845 0.24390002129377006 1.024129062517199 0.039076997093582269 0.6419540288984078 0.66592234680354334 -0.16810158286489163 0.16241222406088401 1.2455590409784736 -0.96812169745495569 -0.44320414539678704 0.43605160884107513 -0.25721340497202821 0.26360170083661016 1.1888486360255648 -0.29773603518676595 -0.36093958911997587 0.51923306054518115 -0.99164680294614949 0.30310251154097995 0.91141421338538198 -0.74790198649641026 0.31840025024560031 0.46350518227729182 -0.67099821275315041 0.070219863373559746 1.0642557621038615 -0.51023743033792757 0.26254944553897652 0.14400435433302178;0.052708614612626443 0.83062365291259621 -1.290962382273886 1.2533334419530471 0.080508138080049002 0.5501051467905278 0.25012324380018702 0.78939425676795882 -1.5304331264556259 1.167138723803856 -0.24951413122860067 0.24444725453899468 -0.2248885192025708 0.69308488420622683 -0.413059810194495 0.32719465358290889 -1.5389608347349337 0.69221507596057452 -0.0096781613917829752 1.2065808642440556 0.04094231853700319 -0.38388138433972324 -0.89729868038003124 0.88222205149013422 -0.023016922356835688 0.82785849736433315 0.54520722216731454 0.1872725464880102 -0.038382167583380741 0.29312696083876366 0.176862317083055 0.09233842824723737 0.5540012029213236 -1.5369863123737653 0.72322308030629956 -0.28863029526116168 0.016722557283237988 -0.72721669342958029 1.0447884503057983 -1.894288959773595 0.35670178522633078 -0.64695323713756137 -0.30862513005221337 -1.4175752403024342 1.0964162341456811 -1.801204824003477 0.50005411172978065 -0.89218485826530236 0.47204152147922385 -1.7455756980122599 0.62360225697009009 -1.3526917298617676 0.6292529259120323 0.0035880951713675568 0.3715370640277581 -1.8793301817077159 0.63999543710399076 -0.062131978078535044 0.35436294513724304 1.0514282569803586;-0.24021004281776145 0.18396816193278512 0.0012262756052028266 -0.48035589951053681 -0.55283684523182852 0.69846101863533994 0.5246284081926248 0.33256807583297976 -0.26006697797292577 -0.85765901797403188 1.2475291703417941 0.4583554507498192 -0.23434625563116146 0.4602999778056166 -0.25488691548576925 -1.4464595965207001 1.2418471014974488 -0.25537415902432126 0.12851429845176374 0.22937942448909043 -0.42945620882175756 -1.3728563233450717 1.6802790987047227 -0.14449870901106562 0.18848441258602333 0.55702984634708652 -0.40006472681030469 -1.0488397663124354 0.20987150706424382 -0.078016744423306389 -0.30013344770419559 0.78821679849312676 -0.25706470078315768 -1.7288664317379401 -0.73249539411565501 0.10845411690693831 -0.010405119955708447 0.58243341328955789 -0.30599588156487878 -1.9248574421908637 -0.46125835023745815 -0.19440373745734713 0.40497828116721413 0.24529085203251957 0.13248676290243083 -1.0937410092815254 -0.90561320932129918 0.37414773393965001 -0.53440112539255025 -0.19506269862116329 0.36629700075738481 -0.82166472459098727 -0.19543382553744362 0.65645072684583283 -0.1554921245039044 -1.2003523101362215 -0.18383111903598268 -0.51441838621586444 -0.8108957391708288 0.12731884405291391;0.58580152687178033 -0.94189828072937454 -0.70408623966530215 -1.6919348609128662 0.05950345932625023 0.61467958217221141 0.4973177973445036 -0.57606379903282701 -0.51998291639598793 -2.1374405791113213 0.19227243877442834 0.64204364583770934 0.65499885384940149 -0.6031035908171346 -0.36956512722679341 -1.0627025310570073 -0.064536192412405893 0.76510496930220417 -0.58398448093792132 0.062274932349961572 -0.18817581806343134 -1.9677977948700502 0.25453187587683279 0.51327107991590115 -0.15113143015934971 0.31618402539157819 0.075888914827189763 -1.4678781794251154 0.090181891377210902 -0.079581022026737419 -0.11378657760841664 -0.20229153979278744 0.19552122110090478 -0.40149800643496952 0.47864895307489352 -0.0081191892260946003 -0.36853983781050459 -0.34246331966919041 0.31626464638611662 0.28593383139104162 1.0392108374058462 0.098320940052925299 0.3454508540177797 -0.21754695876599595 0.33733505949344283 -0.21032407525368702 1.3326400312508888 0.085846003724363379 -0.81959259035906107 -0.8725332724688285 0.2652333175878695 0.31798875361083484 1.0787640371885674 0.073186228077023227 -0.32510069699510524 -1.0622333286541701 0.10439342187760367 0.33000483857097518 0.34457475999643844 -0.39059275127664372;0.067146313005430711 -0.34317955573842135 1.4451456821233954 0.091878458410514591 -0.16505916374768256 -0.89624963192703466 0.462969279267468 -0.58262969666668918 0.9004943526830419 -0.20539925693052688 -2.8707741101107502 -1.0784857074622298 0.19249332037983943 -0.1543605585719435 1.4696057617180807 0.50697718840253603 -0.55896226531923066 -0.36145549671236404 -0.14618870265809722 -0.10587418862530401 0.49574738573101435 -0.57807257250424315 -0.82877083484236869 0.2153383462607317 -0.72080286862307907 -0.014790980098572031 -1.1154135358590715 -0.66877468934363504 -0.58685669793249362 0.23058424195852742 0.23843745334780372 0.49155546923049454 -0.56991304595525361 -0.80804710111560452 0.77328979958841082 0.096699537829637916 -0.064455892454287608 0.52217080444086017 -1.3418883250886902 -1.1376682940922982 0.75138971296271817 0.59458439451857503 0.033949954471696062 0.85072873043574326 -1.6421118176044818 -0.91659043990032052 1.9798761895358048 0.31908126850976987 -0.070249577331904345 1.1561988898756781 -1.4444111523395631 -0.36831704284367972 1.9407220385974853 0.16329107057233536 -0.042252729125046108 1.0383540849418129 -1.5355170333395871 0.55251435045827091 0.76542468092271554 0.30889606915740153;-0.45067939789386985 -0.24580478704736913 0.72840751576605001 0.77528102233275242 -0.43169259152600475 0.23962404370797674 -0.58246116890110144 -0.19004096330716463 0.44562686541703045 1.5714136449291671 0.19141549412292971 0.60636186471805775 0.068043272212443273 0.050429331666668666 0.68960623682540068 0.90092032547345791 -0.72438994229860265 0.88807266456713574 0.41179868687825483 0.85641092076808323 0.39052595999355921 0.37289420464760736 -0.083601030014936323 0.70673437463944311 -0.018989059927859681 0.63475003327744994 0.0043253034589279295 0.94357404922250376 0.70338522681714022 0.36271555375782172 0.17933409839078857 0.12698531232838525 -0.092292897940549762 -1.0147602304816159 1.2348491181765375 0.30904749033318862 -0.11268812329701493 -0.56658984491960429 -0.31907543310824438 -1.7492624700096961 0.77035626696993864 0.20266487021939555 0.3416943825746887 -0.7125048263091055 0.094236948625923064 -1.1591077819974305 -0.028626833373304773 0.33105328260015432 -0.1335171137275378 -0.91426213705908332 -0.075665589003718489 -1.3500826071126284 0.4537803266230136 0.65509376229719884 0.2368342638077304 -1.6265776899685258 -0.14408786734894796 -1.0286861270848993 -0.11733024733531827 0.61599159951938287;-0.065581175463179944 -0.26695719486813596 2.3252491398435935 -0.61092660249529385 -0.38205193438695451 0.32547069262835648 -0.012188525613755198 0.018835863110521284 2.6412756810934255 0.23937946078820435 -1.0840706580540944 0.81915956046615024 0.16285079568006197 0.094904128259352197 1.5191066271060676 -0.16180551220203479 -0.84458807988637974 -0.096293396246900489 0.10537172408633982 0.34570682746205866 0.17212604421312439 -0.47613270361676152 -0.31725422741289444 -0.16864348481176381 -0.10236467121803566 0.10536353345877662 -0.033436709039409415 -0.24904209161241281 -0.031967504776775124 -0.30645071338328389 0.036264693289438411 0.17646714033366995 -0.98114035101089825 0.28134268901409437 0.49898493231124735 -0.41232207385589825 0.16493278425275498 -0.12690194103951905 -1.178344614356889 0.29839855400896498 0.83106077630152475 -0.34186539019110296 -0.16957649202401787 -0.022285932686816532 -1.6864971650546541 0.080718463667784318 0.7051109948095039 0.19268469273080571 0.11598545018980172 -0.16716394878833202 -1.7025722478536311 0.025190134114094195 1.0683339455947432 0.029951502322181699 -0.12894439360381346 -0.14834453838725439 -1.7315014711146735 0.065523958238380475 0.2455833872826515 -0.4649003083483747;-0.26703141203951608 -0.67463000027871689 0.46309547944475543 -0.96752108341567944 0.40795079103872983 0.060661029744584261 -0.13400959346304431 -0.75705311432290245 0.071757001884766844 -1.767501746293421 0.2584117893910286 0.0062212455221143693 0.42425643558583931 -0.56593293406645206 -0.19193282232959655 -1.4672763830269877 0.13261787509695558 0.24386506848250067 -0.19151205891832884 -0.51093190885573714 0.58502149919766833 -1.3277911998750687 0.035689264227891621 0.038372886786535006 -0.19519744497554115 -0.25458013393167872 -0.069136666685350706 -0.5870183087236458 0.16494965182706511 -0.12221426594330932 0.43646214371101227 -0.15278933638687922 -0.072670279812209332 -1.5471743903658173 0.37914530382833961 0.11781203647964865 -0.15394291448655803 0.18275622335743011 0.10362676339872061 -1.1936298817818267 0.10379999261304203 0.084503001110468517 0.1608873635010897 0.31022341390981034 -0.22668363395076929 -0.8784946264867225 0.032541112397650764 0.05201894246295543 -0.14837457752511887 -0.1195567328357262 0.32569108418493725 0.4008238452477389 -0.45472019987666351 0.60877566773587544 0.15912815300496516 -0.23982222615783447 -0.21280178803417282 0.4891151534784326 -0.063510844883250567 0.35428716413902189;-0.32276078222534171 -0.56743955805198232 0.48276888019306513 0.65352683969693681 -0.075164568863488143 0.033255001578217917 -0.40947803346136386 -0.23937851204242339 0.12630777395184695 0.19740328164479029 0.17894671847837898 0.22162184352873537 0.032246640351980882 -0.25542052428071083 0.22160225357295379 0.20933843472328914 -0.077807992071042109 0.14408498859350169 -0.0095276864900739541 -0.3565867294609491 0.36564536099672551 0.47682575541987421 -0.1174678509229419 -0.60234612756790207 -0.28820577446315987 -0.21961846026359264 0.40656285189497848 0.84472799862292847 -0.5302156652664255 -0.071328818357456886 -0.27288108929717725 0.086295206254013143 -0.066267343930289851 0.48187492129181858 -0.19902901286156832 0.40171036493483175 -0.15895869995069234 0.89194040929659546 0.28370485744791274 0.16912922227303659 -0.1681146151269941 0.61222772261455616 -0.17309149757721992 0.54021889985831428 -0.24041735109217022 0.14788206014924157 -0.14453569523875393 0.026880248580658246 -0.1819949697127583 0.8145309158926729 -0.093768025718241665 -0.17760314338455074 -0.59954551540476919 -0.10324256477165879 -0.030724525856158265 0.78131621022470876 -0.14269019352378662 0.14645012617496075 0.1255072669533808 -0.014670666143508506;-0.2807616210695934 0.64625942866572195 0.34174773257162327 -0.00023279832343404505 0.38691350139303154 0.20459092740012222 0.2545156311682053 0.52068276646774447 0.23273248784062742 -0.46947198137754598 1.2058203009977515 0.025031713966730845 -0.078686507095816788 0.60837969780149381 0.45072294930834889 -0.98243601196148322 1.7425232205854555 0.161139675965879 -0.24184181425665652 0.42417049496596715 0.12427371893838748 -0.4503793743503664 0.76268790095049865 0.041401183623820878 -0.38860182406714155 0.10436887099050007 -0.50533755952818538 -0.14430644339918339 -0.45345269673404182 -0.048270570435190049 -1.2498053838952898 -0.029532587602615994 -0.58030072522817955 0.47606212428107791 -1.0999559300150321 -0.23886252783306658 -0.40522928400054276 -0.041179893561362486 -0.225630509046546 -0.014423041922566699 -0.52071182498869151 0.068628635138050106 0.20814609147381202 -0.46419986412135322 -0.54431093768903449 -0.49770100382492244 -0.38504503618267683 -0.006391546492653933 0.57578833362192317 -0.9415297963151309 -0.58673602319020568 -0.6272501692341792 -0.59646918590891118 0.38424182443207461 0.66161497922701495 -1.0057756745489816 -0.42560679982989119 -0.68561231214432972 -0.97270725009473702 -0.44619599728570442;-0.30363530549752243 -0.31489533544689691 -0.13959903745062902 -0.22196878778369639 0.059921761750101631 0.12931781869065562 -0.22904507381760658 -0.19399613690487988 -0.55900925711117011 -1.3259825310068811 0.65922981067861741 -0.18067028919644701 0.16618326779403456 0.025361212472043156 0.4261037388980381 -0.97646193671949466 0.8295095174609588 -0.29015142774268499 0.4953925491074414 -0.27439816606038542 0.65797366116500089 -0.7777990065923952 1.0586377117367307 -0.40599131989779436 0.28861657565187659 0.027133896931515945 0.67503298585344251 -0.65473429668821037 0.5240148449620966 -0.19365616618045442 -0.30598245825195708 0.12857022938948981 0.048669881783128137 -0.86319088045444137 -0.59162413466556718 0.0052422180837508412 -0.0095385088094280708 0.6581083438558768 -0.09260288299225862 -0.76548843844771408 -0.49219234256304467 0.31462085349852442 0.29178998650588595 0.3258069963593675 0.34305206827575707 -0.54004085690199566 -0.90787859973836327 -0.14042233407064075 -0.15279929950530263 0.6457359948553556 0.15194704996412065 0.1696786804254948 -1.4556253902476062 0.57598484277925888 0.23853513492989267 0.44231548427020512 -0.059328350587380362 0.65517998909594799 -0.33661035197241806 0.95162791756452403;0.007488426608058942 -0.25218200419093101 0.26565832011399321 0.7936554548168353 0.52152091177791615 -0.80927130985939377 0.29438308478902614 -0.1310354745731318 0.23093783203691023 0.46851567041512471 1.3017788108424948 -1.0374743914590345 0.18802255002360532 0.059728494194585389 -0.055463664773959052 0.31842720706371808 0.66132324032138212 -0.21430438526118739 0.22774633752480802 -0.012964012070499176 -0.29797205593406934 1.0629559537371258 0.29093433552781012 0.48620798253689462 -0.095265066532212492 -0.076775001546713781 0.046156410861255694 0.5546508572266704 0.17873830003297159 0.12888169843367708 -0.3784470595285423 -0.15236490771311195 -0.87230305109955553 0.30566683729260619 -0.11671341407477656 0.60236115796320278 -0.21079866491007893 -0.19516881375251849 -0.31301155472774378 -0.30948256297168703 -0.86308124302900413 -0.20533588028053384 0.025712979914366697 0.32859852963287572 -0.451295954606446 0.25556397800798458 -0.6845009191323066 -0.070576388922260522 0.032397815046048516 0.5654507474055992 -0.061145333547185973 0.090021973511210648 -1.2229691157082556 -0.33739513210904382 0.30796545388397473 1.3457288037934809 -0.60857210783721694 0.25719878967090631 -0.53400482429516949 0.54158070671623149];

% Layer 2
b2 = [-0.10368096771525614;-0.27722253409415681;-1.4970186833446129;0.44134283698914822;-0.4872171979194817;1.1977931731530931;-0.21080694965318678;0.38644221998664602;-0.61707967586366519];
LW2_1 = [0.20245599588327623 -0.23014788451700297 0.051825468703050631 -0.79539470726688188 -0.88993361252019954 -1.5235162149788133 -0.085787958393238786 0.5706919524875349 -1.0603384161313492 0.26225538356564942 0.67813729517205978 1.051971347549463 1.9567266028939159 0.084732545244399896 -1.8232351351787983 0.91040402402304654 0.27907487321029861 0.49495163464721853 0.72248826714026904 -0.22411581924593357;1.2893409052310933 0.50879287132472506 1.3420148414871278 1.5930327394001695 -1.5056664150573269 0.016351616353995107 0.99600331758797189 -2.5707171857273363 -3.0348524166890702 -2.5001964241559254 -0.6744386600032527 2.4624189860263801 1.2178001373557625 -1.6826181984596675 -0.41649235430924669 2.5762577107538771 0.31057008158367289 -0.63344929348217394 1.5349175543272664 -0.28019213023171696;-0.15116288152605165 -0.57189679701164253 -1.7713236459966919 0.049142865860088661 0.494445398883881 -0.47532426548310736 -2.208603115921818 2.1885640031694384 1.5951668073362777 2.0873794106176113 0.84301739876671644 -1.5552996606940668 1.6477204898014037 2.5482525359973014 -1.9682852607710934 0.78723926401295308 1.1185821669928084 0.067123518232265353 0.38606161810545908 0.28240655506792428;-0.37079219237399796 -0.61379541622300093 1.2999772344000013 -0.92130312153342253 0.1379087119908389 0.54417297537559584 1.1688708069364522 0.78576370941777562 0.81160661489379027 -0.9353674319465457 -1.976788241343892 0.61749704908100989 2.1278341689888838 0.15495187397175178 0.86507505800032602 -1.6911223924757761 -0.5189535536674329 -1.6349469929869074 -1.8657009360426922 -1.2320159733891209;-0.033529677882031581 -0.40613690278391101 -1.0807932705203946 -1.2980195629149516 0.16654637978043335 0.41546787214390413 -1.9442282716197765 0.35273853628030255 -0.049057843152593442 -1.7849368847559395 0.15769870042682332 -1.1836847720858465 -3.4153881008392215 0.44637443606857896 -1.6358466220098382 -0.38519506096048062 0.13273493809339562 0.94074287778837129 0.46124197481518936 1.4006292747054989;-0.78074251096602265 2.7949664536886916 1.0470069048275545 0.87974177517828411 -0.1790106327802195 -0.79157135745678453 -0.74087193742342328 -0.58910761689376623 0.67356030694152935 -3.0685672107853943 -3.265294527983587 -1.7764881592327824 -0.34268523154258851 -2.253282304524697 -1.0067653857906262 -1.061968143430531 1.0635829735566835 -1.1368834987534562 0.23674989249177011 1.5431899470895356;1.4794602273619808 -1.3089313166522876 -0.10960373819833216 0.10414698642065869 3.2125048144246664 -0.7669208119821348 0.30866953284408821 0.23196780478614848 -1.6113202154820401 2.3014117569667194 0.5250078990579401 1.0209747364623631 -0.16016343922973642 0.3839925961107446 -0.16171594048197035 -0.5019085387250628 -0.52689720530679041 0.95476845965289314 -1.1994310728960995 -0.76149511418445703;0.19028843328685324 0.037588530219588148 0.27321099050813036 -0.29632933310341969 0.69260507517665071 0.69004155116872878 -0.072608441734182225 0.94731351623407711 -0.12480553055842475 -0.14461219104224204 1.5720695598809598 0.43240509754455919 -2.0574416287303494 -1.8353177039391528 4.1754921015251165 0.32996155516647585 -1.147452209803129 0.50013825878511664 1.0444698086504356 -0.48488307717807461;-1.1198835668772531 1.3132736912870131 -0.017965068381284015 0.0056892796572876256 -1.5427238891673734 0.64541095168370977 -0.55900401556225721 -1.1264688168725794 1.7554770676226132 0.98389407839509069 2.2277202844609438 1.4682750937297109 -0.92752536601340707 0.80145490791075935 2.469798098838984 1.4597769775594343 -0.8687690528286135 -0.15003698596321158 -0.4128038933985605 0.14972443447287812];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
