function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 19-Oct-2016 17:46:48.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.5;-52.0625;-32.3125;-13.73;-15.62;-5.26;4;-71.125;-35.375;-17.67;-15.86;-17.23;1.875;-81.5;-66.25;-14.46;-14.92;-35.66;0.6875;-86.75;-175.9375;-15.27;-13.31;-27.49;4.125;-87.625;-126.8125;-17.01;-13.13;-28.31;2.625;-86.9375;-173.125;-14.38;-14.18;-23.82;1.375;-87.8125;-119.0625;-12.08;-14.04;-16.07;1.125;-85.5625;-116.3125;-10.08;-13.29;-17.89;1;-87.8125;-117.75;-5.93;-4.3;-12.47;0.1875;-87.0625;-178.1875;-4.62;-6.33;-5.37];
x1_step1.gain = [0.00568080951535594;0.0231548480463097;0.0455840455840456;0.0744601638123604;0.0655952771400459;0.0795861520095503;0.00566772936592278;0.0205655526992288;0.0353200883002208;0.043535045711798;0.0635324015247776;0.0424628450106157;0.00564872021182701;0.0173913043478261;0.0158572844400396;0.0465332712889716;0.0665335994677312;0.0306936771025169;0.00563777307963355;0.0154365653642065;0.0063872255489022;0.0527704485488127;0.0541418516513265;0.0347403161368769;0.00562291337199086;0.0154738878143133;0.00660338423442014;0.0374812593703148;0.0793335977786593;0.0340773555972057;0.00561305034204526;0.0130187144019528;0.00571530630469727;0.0433651344319167;0.094921689606075;0.0369208048735462;0.00563876651982379;0.013507809202195;0.00683030949839915;0.0497388709276299;0.0801603206412826;0.0475963826749167;0.00561009817671809;0.0151586925627665;0.00866738894907909;0.0692760651195012;0.105263157894737;0.0467617488894085;0.00559049615653389;0.0148011100832562;0.00674536256323777;0.0824062628759786;0.227272727272727;0.0579374275782155;0.00557200069650009;0.0153772224891879;0.00688320068832007;0.196850393700787;0.214592274678112;0.154320987654321];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.3322074086223792;1.1349243550754649;-0.82647843804160115;-1.1158992600793503;0.77368271366639152;0.64391392519289614;0.60666473865351045;0.30265290804783962;0.14404301942988712;0.29573812794133852;-0.22994937402209528;-0.40270215679074439;0.12949821755766661;0.47350679797018275;0.75722702267920405;-0.25009356487786272;0.56137603224881383;0.83629109115396272;1.3245349975394969;-1.2533723634024407];
IW1_1 = [0.21923112100943315 -0.30781891033330122 0.35118596877115538 -0.06788793520334413 0.0040752095481062858 0.13363993484030381 -0.066525618247129659 0.10558582347578618 -0.18232584899642557 -0.065371636084251103 0.14046358926576169 -0.0080704953844510617 0.022586980580156749 -0.29323944365995341 0.18073559072494993 -0.26067497767200531 0.34474003330991548 -0.034650886942364276 0.018361007091235941 -0.22813916314357893 -0.02320780374931615 0.12222744851222425 0.22399799896922123 0.077850467295363004 -0.27592105273933837 -0.31646090277792427 -0.086505577482889007 0.052575471033280807 -0.21254293972395588 -0.30328853962081659 0.14166300455616848 -0.22916783605213967 0.14541087156903384 0.18595342794129757 0.038397551112589329 0.2675152572014397 -0.29104901067706529 0.33385461890033408 0.15277446006961443 0.23151472530399855 -0.20324400433532649 0.0068587224059633465 0.013145726048934697 -0.20928474576054887 0.017905221333889915 0.13714141603431973 0.045297235498402845 -0.23426187708287821 0.18438175730161879 0.096674103408125531 -0.30206996632684463 -0.095599253628376929 -0.25187999877429113 0.19952234823692833 -0.3501428191747934 -0.094808610709197841 0.11218675787928133 0.088365944022073234 0.014853905752914048 -0.2558784687821905;-0.15625947137690049 -0.094568794478499682 -0.15531756627827056 0.022827103400631737 -0.11126554658660319 0.13066845474615285 0.10008072372133482 -0.0051330026740832157 -0.055232871140525094 -0.16127846873931739 0.092464034539220932 -0.027492447754469608 0.38818352107268689 -0.54258475977551568 -0.17691724192956804 -0.072771587526905601 -0.15746289938046593 -0.3950662037023896 0.23418073888335372 -0.11610203717533388 -0.27587301698162714 -0.04285512678126209 0.15982613199056744 0.12628523877620038 0.013245255479489432 -0.082322275192919375 -0.18000859203190345 0.18332035871031591 0.34543871042366853 0.12296327513159996 0.023370067770981735 0.12734895484395059 0.051956139621505332 -0.042971679439147301 -0.20162272684663085 -0.20405093344982492 0.47958395410155502 0.094978316943466576 -0.45101938511378503 0.35050516288962069 -0.32077581548157164 -0.34547521440070272 0.29470966283702155 0.27114401229913293 -0.48681243906345245 0.30162877789389841 0.083745698848158578 -0.13598511078626194 -0.15795261990098777 0.21978043744891429 -0.6367073333272143 0.31573560168192089 0.032163523731172011 0.0038301751073315619 -0.094343337746849901 0.18956983506267405 -0.077535233026779921 -0.023412672589192787 -0.25532343990031825 0.27350132501800706;0.11401046932804793 -0.49369710757979995 0.2346311340914502 -0.32242412935536036 0.58679735538022293 -0.35948760479937492 0.32336892207506235 -0.27651775942663925 -0.21011718982380373 -0.46627269816309225 0.10058466376019363 -0.2196580332241094 0.064735171458288859 0.27730752304984257 0.40657158364649126 0.14390570784500464 -0.28945373583271783 0.021868582373260149 0.51619139004977366 0.31424955639051977 0.46304210396905432 -0.16820868016504012 -0.66687955129034404 -0.14700272605690606 0.69848520539854508 0.013444659529794166 0.014270314462843131 -0.13877433038970302 -0.38684018685392424 0.12735408250521243 0.74407841798336816 0.15144988337331086 0.19593391764279933 0.35817284949135153 -0.15871836828786934 -0.19459234582266496 0.76022471043057727 -0.041554549250294892 0.0048848973354431941 0.092694933009809535 0.15644572942132512 -0.071865729828154007 0.66740120380390044 -0.13124101964540069 0.0079023702758483187 0.28152306357113288 0.089096635122472734 -0.32618261350873123 0.18906549196418485 0.20395843355936627 -0.14907098615847533 -0.21825337714917986 0.13689309671841565 -0.34165716386296036 0.51614085073240668 0.10372594618933202 0.10256701903760777 0.24749855734546863 0.29372088688930692 -0.43023415736111492;0.1322532328748062 0.37527748019188939 -0.01996268641730484 0.62395457723276693 -0.18996445744287366 -0.038381590640266722 -0.045229919721947766 0.49407677557602797 -0.054586585537681392 0.59877364390744126 -0.0013598798374036686 0.064068306357107307 -0.20548456458768913 0.59638778027057493 -0.16990322551266526 0.21323113874875593 0.017883297689329437 -0.026469692630539707 -0.36406061876023182 0.17959710530895623 0.21755820474728169 -0.11204974820225611 0.0014740957476401311 -0.048652657639870436 0.2355764861457153 0.14241678388913248 -0.041591409566182208 -0.519744168045852 0.30258945030182616 -0.060016767747111927 -0.35442147234775001 -0.0028309624324172056 -0.47273730576213602 -0.16111112549353798 0.26631776440179189 0.36609853452616342 0.051354682223133094 -0.60625176944015535 -0.58523669954077484 -0.39480921524018991 0.48889075594097819 -0.17740543215404417 -0.26983064547408497 -0.57244700535802995 -0.81432301775406302 -0.52741042244738068 0.067822561341526547 0.082994659028002571 0.0085320745598271609 -0.74616293235503717 -0.47684631168203218 -0.051958919741600815 -0.057245669980513225 -0.35938789167406188 0.0014873103505601559 -0.70582610261585566 -0.5156251187643841 0.11869063244780173 -0.12591019787970004 -0.028213794714593406;0.15006030442666898 0.21903207509744443 -0.22123308861522339 0.27082885951424351 -0.062008405644637804 -0.0092079560091636661 0.24354214655541487 0.79122926379066383 0.0039689443532296073 0.3477106384422165 0.13948362385417076 0.45745240046400248 0.30328563596728975 0.83086617724479739 0.26709032852914755 -0.8574121478999136 -0.087641154352145909 0.33333837227922125 0.40188396907087504 0.3204159053752515 0.44419065156932142 -0.44121645629535972 0.15137916378163177 0.061668199286167562 -0.20314348040921629 0.17768285649045892 0.23720952040716858 -0.096311511367847602 -0.041249619201832122 0.072861451377253181 0.094756584128463925 -0.19808075971473363 0.21504733632432035 0.31908411653586877 -0.20014730514958301 -0.20248196288217174 0.16004068537029251 -0.41000830112430142 0.13297004122502779 -0.30429703487402027 -0.048528779920958373 -0.58471137263383266 0.17030663293582712 -0.79452338920409593 -0.15790026782608568 0.36698386850677372 -0.35182658145376072 -0.00068213763360538623 0.015698512735387318 -0.88759776084820674 0.38375378882351147 -0.073837274168479808 0.060227524923246886 -0.14470177164192707 -0.16276971479548008 -0.56079110732919801 -0.12340419466094234 -0.4610273279094127 0.067159603076533403 -0.088904566806551996;-0.96050216688973 -0.12094059493343359 -0.37860592540643867 -0.53430985183790403 0.67494321574839633 0.2361735119571797 -0.67839074345773898 0.52039764046091475 0.61704481754576579 -0.33266017181936391 0.50662827957030843 0.30531389786093949 -0.31600531851899244 0.18845339526815155 0.42622316073399785 -0.24362921946541743 0.098321656654344045 -0.20681190995856746 0.46573427249361204 0.057251233708051442 0.38222508124431104 -0.53103093551188862 -0.50858640954368073 -0.034359578151386586 0.50205223993573689 0.032395396995972499 0.33848962884744949 -0.087962536831588528 -0.048523886398391003 0.025984875226162593 0.55780486189572309 0.040094663041039424 0.5036800063675424 0.36271339744645992 -0.4708887602185714 -0.035643635482470279 0.5941819423901632 -0.40094176504692425 0.83629464603987225 0.3539432222198679 -0.58492960824390861 -0.29213529119809706 0.29669686015304347 -0.15795117676728201 0.69074320263226796 0.13896435265463672 -0.25470949064218484 -0.12597759802312322 0.29238162830587555 -0.12602831705337672 0.58067562135203821 0.14181300251714823 0.16610366298806317 0.050236835909381654 0.54515333751138106 -0.15253268727956934 0.17209486914106373 -0.18685604756336865 0.12349695536205882 -0.035600551272110231;-0.91162442898037055 -0.64085411319313201 0.22345320235116384 -0.42980813367964787 0.81611094974199605 -0.41781516594238494 -0.4027195209822938 -0.35354559583904338 0.13061012144811224 -1.4181409240896192 1.1008677752054692 0.24937548524602307 0.024046821786598685 -0.32214665478138266 -0.44507944905665825 -0.20961008904714451 -0.039933979088255793 0.093577603478637944 0.49450097499533369 0.39639689665647609 0.053813303030600432 -0.28764757363834692 -0.24914611462083569 0.014034594283172587 0.53661362583351735 0.42600936512144749 0.042914124690926994 0.15122487282654801 0.048977120924624265 -0.36683974353612853 0.36686949807560604 0.18867225565959708 -0.20852479004517097 0.46673354325743999 -0.77240358599422265 -0.43134186722000162 0.90257330264176905 -0.37262885632688036 -0.18893253021336381 0.51943228863028623 -0.39758214508384293 -0.57071262324097627 0.96497570831553703 -0.70566504558859577 -0.89160363515532626 0.50949477144928168 -0.0084111525556567496 0.0031190665576891798 0.79397829714188572 -0.7318279127845928 -0.57035257655227334 -0.12034720191094508 0.44327899728295106 -0.14266023133474465 0.33914906663279509 -0.34583660419562268 -0.7136832465236449 0.66254317337975555 5.3334685824861679e-05 -0.78049641846091122;-0.31095403098358126 -0.29255423324217422 -0.30781180107656164 0.34096206915754601 0.029237928404791093 -0.27632677887775148 0.052880855262434655 -0.20286262193512916 -0.27411524120823821 -0.32430329401416064 -0.2918490672598516 -0.06500808138431978 -0.1948013300353561 -0.37501524104648365 -0.53581587801177744 0.026994552543272085 -0.008547033328001408 -0.22083152426750741 -0.24583299533919323 -0.11279485721528411 -0.12478733840894922 0.36176506326153607 -0.20184151826217411 -0.35860833427556554 0.076480281081427931 0.027813576769723968 -0.03248038849128583 0.36315489512001464 -0.00025815655144724345 -0.1206602257196224 -0.47475550750767798 -0.082622719953748661 -0.53123302855142984 0.64280483352836315 -0.20723111424271151 -0.52172539724065625 -0.62399330984144663 0.18578503171287494 -0.21996822868461557 1.0348027272279692 -0.2110095562933563 -0.26178725711034867 -0.26435445084110276 0.070751710998890466 -0.45683123132652825 0.47603008328848295 -0.064510867718376955 0.17438491090946054 -0.19872191810566703 0.42756131119381691 -0.32850242900600019 0.4052350458680703 0.22082311657267917 0.26011601842266385 -0.59018905758922247 0.50366287985859759 -0.16279354207153532 0.022705506137658059 -0.31152761865611778 0.23755309407766509;0.1716334772229112 -0.14010682674194469 -0.27591118501470868 -0.48013510923570268 0.22945434729972689 -0.39288779290041959 0.22392956287844565 -0.34477104098792866 -0.31565879249814133 -0.15427300381314893 0.31285197158810224 -0.21475690315718993 -0.09464037313581497 -0.33321638943681986 -0.64595628042596687 0.74086635164070769 0.26168237189101845 -0.30467630164092319 -0.041224967690847401 -0.20187126811516934 0.20496405751501998 0.58873837131587781 -0.17982820257033247 0.02764551271158543 -0.44743138702115332 -0.2486728588940475 -0.06425245331095579 0.46728611273882276 -0.03708342704127611 -0.24712435057048193 -0.23549910686627593 -0.028918443479003873 0.25222457082017258 1.0622041281134869 -0.019774782308801305 -0.63140467684000134 0.097119471118660039 0.39261369391282058 0.3331440151810352 0.81617179571117504 -0.18558817389889545 -0.64248852878787988 0.07960968796314577 0.79540473248169818 0.57830741655791129 0.56663251695664896 -0.16651025369580799 0.24733405222678259 -0.21862125098757484 0.94201205876391214 0.22606686976047513 0.36650034351196692 0.041752068703194263 0.49173941669359633 0.12942098025046336 1.2883525191464453 0.30900882531343421 -0.52048108335261267 0.16731568234402089 0.46423651841645663;-0.97439990003476185 0.10432772957438996 -1.4196920158027075 0.71619337792442783 0.93528740454707482 -0.15282436523383863 -0.81527282945363244 0.31374404621058199 -0.54190289169672357 0.87755667642194068 0.57981420798307082 0.19428972668678973 -0.37939628537863734 0.077203929942086677 0.44087535738445749 0.25609748869188037 0.17649362935454449 0.13493507850520287 0.037007511328547432 -0.19849365397976454 0.032634111886428598 0.69249567522482358 -0.032876862611741185 0.016426467387210108 -0.23972785577564057 -0.26779081512071973 0.53286403275930172 0.096757865057202921 0.25034109914181396 -0.072099514839869872 0.154415076646466 0.048663598861380747 0.53447572107164687 -0.55107654267552764 -0.32242310378985589 0.16430612123587296 0.53714457516806402 -0.26685608716835102 1.088153126151499 -0.52917782363700794 0.020069228724069028 0.17516733143612925 0.52958945934514023 -0.40827570210978409 1.3352534446170439 -1.1607750025034038 0.0034932989595290384 0.15489961399588581 0.48884443191050891 -0.60268043976457097 1.0804027181101297 -0.43520626786189565 0.057196219788257084 -0.19188188475251322 -0.054494038313114682 -0.28748341318483367 0.82111127452844546 0.19199583071557252 0.59937859463823762 0.394796299433952;-0.84096959842168417 0.42128581207665622 -0.2485173559832175 0.097784666299274695 0.32923736258204955 0.13603166930193211 -0.40159083397165923 0.087281244266573049 0.51432994131654197 -0.047036529828585465 0.75028572953209094 -0.068099706739981128 0.058721888773473584 0.38612486743414381 0.093965272186715881 0.27841201977196267 0.035287512502947635 0.317044942482757 -0.20828678913662146 -0.32975293087112173 -0.052253641592574104 0.25232689580887846 0.017553302398060914 0.025407072018921457 0.44331897566505718 -0.39448390238268755 -0.41690035463147929 -0.36656134264712287 -0.022125811598247017 0.23220321484227377 0.024068615141964456 -0.25997259583706656 -0.3495417209082462 -0.070079752389242606 -0.22259007303069803 0.014473806732946903 0.55566887823865241 -0.1829022526330053 -0.35576249368701601 0.07563069803045902 -0.35031917284462799 -0.017612495231611881 0.11798978073266071 -0.49882476175205703 -0.51675918157726797 -0.25012676073671208 0.066370370003048462 0.19974344242663131 0.27356392674270796 -0.69355833406272349 -0.34415221005619218 -0.25089779627681547 0.1445728195813139 -0.1302867027842233 0.08239026104433278 -0.57902979807782129 -0.49647255195333456 -0.058979023911900311 -0.10363174761108064 -0.00022678170415918984;0.75364872550930462 -0.14960252043451844 -0.1103545075686288 -0.70363761317160345 -0.66479260298173137 0.23115736911646037 0.40413099377865724 0.034285130504996424 0.49458227588434045 0.0993733080444405 -1.0018020008036483 -0.055337081201421875 0.10049714309217744 0.098090275981365632 0.4144883291170246 -0.72033897325306506 0.26029928574184874 0.13425284048741973 -0.11635753658352807 0.30330824684784458 -0.0039475594114811415 -0.49988898166229101 0.45873715779491259 -0.51388831669986568 -0.14026151347933322 0.19076722231857132 0.40229465746130855 0.062858678287926351 -0.27493568450838451 0.11094338088473672 -0.23402956019585189 0.25389962749338024 0.063099192995981823 0.056029307532216591 -0.1456619995170349 0.5212621029146135 -0.20122267993526111 0.64367019932425895 0.12316919811286904 -0.00335991486285293 0.11212464692349498 0.36844900979001649 -0.14327058419360394 -0.00032701465406398227 0.28558214872069893 0.10840708546608724 0.21029077501334664 -0.14640499030457402 -0.096124295826218911 0.27146141781317062 0.40874779181667092 0.18995211033421769 -0.51386351810915198 -0.13874925498662891 0.30084695055745286 0.36719535572662121 0.4955144933907113 -0.12439007327257694 -0.075959174722874612 -0.4409188283376772;-0.12187022939090141 0.45129678920064337 1.0046383951385678 -0.056787600918462328 0.0059051886566508973 0.63900644514874028 -0.39230333415739022 0.42403208077339916 1.0173037855187876 -0.15572044695188297 0.30706748676708279 0.28938832387628183 0.26057998416136163 -0.04359572623597071 0.081407407515609959 -0.425268132589873 -0.075889637745003194 0.30943956131302519 -0.065283463135290182 -0.58799625129077682 0.20985604198086319 -0.3005242007831736 -0.50857272468176484 -0.28180651439850574 0.36599790662730325 -0.88506959266388419 -0.19423493674788569 0.5309729960423315 -0.18801202955995644 -0.19130856417715789 0.064202720153983178 -0.40273609266612254 -0.25369595682907586 0.21650312330462407 0.090152106043921112 0.018356194613429338 0.49513816286949197 -0.069553471091292285 -0.38387976781528582 0.24456409882188626 -0.049852866038361594 0.041153560080436448 0.21481280030895733 0.024773448934954197 -0.75612001661347295 0.5452595972878489 -0.26990715611681482 0.19403223322143526 0.22507429321021016 -0.034757221073414016 -0.79623721143367454 0.15834283967354118 -0.2529298694992701 0.069031926720152875 0.19490229044342045 -0.0055061743824199238 -0.22290205829772267 -0.088908907423611835 0.63682759955315504 0.22616270395739363;-0.16331410515673936 -0.37914944904206033 0.75089614140382532 -0.56644961466118771 0.52301030359894585 -0.28076925441924078 -0.23217008420797219 -0.53948761629324926 0.081962622552733913 -0.47492341407554661 0.79391122000271186 -0.0022475645271810007 -0.22528376113912607 -0.49901587862678826 0.026817074158636829 -0.031135399585608532 -0.083907999897246066 0.092436611685105904 0.0026892103949325737 -0.34592214767100432 0.36374747021747478 -0.6285757412493671 -0.21544747670634146 0.38404417330340856 0.28120928889470831 -0.14860483045362705 0.26623000021465304 -0.24480292003096563 -0.1977991765845811 0.30767665071199196 0.40072301833425855 0.34051303566302055 0.032928431120390997 -0.0047437433560881849 -0.10858552818143979 0.1010385851042456 -0.064470395996758814 0.60864005488575823 0.66595851703346332 -0.26141567212102401 0.17671553917505536 -0.089523486535612817 0.27144938015117326 0.75307667078951135 0.37295906895256808 0.24911668370791087 0.18815518178968263 0.24886185753617537 0.1086812650171543 0.396214081078124 0.59568115664820076 0.31895332980780994 0.34348715216885861 0.22417372828168564 0.46861656742881369 0.5168808230723565 0.38315558930841659 -0.20117101771769302 -0.14777583675091893 -0.065944744319306123;-0.22389972414012041 -0.052327323077349365 -0.34521163832291657 0.62764109080460395 0.55753783115211875 0.29899088827139902 -0.45330619345855139 -0.23156792436536738 -0.096074480195327466 1.0417147346543454 0.66261457994067618 -0.50820926163487778 -0.10471420541893657 -0.59274162824283549 0.26710558991965011 0.50593212623106898 -0.33049989482902897 -0.13447657620535139 0.45511689921210563 -0.32043135724970501 -0.15477573692255825 0.32954189020442104 -0.26172864942503554 -0.08932031529323943 0.25997759356518141 0.088260603415719091 -0.0017850538701041051 -0.33005400210478641 -0.13734233519091327 0.48802274296905301 0.28141736345698309 -0.10733553694852896 0.074891853626047111 -0.46794963563301556 -0.22363398361064957 0.43576974520834028 0.52001823368586841 0.19144445889546149 -0.30573078537101828 -0.87395540481865397 0.13719354773389356 0.20964671129910448 0.35936559466271689 0.16489071551022641 0.27630852002670203 -0.41259346717608159 0.11224123278371143 0.31836800842866664 0.59547025408843746 0.019400383520031927 -0.12822457198730025 0.31916410531720396 0.73298319083257102 0.033160806752547345 0.48005284349014832 0.35831630741767695 0.32331581916894736 -0.1409530792876883 0.20728334768036422 0.60386448722696628;-0.33664863330433159 -0.03510570083839152 -0.75738449504514305 0.45942100710668737 0.095178951747953905 0.21833422200166874 0.34608389874340406 -0.25600695015998187 -0.31288369209912026 0.18304010035424426 -0.031119353652531503 -0.16049782337274798 -0.15116598192161426 -0.45674141219934772 0.059711056026257668 0.24111627774042066 -0.10691651376806992 -0.11482497723023928 -0.26490240566532008 -0.19450037192719977 0.31090824258644673 0.25414848043591903 -0.16770088423693669 -0.18524020076902312 0.034873441732836408 0.13685094410832116 0.37343517055114567 0.62532529721502839 -0.28062159751960103 -0.13148205412578592 0.36201503324425971 0.13060076272228818 0.65383423565411791 0.045442372376223596 -0.18183280670631544 -0.39523702379594783 0.088484726796219756 0.26888484604475937 0.73232151469980622 0.2711976192231571 0.083939136531397146 -0.29152589057632683 0.051776148548987211 0.81691671124478393 0.51050563140440819 0.27981759315124655 -0.1710649387335719 -0.029411710668753688 -0.016542298766259372 0.55771253069752402 0.62420090590928867 -0.52736612976981245 -0.029569171523689285 0.30902660242837671 0.064253854497313634 0.8210902569301497 0.86533116089312245 -0.10923481784557078 0.35706247448309092 0.13097545336129451;0.66284736897453145 0.1615765706014706 0.48737053770767658 -0.84177509305207698 -0.25152541584329435 0.2116800797044503 -0.031259386009688105 -0.014643975540729794 -0.4006164673473534 -0.5155156689218896 -0.055242580419723533 0.58274127555150956 0.0077436354547158175 -0.15641484760734431 -0.033241316009176951 0.39196957838519353 0.25464756998386895 0.21520999918453099 0.33411430323341379 0.35998826389037086 -0.037619963239018533 0.57175472674862338 0.38516296610797657 -0.019128060824574595 -0.05305781204758641 0.32415548108240044 0.23334583584596111 0.27812381028187561 0.11362511139217757 -0.10953615481226096 0.077242249427483159 -0.14270395280224754 -0.010018464322340846 0.53880281910675454 0.11973750347579175 -0.037069923351038737 -0.33479873490281858 -0.51155004548066052 0.53535818960525383 0.28167778092344881 -0.13289598138550551 -0.25954778670333994 0.10701587953526999 -0.52795144010782169 0.73606052118296961 0.19704700592506844 -0.087803230464872553 -0.17161402014479399 -0.24426965235855364 -0.55161292143054963 0.48543461987572523 -0.16823052315616355 0.039376482120618728 -0.19062966646297691 -0.32154449978242827 -0.71507806290795028 0.503348028041403 0.56900017377704493 -0.28202885514841852 -0.29542060626342975;0.80080173120693432 -0.2696188179941526 0.37808939064430686 -0.84952526932786598 -0.93004624054741858 -0.052909839950810694 0.20614643434383978 -0.023743459991411208 0.28268093614671325 -0.22883587387573709 -0.58661720916573568 0.47473898106274937 -0.032208432282962739 0.12672798099045599 0.031647281774458413 -0.19456962138807307 0.30665499175128974 0.39779723296359792 -0.20554569483079368 0.057999947924930823 -0.11571740660490601 -0.61307753595277381 0.24529788712256922 -0.14520761591380613 -0.15373207637175018 0.24808621417163837 0.57197905995572307 -0.41719300215331945 0.48401366440014737 -0.2313475026919605 -0.11969614725451649 0.04144848806071974 0.5470616973561091 -0.33196311182031274 0.43530895012339849 0.11595005822135598 -0.027289635805785233 -0.27130592567222583 0.36629218088237958 -0.27188441421905996 0.44745917565653914 0.21422291609800226 -0.03240279518486032 -0.83927245589553112 0.96355811038178085 -0.6267324211401063 0.1382218659567335 0.04093562566896275 -0.50214855600310948 -1.3523777761242635 0.72926605821932333 0.15512778534601732 -0.38252507320362389 -0.20351642245125121 -0.31272123020578552 -1.2190385289664898 0.32727660880735188 0.52701050657576687 -0.37925760967875333 0.026212473633763472;0.43274403749214185 0.18329070608816853 -0.35656373034003713 0.9182934221876069 -0.18926759892680284 0.12246877996076769 0.34181002274451233 -0.014772331708261539 0.024828297724708695 1.0576323327047026 -0.027263623020028726 0.0016532526765712617 0.42960751014633608 0.063158964820542771 0.097511425997062542 0.49150594616981708 -0.22969651044645867 0.27638751704765463 -0.22103888947085829 -0.24431591554211735 0.11093289715254052 0.15249772412063789 0.051360993694029355 9.0539207862663437e-05 0.093344141340985773 0.10936159093565806 0.5475677127227524 -0.022718509012852748 -0.051908913902528511 0.17695737798521233 -0.35358256512833397 -0.18240557952772538 0.21562813052450508 0.33338868885120337 -0.0090092714312869325 -0.28030217530622464 -0.067062712433639454 0.0013058882588051967 0.25195697506600556 0.32896797656530047 0.26323814055379779 -0.36239578264652333 -0.31525029666404658 0.31471190084448081 0.982525444210818 0.50824660738978877 -0.054866366215159591 0.071811719933925003 -0.27691496576329883 0.028953220202050042 0.70308657134353347 0.0045805814367066364 -0.10368271968951417 0.055120744164191486 -0.070188995096240048 -0.046236833718757628 0.72925270067655168 0.010282176167655182 0.29063416494310157 0.31515111579212846;-0.11446074641239333 -0.069308199337576357 -0.088508517744544934 -0.089590808341601783 -0.11586067267747906 0.096556475111035711 -0.025553445070882579 -0.30694497429621792 -0.21686377767818443 -0.28508373324479835 -0.25428578698325688 0.36510780126515907 -0.4050418693241345 -0.36718481432364319 -0.22178697001723563 0.3091815973158985 -0.28641053187526677 -0.024469104169172043 0.22710791482860765 -0.17443481635334787 -0.026453344013792759 0.12537739191524441 -0.11478810018289044 -0.39529297716505479 -0.39834365883162115 -0.23505103099591115 -0.17525873647299861 0.27247262047936222 -0.32492222930114262 -0.057002685171763441 0.14615068952574473 -0.12367836283092989 -0.19114353455286931 -0.071027093090046539 -0.065540831380302339 -0.10140112866603336 -0.31804881356511583 0.13538449891512314 -0.086859410635149861 0.27844788210321142 0.32394010657024375 -0.25832184999155433 -0.22528521471818316 -0.084173072510113453 0.13217966388865038 0.095097582437141698 -0.068809339966657973 0.2646626334050326 0.1683792889838765 0.1865474940524062 0.12178550469687209 -0.0064385586565215416 0.033789372469199504 0.021207957147735979 -0.21830423491269224 0.092051648438675832 0.026941993782301683 0.14805835295393499 0.25429062656282925 0.005024830477884515];

% Layer 2
b2 = [0.77893274317924333;0.73290202865770393;-0.54256136755478979;-0.40249104947505354;0.071196569006967136;0.22391807684879889;-0.016626746152357631;-0.6036514187367179;-0.56436664345118148];
LW2_1 = [0.66640813995661807 -0.706664698082902 0.58688811284932429 -1.1692852938287792 1.0745936692436175 1.0027970257296843 -0.73313533726044944 -1.1797621549309172 -1.0755097089038741 -1.5021457635896642 -0.2771032559824379 0.89810095446173477 1.3742557166781313 0.83112893471068505 -0.083006502551793523 -1.0812924136792295 -0.85049110264054684 1.0842986410606206 0.02359754409394392 0.74198036271543222;0.06134099479171147 0.60412642075732381 0.56675036904778497 -0.52646633254181718 -0.5476909281094906 -0.4751105850015655 2.4314119106456742 0.55798496377452622 0.4518838423528192 -2.5123366774544738 0.00044710549728395679 -0.80093520284729447 -0.0014647979910264591 1.5244605735719046 -0.5781308221508602 -1.1965283616352929 0.6595641682883987 0.37460046540354114 -1.2530790839598382 -0.05390920077595187;-0.58077541774139929 -0.35566540628168503 -1.1817367351198409 0.20485720969682245 -0.41514167674616098 -0.91272069490314356 -1.8803713728731368 -0.91960392044603634 -0.70873572258567274 1.4999821736778771 0.01358419795299478 -0.83897802159274892 -1.2597317906764411 0.35223677685832744 1.7764946318028332 -0.66628960317266595 0.15136278738508477 1.5448040496639639 0.14065511665795569 -0.68168177546810915;0.21610250055944999 -0.12185059068247812 -0.025212637379015523 0.46631952302166729 0.57947406621157249 -1.9175787386256695 -1.9238929632685142 1.0296422196274972 -0.0017525438221120439 -2.2840980325296862 -0.93137469916059334 0.7243913765120702 -1.3376266304577946 -1.6522703770704799 -1.2660353099683421 -0.52265658410091409 -0.10343440241954603 0.32503712286892855 0.31713846843701066 -0.15433136503820796;0.37173946540256814 0.18147512149695474 0.98035128362178159 -0.21844005599630134 0.74193690365714815 1.563193159600605 1.7836988710181763 0.15078963277351878 0.26689148960380715 2.0840520787297274 0.77853755997205432 -0.95303853904145086 -0.98750605910743017 -0.20957605578764027 0.66045453147973332 0.21851855818657973 -1.0680741856411644 -1.5854212166764277 -0.5603400491797409 -0.56933936038360122;-0.49345547396741435 0.40987690802711646 0.0063445288662919656 -1.1663784391072654 -1.6182994032813751 -0.04359746664038873 -1.4493252230956044 0.71148426199699721 2.0173069895840503 -0.87839039691677556 -0.28737165776681362 -0.84220973504340257 0.9782238587830614 0.26543358659287741 0.37917153964576072 0.81119558439652006 -0.37721415773621642 -1.409082521751325 1.6538412434691603 -0.20787530005548602;0.051871526807240831 -0.88188060382354228 0.47033602713069572 1.7881670967589662 0.74422104900376929 0.095944853343091302 0.15537615526432078 -0.5845960827714054 -0.93270824598943758 0.035857876925734611 1.7324637907946681 -1.4364290890151368 0.42289519738610781 -2.0177879500985512 -0.64432606256978608 -0.99999392126881981 1.8018353738701056 1.3391823293551917 0.2265711702514443 0.34462477417283799;-0.53782725968624479 0.89081217833569293 0.24742696924490162 1.854833351151074 -0.49774779691935994 -0.060926309220866712 -0.17230623253056224 -0.47185596279878445 -1.4147200316955819 -1.8383946803180264 1.7600562832913738 -0.90176395186602454 0.46872038326084853 -0.70608211827406886 -0.1251780870798038 -0.94096940861481582 -1.0392909820192073 -1.892094874160303 -1.7574514730523818 0.4178214077883477;-0.22275297154692664 -0.66108458374173551 1.112005411614966 -0.53652555600874896 -0.027165306990427667 1.2839782276830518 -0.68104542318689665 -0.59433340246081334 1.4698701934980654 0.40520587128684082 -1.4092181770567076 0.90742919422588286 -0.60425614374597691 0.45291626890316689 -1.2107937137594602 2.1588584489741853 1.4554549890459656 1.4223046519394873 0.44171371677583771 -0.11568704288833705];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
