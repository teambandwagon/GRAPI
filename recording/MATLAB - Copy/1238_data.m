function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 10-Oct-2016 14:20:11.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.5;-84.8125;-100.3125;-5.02;-7.32;-6.36;0.75;-84.3125;-86.375;-8.09;-12.43;-12.01;0;-84.1875;-85.875;-25.58;-20;-35.66;0.6875;-86.75;-175.9375;-9.77;-21.72;-42.33;0.0625;-87.625;-176.875;-16.06;-23.64;-44.65;0.8125;-87.375;-177.4375;-14.61;-25.72;-42.46;0;-87.8125;-119.0625;-11.72;-28.91;-43.54;0.125;-86.125;-177;-13.09;-19.96;-35.77;0.5625;-87.8125;-126.8125;-10.51;-17.61;-25.88;0.1875;-87.0625;-178.1875;-5.17;-8.34;-7.99];
x1_step1.gain = [0.00556618542355192;0.0173253925284245;0.00718616662923872;0.145243282498184;0.128452151573539;0.0762485703393061;0.00557103064066852;0.0167890870933893;0.00754361150400754;0.055005500550055;0.0630914826498423;0.0462962962962963;0.00556038227628149;0.0165118679050568;0.00755608028335301;0.0336530371866061;0.0537923614846692;0.0303536196691455;0.00557200069650009;0.0169941582580988;0.00563876651982379;0.0577533930118395;0.0484613520717228;0.0276204944068499;0.00555941626129256;0.0147194112235511;0.00562587904360056;0.042256496936404;0.0489476260401371;0.0259437021662991;0.00557491289198606;0.0143112701252236;0.00561896400351185;0.0351802990325418;0.0439463854098;0.027311211252219;0.00557394182198223;0.0139009556907037;0.00672410170203824;0.0367849917233769;0.0355808574986657;0.0270160745643658;0.00559342772242615;0.0141655599822931;0.00562884784520668;0.0382409177820268;0.0459453250631748;0.0299625468164794;0.00556909154194222;0.0137634408602151;0.00654530578850481;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00557200069650009;0.014807959278112;0.00561502017897877;0.0446229361892012;0.0906207521522429;0.0518806744487678];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4291366546546662;-1.3263945521619835;0.0042887174234663081;0.6749316118020281;0.82442848204919972;-0.94207948637716299;-1.1762993151286079;0.3477435341897025;0.50642028939934491;0.0074482031387026141;-0.27167911416741747;-0.58768003913808575;-1.0150317070727781;0.52336825082063909;1.1205994368815393;-0.22624421183560947;1.2440069489799233;-0.97644898970000804;1.4961838975069093;-1.0683848713486375];
IW1_1 = [0.22015394722484644 -0.0078653548731009194 0.1837071681210353 -0.24906327313094548 -0.057580212490484547 0.67903807835848728 -0.084475969913748103 0.19031984880078662 0.38012312783147434 -0.090384989781616076 0.67870438946560541 1.0859618179195258 0.16462862746089998 -0.17885878635828764 0.39909988692853948 -0.57574739950448883 0.24142926468694323 0.9727558016009028 0.16069825526660719 -0.011155944980610802 0.1023965897162295 -0.30528869473026676 0.34530031161681912 0.48979935780098727 -0.041401157164400654 0.37227603049948393 0.026673322101527144 -0.11976742494894169 0.48699850870937955 -0.27279277959877074 -0.19911965136678941 0.51295632718330564 -0.17491504716098719 -0.650788744965486 0.2651060616920759 -0.48738486793839025 -0.31424661577054386 0.18758197528758971 -0.6135159469544772 -0.4649876427880732 0.11241598283704117 -0.1278411000611947 0.14069288372415423 -0.2257900625704114 -0.53238958579443207 -0.38416307593968652 -0.21459137786438545 -0.49960774245486134 0.2435882222540422 -0.68383932606416042 -0.86012589707448639 -1.0239897803582441 0.063274143205091574 -0.43701545929433427 -0.25384507026559044 -0.53922986610398738 -0.72675924506371492 -0.6650095545321143 -0.037181193356952046 -0.56454755251803079;0.039027092517045288 -0.98229861001882202 0.52938464241556193 -0.73399199970993112 -0.070109216412012398 -0.079132893845417357 -0.2486258453808996 -1.1702034852736227 0.47471752936545658 -1.1502019522874674 -1.1553491159966702 0.29852206599140496 0.0073074317528420574 -0.9987819540067745 0.38914012337498965 -0.24023926609750476 -0.003504366317548354 0.54140205371337402 0.14422373644485473 -0.42746097324271359 0.17407248628734948 -1.6712896831957611 0.31831715490000062 0.31376911779134492 0.18277047139906147 -0.23207602188136578 -0.40542821511035976 -0.90536525263467393 0.67487658553124596 0.1663855471172645 0.17676890814594207 0.093615529531884803 0.064124506414103347 -0.71751357732909071 0.75944391743557205 0.060694648770099807 -0.56120873150711359 -0.63492182022425847 -0.206994757083309 -0.86639308436014795 0.39005370019625557 0.38127032996335819 -0.06021568465397837 -0.43897201929078433 0.1506982259359646 -1.0509074170788335 0.84596306712145508 0.41378616328317402 -0.022436519681686536 -0.12962752882055231 0.16271907952299888 -0.52726837377085656 0.32443938843332731 0.44069591947243475 0.35744551724228713 0.057703088864043177 0.71997261986193928 0.12946866278254054 -0.27152579690138789 0.14426683096423165;-0.1678674374946123 -0.13761033744829362 0.51395378368048661 -0.66325648820122329 0.69128820806897373 1.0729165317291751 -0.13930725307044153 -0.1056289510161403 0.2372399513142949 0.034595468046117496 1.285563196539907 0.64390311060742655 0.54054290714816744 0.10698954164258218 0.085348330786949686 -1.0204897380715248 0.41396337916063791 0.83487913370347078 -0.013014311026200411 0.014640031320998236 -0.085113469012178158 -1.294118750830366 0.21256446756533504 0.22501983450031846 0.053134272731415182 0.023739248033116278 0.19471057405120767 -0.94218964510697933 0.070115269501924551 -0.48848137375800416 -0.15837326321052606 0.064579930877607897 0.30104110159199265 -0.83823292434385777 -0.022786043568623328 -0.53944336451474162 -0.15695147170910603 0.27177869582670122 -0.082389500540338098 -0.42736343541039623 0.21151264130623298 -0.55022434360055938 0.14058096027527364 -0.4961903741546792 0.13400879047187372 -0.79654372961152042 -0.053088173957666476 -0.090676933996243381 0.10376389278329916 -0.78301851540939071 0.53032246754256085 -0.59013207971568482 -0.64156241923004975 0.47891078875969834 0.010815254325067648 -1.1475846035844135 0.07291964584754293 -0.038969775027017838 -0.78037678962185419 0.1350213683108108;-0.16544628648807264 0.92389988001383061 -1.057596678837607 1.1298840042615304 0.82320544057587286 -0.48140452668888545 -0.28979903311742328 0.38101155581447416 -0.69616635923266101 2.062541844704104 2.2907859147951308 -0.45196927105374063 0.12745325859325146 0.1240005360669488 -0.92710503209593131 0.25748097517795121 1.295674784443736 -0.97623630485968615 0.080959660059483324 0.021799517233950797 -0.10911151330571149 2.1813236603670716 0.7593569060516111 -0.47355320258291367 0.42056339773666163 0.19647165606808498 0.18644537534047345 1.1272017584876615 0.0091808219105866413 0.21690550417468726 -0.39990326125910319 0.078919422334706835 0.90971513417922678 1.2064041149590912 -0.89861712725924869 -0.16218236187750831 0.081249463711505057 0.29115218854676012 1.5001252118224415 0.24294846580464627 -0.83180642159106777 -0.13711285442705096 -0.71589211363529437 0.60784337026375135 1.0959188173026184 -0.063346412734640173 -2.0132348535409483 0.14136688103659245 0.11976195873698364 0.3479520244484734 2.3363228862876739 -0.25324825893300584 -2.4117258855206529 0.40401301460252242 0.52718033441188228 1.225961795561255 1.4803162169752264 -0.22538185007909511 -1.2561863349438933 0.41474351786265812;-0.053404314006268098 -0.2005758464741933 0.16893414820803612 -0.05160618216656479 -0.21535840525983116 -0.42439733340079566 0.29819347689798836 -0.27932045001509725 0.26077761587794301 -0.10777995201981146 -0.047574120078517038 -0.412016358422653 0.044797209653200276 0.19488777431019433 0.029019840546375318 -0.070290042802637134 0.033891729258479039 0.007016655696980032 0.069988627713589352 0.081978782152706584 0.17165056680439209 -0.5518431738520847 -0.031856291648087676 0.2489215652434256 0.20583264472500534 0.10969370687914985 0.29411751633062955 -0.049176295552746122 0.28173043043725282 0.20598780138613318 -0.0055899683128376107 0.43160875876530924 0.31583354616449799 0.010764703032368005 -0.3489255806254617 0.38346108908107707 -0.26563559884103644 0.52012761745228098 0.079138226084517482 -0.069968831747022397 0.038065161933555185 0.19163592758180473 -0.27958686700111485 0.48542248186621162 0.14857544491654304 -0.1411036610308907 -0.10854454248711802 0.17466232632577622 -0.056439751311048926 0.74485154694250688 -0.15533556260820125 0.34708784825085909 -0.0541620031526042 -0.26215767799312195 -0.2591098756111217 0.3801953218182218 0.22879070981505534 -0.25368826052579896 -0.33200701027689661 0.026803692781973434;-0.075990760475052835 -0.80497405019357382 0.040765290371980144 1.6396582804692832 -0.47174302531195034 -0.094627344877626279 0.20192369675250357 -0.28737299934213895 -0.060967451696146577 1.2658969652599894 -0.10487735782442158 0.44383808117864565 0.21033267285852897 0.053154852914256097 -0.12103186434162236 1.0655836122323481 0.22116259577149919 0.40984676610334536 -0.25463252498695804 -0.0014354876285813814 -0.3979061136752679 0.3802862883951223 0.15804717801895443 -0.10522866916018274 0.2973874301735826 0.096177711931415374 0.19786559652806451 0.14255102814145043 0.48950567596091282 -0.17741887074550283 0.010563577265471181 0.028746023039852006 0.16886274584032915 -0.54397852752916531 0.77264546690011848 -0.26010973988443459 0.26060025275059834 -0.22127614983167146 0.52006935030486889 -1.2635153233213037 0.29698828990021725 -0.079548744309324612 0.083083844563289641 -0.40769811832893038 0.57872118661979288 -1.7256643235511913 -0.061184955977499719 -0.1879640065475692 -0.26860016237784401 -0.92229387735342483 0.53862632359688378 -1.3968402007908338 -0.043524896595895667 0.31576939062027154 -0.32286813695041588 -1.3575900364557745 0.42891297863550176 -1.1351898619627225 0.34991187889139863 0.0072816112522494023;-0.094873385154207818 0.17124764517517846 0.12419065089188119 0.74203577589940617 0.056321188495255636 0.21330778834470376 -0.12899626443773024 0.66609768388955737 0.3136813525350553 0.59975947809652608 0.28356138333140074 0.33968080407345042 0.13510436243999469 0.58111280618666383 0.23684197661296225 0.22398943089697618 0.25562322940998233 0.21281735336365312 -0.23200035630227994 0.0056967981201917796 -0.16540171305144544 -0.0056098750050797095 0.17391535782358342 0.062082980109271976 -0.041609372477597509 -0.19703775651260269 -0.58690088656456874 -0.28075873978853921 -0.55591795201924743 0.24384651572323007 -0.18360445930819055 -0.67307167608597351 -1.0835850727702274 -0.20511276354220984 -0.28665930603157741 -0.59153230229643106 -0.30071931357385684 -1.0455875720245786 -0.99297155102215051 -0.88207905470136017 -0.37711666142858608 -0.6171648526140433 0.15372722592543903 -0.92423841150382546 -1.1925955070397531 -0.3114563816651692 -0.51509950973360674 -0.20498076950100869 -0.20989828789746248 -0.75945867664981581 -1.4367565290272704 -0.10293914510650586 -0.34188291409086946 0.14439202946755098 0.24901354990153612 -0.67902812777970267 -0.96116490670501553 0.16346649787162451 -0.55151730585846404 0.45645005046432047;0.21337652500438012 -0.095375380367860377 -0.32320441120570836 0.73294800540050209 0.12414159622580039 -0.6042502403964638 -0.25498958921863613 -0.2097313579809523 -0.33942206269317904 0.33203754523346923 0.042121336837028574 -0.41259578061471547 0.15169519926461733 -0.036881812384693083 -0.12774570167199573 0.76611548433045806 0.37699118288576677 -0.26982173606396631 -0.10890560620674389 0.82821950632813179 0.26790461436264262 0.7448168816718278 0.18932259500738161 0.10066607490142991 -0.15832191343245139 0.67577654409888432 0.59405362960120756 -0.063030979836222759 0.47260965061910354 0.68134883053101658 0.15744375602571906 0.55636141790441807 1.178915390653744 -0.67685432903035092 0.221373892445166 0.31359711251062478 0.020016968549068523 0.12571221109678582 1.749216506049823 -0.72298758055442447 0.0539385791936388 -0.090695168109109742 0.13674183770816795 0.073994471657819028 1.5802187184037715 -0.81920200435035784 -0.26735220109244134 -0.0071252520323703125 -0.12931982677020776 -0.20167688593605756 1.902116823093239 -0.40259449735672731 0.36780496552802822 0.037589246854935039 -0.035202021203264967 0.076008039438760194 1.7224745893290356 -0.92528379212124345 0.1013337528206236 -0.49525961845025746;0.02846820645004787 0.53146987231641907 -0.43057160118262905 -0.96378184119877219 -0.590911705217814 -0.45051043464190277 -0.086167267726504487 0.35970671504964397 -0.39396068935163564 -0.88554993446387964 -1.2032890017016851 -0.62406509031673318 -0.29364722171079993 -0.15533246562650263 -0.40410062046041778 -0.51147888442223843 -1.2516875350813705 -0.22202946849822741 0.14068336622185615 -0.36218801313395893 0.21654948608846422 -0.54724718793776239 -0.84177306773068972 -0.08214158942735432 0.18706941161644491 -0.3536125913342209 0.33140242953594268 -0.12695263087444203 0.055118351232638974 0.2323281206855245 -0.26442683106212811 -0.045838853647495209 0.17034225022622437 0.48808112658150016 0.26857985384648803 0.21686218500848625 -0.080875644965762702 0.095349176799908217 0.94028509600022558 0.82196566017362704 0.095545753481577317 -0.031272366621484825 0.11563221558084777 0.34040424781359735 0.38960327991125254 0.88734977951205074 0.62687070055538752 0.17214402621095548 -0.15608042093041821 1.0528903785414268 1.2108505423737794 1.6231058627161299 0.60822048922075156 -0.29101964093534144 -0.044076310920010513 1.6404115425048549 0.83240839316975845 1.1235692049329915 0.58911401284792198 0.3141012281509602;0.48097663004682462 -0.73098855124465223 -0.0062372080960297329 -1.7120844044880457 0.02735958770287077 0.43467142670727804 0.18574069645474867 -0.4152092211909908 0.2046542093956287 -1.5480129611588478 -0.29148074988051165 0.38829334710574009 0.046689987860413111 -0.4213003265676426 0.3479418313865969 -0.63851260131331011 -0.26643304865524287 0.97102412991557552 -0.0072743131392714547 0.19816460475018252 0.090215234923671089 -0.97532203298227216 0.36404859246451027 0.37038746941978323 -0.33600138270938495 0.10589731795945391 0.78026104144494224 -0.417110464821081 0.83271386284992144 -0.067165714509475921 -0.11917246044452082 -0.18120649701533087 0.41332022790566181 -0.28713830275080143 0.30887906626095846 -0.33260788253709311 -0.37868446593022703 -0.0578185953087475 0.69233993460104415 -0.13914966430339953 0.3772110749837172 -0.22344656854675968 0.26538751644066222 -0.41140136085000495 0.64311751073424628 0.29086065194074634 0.88543395543588432 0.020360644760516178 0.035275844992083534 -0.98562824671211502 0.59065717300497378 0.43519024699011161 0.80603097237809729 -0.40201702201877482 -0.36354513634905111 -0.93008415022054658 0.8717495378555089 0.38176749704336554 0.25180325004039339 -0.43789083615607655;0.087889404467613993 0.61128570834756157 0.077245579052444654 -0.039615401171908177 -0.13788598080494655 0.953182742653786 0.23040346989253047 0.3590717075091564 0.044738184446663783 0.27612807448809906 -0.0047925676394030524 1.1375717955106623 0.28324762272135695 0.53525104343708374 -0.25007727277058123 0.12584638881509164 0.16548694014542334 0.68241001273283097 -0.10336183467886478 0.22368949061151097 -0.0709255303008791 -0.28170326870405099 0.094556502997055342 0.45617137650019446 -0.035095788330415538 0.121435635625442 -0.086993570361116782 -0.65734805807331587 -0.14316578090240756 0.31167429593551543 -0.26778231327779511 -0.26341981816923482 0.32921331400580306 -0.23720204899265177 0.054988143724006948 0.10068138761162582 -0.46050099774936293 0.15368803681730908 0.25697307064253627 -0.16969919284787316 -0.18006604715979888 -0.45698550971336416 -0.047665217367500859 -0.36332844315721918 -0.072029320251761966 -0.21874369204503602 0.11554107390241701 -0.075060531285823032 0.22026726264607555 0.17255386313296345 0.47113099688159543 0.28305359790529744 -0.40666404031312475 0.025317272841861822 0.33248998863816603 -0.10414003019503161 0.41196055760781602 0.052265374473906147 -0.2842817327361522 -0.1893172698019687;0.05072584857057913 -0.18801971740233495 -0.067664621818822518 0.74676026677151697 -0.75516688209902816 0.28298440998630459 -0.047422886171383363 0.049816951049504732 -0.36076327497383442 0.62453848949813007 -0.97532013930440142 0.12606437642881468 -0.10138336434485062 0.39835761835300831 0.2817614890033856 0.16569674860939917 -0.93446145544322534 -0.039817585060851667 -0.073598595924086213 0.7173302471798052 -0.063610672590680012 -0.22856199392678722 -0.36014833607146535 0.004513554197392914 -0.38697033290434019 0.75199791710545605 0.17798867814387173 -0.33922906095629951 -0.18144731665324434 0.079189616309237987 -0.076855577111479251 0.17219703499281874 -0.065349982950963975 -0.22190993714031104 0.57252415320003747 -0.25817900789274428 0.12469679276278726 0.37801899022301577 0.30739215594983088 -0.61294782967692962 0.46325387876213175 -0.11549969384869153 0.10396968944888169 0.089042867933259259 -0.18370472989981379 -0.48678759740838651 1.0766442468434634 0.043236435393237002 0.1539952491212648 -0.061334569819838029 -0.60928261043128518 -0.31758787754315154 1.2385132148860962 0.025481261842257255 -0.41364295531434497 -0.35988124875991578 -0.25974046036583137 -0.036302670079719261 0.7134259091469537 -0.029737403284837476;-0.27106907094278482 0.29598185407057753 0.37610572639926781 -1.3176658536951413 0.29098844299326315 0.82200621100010773 -0.30581240644310159 -0.011290988642462963 0.3513992658224675 -1.2581954352291258 0.63102422592201746 0.83302485890436262 0.11019772026120923 0.32939726435303068 -0.16877627074395568 -0.89686130008460574 0.62239900659130398 0.48889662445933052 0.09301567079418821 0.00078945989232769454 -0.11446354518266902 -1.4141573158305916 0.44067098017773759 0.45361501342961802 0.19467459899203934 0.13443398127241465 -0.14682719625068583 -0.29898782236045063 0.4618960819030602 -0.30790892116899543 -0.32694440439936295 -0.10340075977449019 -0.26939624742101304 -0.37981902678226165 0.15958704465847898 -0.29179370115322356 -0.29850999445904924 0.23589789735337727 0.19344963046042538 -0.0078502816749306398 0.28291254255440651 0.01125904341769484 0.17254775565110914 0.28411972163069199 0.076918201884076692 0.034621217196289397 -0.27383408654595287 -0.12939227498500572 0.21396387428124192 0.16517284183522732 0.30853820065441684 0.36521900252583728 -1.1579213017544761 0.053830818850956301 0.30316759139749377 -0.1582383619844307 0.19439165228413691 0.39514918523206544 -0.58297540323538832 0.42521872029960361;0.20999331366169613 0.63549416025619265 0.17979787795432539 0.51678747571920303 -1.1598232187870159 0.14489555466549667 -0.11673027314489108 0.56583911935828402 0.23613783724951057 0.35434055868072611 -1.4615492630713707 0.98121989398879317 -0.26322081646787165 0.50953530225721189 0.17012950292709461 1.2131581702661616 -1.4216079798725938 0.55301370391544225 0.088389053924603 0.75858707452623009 0.52278443271322805 1.6752121084531084 -0.61751235239700186 0.79241446397014137 -0.37674519058828732 0.091204749043822267 0.38416811444926202 1.2532988807038969 -0.069935540933668869 0.15977601796309646 -0.16145746236799641 0.016841110138805987 -0.010838387492632783 0.74333466572930806 0.62119250507973955 -0.41450383497056531 0.082226652152479401 -0.8353002500375285 -0.53261063173430079 0.55680935807002752 1.1482003665856444 -0.54072878141351277 0.17503412639960897 -0.908061509262864 0.20561960123618636 -0.10182721897254231 1.1258636470319625 -0.61249091783479315 0.077096691656410782 -0.53477739024099835 -0.37305952607048659 -0.35176340778137127 0.73828761956522304 -0.68459533900665048 0.023289504571933593 -0.50860814298090495 0.01177896359118703 -0.36541508511589393 0.57439574186374054 -0.5461804915560341;0.63482365361433335 -1.0084549265417928 0.77688321164842777 0.1986442242136055 -0.4330069773119839 -0.33727592682417079 0.38218267548508689 -0.87081222231652167 0.48753590472025543 0.068816458475921174 -1.0438643093614601 0.25606193058216942 0.64491795723716194 -0.97353346557269382 0.29752042469327972 0.24732668800810531 -0.71347647018914273 0.0032323597762613926 0.33748450641553768 -0.56291955708413943 0.05110221561800013 0.47181085536433059 -0.58555455906589526 0.13263136199379089 0.075251772624974914 -0.19486630190665455 0.061822635581717959 -0.088508825762065341 0.17663687599532221 0.56850505796051476 0.075139422095564956 0.19444446256837561 -0.23816374628487241 0.31132494863971427 0.80148472463670906 0.11625665946329206 -0.25686594339261482 -0.11286454291304215 -0.14535413557702978 0.27275305629055724 0.66593779138584142 -0.12883106679567896 -0.42122936736635397 0.42255689480878844 0.49801627372981139 0.62149762189390856 0.7275772666325574 0.56941650245980568 -0.78653338811131723 0.27209132724627849 0.32502923774261727 -0.016118489702201713 0.2197053680914075 -0.27271563874609733 -0.44475640474035516 0.63824399142486643 0.77805222345872438 -0.34421862376140383 -0.25668007727523562 -0.22533887836763811;-0.24902872987500535 -0.45441144022748881 0.031724554410243806 -0.50269211487594279 -0.26278960950703756 -0.61876710645972077 -0.12360743532852746 -0.3296419671245619 -0.17780788273946022 -1.1428911933478738 -1.2534246928592832 -0.99120518044077333 -0.16786158050636635 -0.19527753377300217 -0.21507381904600351 -0.46505052291719257 -0.90475552331354969 -0.45255741360444274 0.11514176158345737 -0.19452092741402188 0.28077424056818145 -0.66999475461811109 0.15371864903561358 -0.37216020179634213 0.26411239363919148 -0.30916340779982621 -0.2472721903192687 -0.18185116023904518 0.70244314064340507 0.15604330394649998 0.11857667191364805 -0.60397091901704436 0.11591082666729974 -0.096838573901263811 0.0067957337972850383 0.024672573946718766 0.28371023772461501 -0.41108806555141841 -0.18166352983851999 0.28928561247942131 0.32195718986503447 0.5101468206262475 -0.11212255198891409 0.044613987336104569 -0.076930644329231537 1.0176772590172634 0.73290567079086855 0.37339660259683993 0.24861313401781249 0.47172716831538297 0.045382047258484347 0.69569389677145277 0.55260518886511012 0.19875570516143096 -0.46302924762692704 0.91403402740482453 -0.41286033953708584 0.57727597719350476 1.06840783366053 -0.14566962872817713;-0.073023896365866828 -0.068607015553033737 -0.32405023477840111 -1.9747100503569939 1.0568642743835803 0.35962282980780297 -0.044246661954434538 0.040031868455165084 -0.12883002292610521 -1.804245747259509 1.889594169903561 0.27170430696584497 0.049924060816430596 -0.31061482209112268 0.058826314698905702 -1.2372208184877715 1.2315517950081554 0.21957108479889104 -0.32065298705462464 0.63824108295020532 0.14695940385096634 -1.0226318510299577 0.49822264728517207 0.6551264136778846 0.35874533719086016 0.21129371837085936 0.3406972897614412 -0.38461511015947408 0.18949793119318176 0.61875943415935941 0.052263832970757311 0.32043515616231066 -0.41020592711876591 0.18183457153459281 -0.69254338955920136 -0.31784925000182895 0.48488220888417677 -0.00084677268735756928 -0.16677447357470637 0.97418725957413088 -0.79633695854774167 -0.51748984552591171 -0.18340855109126697 -0.3488482192195303 -0.30041292574800377 1.8260173960895885 -1.1370480000939656 -0.99993053828891865 -0.26335485997353464 -0.36302921199419114 0.18512066638008587 1.7043213989991925 -1.0533551041508755 -0.53697296411461382 -0.22088239970309845 -0.038878605864842132 -0.1784632716435281 0.94905974982571106 -0.38413855974969124 0.22623343075285116;-0.33576263566522541 0.080572445197690509 -0.21761659852801571 -0.12043818759676418 -0.25577028510078093 -0.50043716489775514 -0.115930237688273 0.2859693514685433 -0.20541795228535956 -0.056460421415048055 0.51454095224300977 -0.75331169347384963 -0.062205274340343342 -0.067184639877002031 -0.34507259236032428 -0.10881500712322643 -0.15689914008360017 -0.33945315630667411 0.10066806780043115 -0.20085294263241135 -0.43207951956330742 0.54470529268526158 -0.065909608065638503 -0.42444763424292642 0.057672619820959704 -0.36411052059605414 0.25381168016191474 0.12390652718764775 0.16441921797810782 -0.26739740275557045 -0.010978606081406562 -0.16001827646782535 0.14129689767683623 -0.29726346495931172 -0.026827462957304812 0.086351087013395139 -0.10155850929145349 -0.019656871826120102 -0.11023086233061716 -0.7080842947399959 -0.3296128706164283 -0.07635272358782505 0.076390366924114605 -0.21011168754560919 0.066642987723460542 -0.60574991225822805 -0.21154959156968403 0.21621499878954406 0.1471936489523519 -0.49679651395229929 -0.072879448893988091 -0.21008841291456121 -0.05193653690649868 0.28301649764091941 -0.43643353287050035 -0.50095238739367676 0.044126229088483432 -0.065970719112640866 -0.56807120825562163 -0.45442766753690195;0.49083295477565614 0.37764688369490612 -0.39395082880624538 -0.24925480897673785 -0.20653276320451805 0.51558684288050349 0.31081908591395246 0.47640221853803927 -0.2742201890516387 -0.12992860261969075 -0.62523926328978974 0.16962869893626292 -0.17045203152362934 -0.041279298564940309 0.30333365243279736 0.055977767356500487 -0.43939436661754916 0.14866434112882063 -0.094592975275353847 -0.21878550446354056 -0.11818851841713171 0.69796238303375802 -0.23298773610172369 -0.12790961535509079 -0.27315895161530646 0.011292448408606392 0.22265066621869326 0.50171843148813655 -0.25403884843129237 -0.14245531239370374 -0.30771402948433413 -0.03458056747410531 0.23980028400238587 -0.030425780495626262 -0.15553213181248762 -0.31015254213338328 0.40395028827115503 0.035243014700652456 0.21017102326332904 0.19474722742820702 0.20748358681974177 -0.58329259467505234 0.42980750337148277 0.007895917663294949 0.11934090853960017 0.87534869852306552 0.2044179746314323 -0.16727523034144537 -0.16186946897810375 -0.23744566070780149 -0.47861230514035835 0.39918802580541363 0.72851347605667027 -0.58298577149398878 -0.17184059604712523 0.17606790638641101 -0.299633491446334 0.29122234472023262 0.58441914588396338 -0.44200361921311743;-0.0845363992894895 0.68799479260010121 0.243281616994803 0.37017651593400874 -0.055981707695963244 -0.085150917168446943 -0.056976548625440791 0.30942738375002482 0.2948642783664055 -0.12483170450132273 0.070830987592957362 0.29606851088517516 0.24470209486730674 0.21070990843651419 0.23719683411106707 0.27680119704795003 -0.21671594556122997 -0.058590260667362115 -0.0074048367663561597 -0.026174658087215582 0.15851450473021314 0.73164844424887321 -0.18540125832353005 0.34361276602428709 -0.24916103343087181 -0.28176246795076015 0.26341561281070791 0.56316817926931817 0.080733749248693323 0.28102489428506544 -0.052735530512547799 -0.85822764893802173 0.22345646356480958 0.1406443670915011 -0.30904980938250676 -0.52926701115152042 -0.044849361090143376 -0.88609924229427572 -0.18918633643970181 0.29503329619053054 -0.054840618070128286 -0.49137739363977662 -0.43677351072565307 -0.67457487646913139 0.13777315948764979 0.17436936396110056 -0.27740533286803448 -0.17905013552639631 -0.20007385628001534 -0.63508553674935864 -0.22774832590643709 -0.094531631584846038 0.11691315084584404 -0.34854436287572776 -0.15898758740461502 -0.48299830932809318 -0.14172845533798425 -0.25442062828005041 -0.26289156387280943 -0.61934337561019348];

% Layer 2
b2 = [-0.15271553571877547;-0.56353796904620035;-0.40442042286583485;-0.097801104998771385;-0.0347904071303069;1.4765901887875319;1.5707524563461863;1.7654675828128215;-1.4303482906019829];
LW2_1 = [-0.099300510492518382 0.49886345890039829 0.45157679305327231 -2.4380513892952878 0.30138427656775468 0.3136349332400169 -0.71698726955249892 1.7122788064830397 -0.51655084417899455 0.563048823079772 -0.6275457232635302 -0.21545340246154099 -0.27505553131475902 -1.3484453316712495 -1.2829118461159414 0.02924364535249601 -1.2020651569366652 0.9507976996880898 -0.46270534886514025 0.43965428736058237;0.44353728280822075 2.4085047277294298 0.44925728928391817 -2.0475810102910845 -0.058242920223741279 -1.9252729279045599 -0.79269270290774996 -0.67228202279194005 1.8141651328740078 1.6615266349261351 0.59565905777250772 -1.0369380116451843 2.1167492710244473 -1.1153692518261518 -0.80717568655348604 1.9653945673051723 2.3918611377695758 -0.91229947875098893 -0.89084542716100679 0.02816980641099593;0.78826753568721386 0.98824665828649982 -0.057752429680877168 0.69076396404830154 0.66116374066716621 2.9084881741210742 0.5738056557955783 1.9123738568220412 -2.1312778293597265 -1.7587624498034946 0.066060262876323717 1.3240929180986682 -0.86561543985499745 0.63908966303472103 -1.2067136263610521 -0.65821910386244042 -3.0225701894518124 0.041577824475371582 -1.2516555823675977 0.10229014043504224;-0.34741296885378559 -0.26029964499644215 -1.7991360260418368 -2.9981172580541608 -0.058591597633955841 0.55900352584599011 -1.6512542651424511 0.67049280453588345 1.3055178098241493 0.77869743705213113 -0.45944084732998486 1.8723219535466227 -1.9184203771054422 2.6699592402575587 0.20389909381270355 2.1011830580382584 -0.95499444244578391 -0.51450938875138941 1.6443098143540917 -0.11822515768949336;0.9660068856088575 -1.7395695834438736 0.51217321599664001 2.8683870717420583 0.0052139484242089904 -0.089481503139699131 0.16985537889142149 1.0834925963591506 -1.8895649236165255 -0.72137814926839816 -0.59111637204173972 -1.1950557429416948 0.25044987691993426 -0.8031761795054948 -1.2474155314206916 -0.14708355457033565 2.9466301898416041 1.092454574234345 -0.34569428219596765 -0.084928687432636304;-1.8847569534710633 -1.4562145576828305 -2.1308482862242246 2.4290482442440791 0.38792298322884528 -1.3156635558725109 0.49542769864138403 -0.78648054205285267 1.9821792225309769 -2.6004368707864001 0.069162546096234873 -1.1091697869800157 -1.5019188793627263 0.33283209579826512 0.40125255117936526 0.62534920827929852 -0.46104154539349362 -0.2901804457958107 0.81030493426864503 0.73267738195567567;2.2690229497326269 -0.30402766785261465 1.792392398586381 -1.8279978423057248 -0.59853461362447924 0.43794516378930648 0.71183259603456039 1.26142319875158 -0.7019758387821825 0.97075199076015717 1.7900758377217236 0.62020982223481147 0.35088046290822394 2.1000916154778451 -0.95682621227681208 -1.5108124004167471 0.48977410598677806 -0.38299571274162791 1.4124875443200531 1.4097336126033826;-0.81865353633923488 -0.91251496690977496 0.64447779826522877 1.859656450177765 1.2554942172518255 0.7521278965801198 2.4657105899253553 -3.6543926267841536 0.34527357686318239 0.58325620882027196 0.64232772289763451 0.36849720288570459 -0.15300557970068476 -1.727447246165458 -1.3199234020399562 -0.34284708893008425 0.0014006087145781547 1.6086129415042223 0.73710455824765886 -1.9080212424498857;0.03804077459122393 2.9086032421703707 0.4821019186712287 2.3030614657451003 -0.099273094000984469 1.9213014384345757 -0.44764710669406527 1.217975492024062 1.9082525513311084 1.1025325043794765 0.73008277702032676 -0.28602232002126482 0.44694339447639492 -0.40543750181611399 1.8132284781919432 0.38323333088017697 0.80922467777519624 0.085876295235252281 -0.75445128951372786 -0.044538896625598928];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
