function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 10-Oct-2016 15:26:18.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.3125;-84.8125;-176.3125;-6.73;-7.32;-9.46;0.75;-84.3125;-171.0625;-11.02;-12.43;-12.01;0;-84.1875;-144.625;-25.58;-20;-35.66;0.6875;-86.75;-175.9375;-9.77;-21.72;-42.33;0.0625;-87.625;-176.875;-16.06;-23.64;-44.65;0.8125;-87.375;-177.5625;-14.61;-25.72;-42.46;0;-87.8125;-170.875;-11.72;-28.91;-43.54;0.125;-86.125;-177;-13.09;-19.96;-35.77;0.5625;-87.8125;-165.8125;-10.51;-17.61;-25.88;0.1875;-87.0625;-178.1875;-5.17;-8.34;-7.99];
x1_step1.gain = [0.00556328233657858;0.0129764801297648;0.00564473452107956;0.129198966408269;0.128452151573539;0.0681895669962496;0.00557103064066852;0.0128102481985588;0.00571734857959621;0.0509035377958768;0.0630914826498423;0.0462962962962963;0.00556038227628149;0.0127186009538951;0.00618357487922705;0.0336530371866061;0.0537923614846692;0.0303536196691455;0.00557200069650009;0.0125293657008614;0.00563876651982379;0.0577533930118395;0.0484613520717228;0.0276204944068499;0.00555941626129256;0.0125097732603597;0.00562587904360056;0.042256496936404;0.0489476260401371;0.0259437021662991;0.00557491289198606;0.0125638005496663;0.00561699139898192;0.0351802990325418;0.0439463854098;0.027311211252219;0.00557394182198223;0.0125539427226363;0.00571020699500357;0.0367849917233769;0.0355808574986657;0.0270160745643658;0.00559342772242615;0.0126532226176354;0.00562884784520668;0.0382409177820268;0.0459453250631748;0.0299625468164794;0.00556909154194222;0.0125146656237779;0.00580446218030111;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00557200069650009;0.0125934671389217;0.00561502017897877;0.0446229361892012;0.0906207521522429;0.0518806744487678];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.2219436327152957;-1.0751237696695479;0.30207870664246472;1.2708349704234732;-0.94003600886510164;-1.9812138290582906;-1.3337134213766511;0.71563581959540856;-0.44170107719150192;-0.8489061519820349;1.2809597439691762;-0.77922275189610068;0.17072002613242629;0.90634861698343538;-0.72824621509427012;1.2049135389285159;1.1725288308930359;0.72143386690853917;0.97684253164833423;1.9809998141805414];
IW1_1 = [-0.14087647378595489 -0.43229733728319653 0.63804362950724558 2.0330178046556298 -0.32513205291457148 -0.45053750262795633 0.12012854019769952 -0.82411345262238367 0.026938975722799133 2.3713217630165957 -0.027621237343616788 0.065858344657921675 0.23721098206542354 -0.57201366260579967 -0.22057130502359892 1.5644944760393316 0.3834676235951564 0.5347586408090147 -0.18490132196363962 0.40154609708603972 0.10643799003397136 1.852669085904785 0.90594230596899361 0.25416568741332496 -0.26533183524171267 0.30713449219692252 0.27959684951959768 1.0784244514289494 -0.05391265509219674 0.14643851261652263 -0.031299679625030233 0.5101025143779766 -0.13758427706480125 1.0513444465592352 0.04427961005083824 0.41917004306676287 0.67153409837016897 0.45855755671629111 0.29838052103155283 0.75422563904036199 0.014117931452431376 -0.1803968057896507 -0.29860127801852915 0.40152650260428163 -0.18455750747219909 0.15284217661322577 -1.1250068485407483 -0.32427192651362396 0.17659550208964139 -0.033881418021564615 -0.38427287474199301 -0.398441801283548 -0.68578888895672563 0.015244884596914691 -0.34494162354479407 0.31579388305974498 -0.14801266072791777 -0.20628877447732394 0.35637963617317991 0.52874516333899402;0.064060575831793226 0.092170123727599446 -0.22397560349705159 0.80495426292091499 -0.32625824824319949 -0.089789373537201636 -0.095043128043388617 0.56781119811455738 -0.054971332306638421 1.0455527074359721 -1.106966052296346 0.67619210559178733 -0.094945212478843355 0.53477255973266002 -0.17116485842083118 0.18596429414655952 -1.0863017613477344 0.45048898100857843 -0.011515219462666235 0.045604982650402803 -0.5620197912705408 0.070940332951526394 -0.61266391697491029 0.024320807903784793 -0.023663278671670576 0.27285256446238226 -0.3771774139553325 0.034998492854265303 -0.56971302863184303 -0.07181363729128297 0.11045566539854096 -0.12736152117533936 -0.27211169840899341 -0.21916677733411233 0.46674255724718283 -0.42554240552653128 -0.22701401971282056 0.20138779869787929 -0.35205354786264265 -0.82227178478966567 0.48794758699305119 -0.20876662814634672 0.018373354322295046 -0.15934975158665893 -0.74098576140077821 -0.89926694288953468 0.013472247759250397 0.076219661426953134 0.039232283710552665 -0.074404354631924796 -0.81661772620829698 -0.88637809165361703 0.30935600495359067 -0.11239002900455386 0.22530614722717662 0.34236742685563948 -0.80799532378327243 -0.49951907322270428 0.27870120745236526 0.11319050492444126;0.50067522951955923 -1.2996827301322991 1.2615104295025903 0.9299947687850767 -0.71785661225649378 0.13260666220313316 0.51610994831760459 -1.3043865389889528 0.9211018644041481 0.92761284813201639 -1.3683148475915996 0.37219008003112064 0.27991901813752351 -0.68622110623728239 0.77039600789041152 0.30565839365417907 -1.3688534690947081 0.73999792643330564 -0.10311859414141648 -0.24366753438719224 0.70103763327641733 -0.29718481209713721 0.22712200246114003 0.68264389556038751 -0.3586312892560754 0.74579964146354383 -0.15338103738181191 -0.95929309722300293 0.53251277175441958 -0.17131237632345817 -0.17956205453341137 0.32240699541061346 0.81158455766648674 -0.77609559932242822 1.7541247315736566 -0.32945305343956999 -0.37349444966438594 -0.090900007422502746 0.162495034262813 -0.73710479134269424 0.52233625278850337 -0.18928542866401354 -0.34157191653438129 -0.10068783009637426 0.55557060454796314 -0.27372185913210634 1.5973698730953958 0.026401983504985908 0.22110499589315638 -0.21938146539899983 0.2474473860998625 0.36568404147482941 1.512922924549398 0.33192699905430995 -0.25824019230775291 -0.91299742247864812 -0.13190755332749557 0.10665588360382112 1.1094317666885005 0.55259741757847625;0.23608371326088864 -0.098505687993504912 0.80494036236437516 1.1186191485990338 -0.044724363048768971 -0.18523287341454719 0.4915554686202403 0.066567513599403119 0.18558529753634598 1.2474249596868052 -0.12017896732896752 0.16532135949700821 0.81220246858054668 0.51968390986409108 -0.28004641536064356 0.37787902484695163 -0.73127288172070681 -0.03673315375569694 0.14788062804495219 0.11547387492994853 0.061069343345388744 -0.52285994214409348 -0.86145417259220092 0.4073944656210543 0.0062568299737769829 -0.29158540970794894 -0.79219655753574292 -0.51718012225066678 -0.36447770296529991 0.22220048345905527 -0.15075186399073762 -0.1066885982506578 -1.2566164447453687 -0.24322888786532504 -0.21125693202497892 0.29136741461324017 -0.47023866350314614 -0.16382727480618506 -1.5492755835279048 -0.78779602022531914 0.17197859532127999 -0.17321580635965006 -0.1639481461207388 -0.11666658619164628 -1.555880499528512 -0.75358651736956783 0.16643348037134159 -0.1260039006033859 -0.71286759332152649 -0.24056881791290508 -1.5198455381108096 -0.57764957927390526 0.034014679519873948 0.027752929656877097 -0.27786459659555834 0.082195263104735197 -1.1910585572877279 -0.039432115976784976 -0.13149094812436424 0.28863687796521692;-0.45586578567121117 0.37039518170382274 -0.13191561856808795 0.19926590399165203 0.30147243060967976 -1.0914725549875215 -0.7185896486153901 0.42159838187875176 0.22005785615521159 0.58986905055992545 1.4100822438310709 -1.4844847306154625 0.081379046189724302 -0.078579124835184477 0.70753741584913432 0.075612420470626968 1.1964899305680832 -1.1897615076190864 0.96188209181351458 -0.2363611250939571 -0.13765370638480051 0.027128632121073321 0.50880098872207069 -0.52501401457777752 0.42058849485726196 -0.8201360526720004 -0.0014212539719646346 0.22695117136162121 0.55600243052346299 -0.066056885798635709 -0.40233638729475801 -0.13575514516885598 0.62170200365127215 0.52847462977675153 -0.77092516144755585 0.3132469410298882 -0.32764904505573711 0.030163875485187518 0.33444675826007053 -0.33635791278185362 -0.77700564876446121 1.2320982878862812 -0.20082721719172419 0.90448550542217376 0.53202864479587419 0.17660205504085777 -1.0538165922873532 0.94450469793911462 -0.018469620124466159 1.2041185839956581 0.67224444219419155 -0.063807280753717638 -1.1872665112595209 0.81813769362564781 0.26106218887062971 0.76985525560419554 0.45176641342419616 -0.56770756484811158 -0.77403768834176434 0.41969641482704001;-0.27262467983760386 -0.017698458567495863 0.49638553609817315 0.19860975943299231 0.1204994223750166 0.67267978736389378 -0.39608454969515844 0.56155175512469813 -0.21410144144710105 0.8030903949628635 0.3632364624005458 0.48590268751475846 0.17268343511545337 0.39285576242352727 -0.17908184108761133 -0.41898782833395853 0.21855072719199389 0.81393877255120772 0.056731177730990567 0.33585804241951811 -0.31557577361378875 -0.75901025342104844 0.41970917412865349 0.67256255657046482 0.052823626326262314 0.29708977691993965 -0.52859778734031893 -0.42615178997168995 0.38261236106426366 0.014840621431617261 0.31561652801664264 -0.024740988808546218 -0.57703433032936757 -0.45552656326308977 0.40047279166512684 -0.23406154044554084 0.18023057452001623 0.24609542745719556 -0.6730235391288466 -0.56030560554146414 -0.12032600147156373 0.062892161479354378 0.015589180665154285 0.084614755127230865 -0.33779460712892417 -1.3365470833155608 -0.23579518920801174 -0.27459963809325361 -0.0096702667583788947 -0.014656054629351734 -0.55248561042869859 -1.2255120526955241 -0.17892779743469753 0.51645229801835302 0.29183649116201621 -0.32783461382249729 -0.36001602866303056 -0.26117655563271314 -0.54365828460200871 0.050942696793324006;0.24009813865193513 -0.83133080906383627 1.4791651887718242 -0.96281767826194997 0.023191121846259551 -0.32971327875972556 0.39900609373673923 -1.0002132212629449 1.3300665367413214 -1.3211761873029855 -0.67216774169503313 -0.70490085086928755 -0.2341019690433562 -0.21297254852604575 0.74658404757676544 -1.2479276883325598 -1.0361826501663016 -0.398342895429455 -0.14118491014224996 -0.4130635676975401 0.28899627129325955 -1.890937951277164 -0.35531938540025648 -0.2521633553390793 -0.13919458952493441 0.26703509755087612 0.12501593723174062 -0.25375523071687123 0.7443168471922802 -0.13096662562029709 0.057922448590780863 0.29293891912536407 -0.75689434821669066 -0.66683582860485269 0.88309734496231274 0.2378392485956228 -0.0045505672290946505 0.43870038553632407 -0.78524484893100566 -0.12742230643379884 0.83272206442128172 1.0264158114576296 0.098583735128092972 1.0289743687619681 -0.84829599987239213 -0.25149445237069706 1.4258728936279097 0.68254254991689511 -0.023346000072572558 0.66956106718662523 -0.91068279765093485 0.4607570946684309 1.1772840580847894 0.72814780240089383 -0.20412653649884574 0.25428117274026601 -0.78974202045986153 0.36920677880594066 0.09946689095045988 0.13083700382328942;0.011318530020422893 0.051689794408303485 -0.97418973695061939 0.37583509336792609 -0.231035088534844 -0.19195887018660121 -0.049065897099610664 0.20649333407343762 -1.4966473041855597 0.3940041271868176 -0.6020855350694021 0.17072134499964725 0.1435326059197278 0.37891781744944275 -0.84714022572617975 0.21288343739713431 -0.2387816701974482 -0.02233210129190048 -0.019604907118493366 0.6481690370106854 -0.51588203616427442 0.056660864495832818 0.015124573477346184 0.23035594601661083 -0.14011459138893478 0.38300754810644544 0.32471449728450302 -0.13096273649725737 0.32613173953836294 0.32371446509795326 0.078904266628254199 0.31371915434084613 1.1209152588446933 -0.42807404370381474 0.032012864367063874 -0.12400925391594662 0.032606944225643489 -0.067518380528436547 1.3198714181009528 -0.24422858195203431 0.43669055832764508 -0.032252908611446841 0.051545349296113221 0.24498210580934687 1.8440105192861744 -0.13883085829164052 0.013738927985540021 0.30335104386368794 0.03687650671042314 0.21719723883946643 1.9787765755539575 -0.72525404331195087 0.38252079229955394 0.064843894957861511 -0.014951596548754297 -0.36353952537080403 1.6666326889724083 -0.53903053390609956 0.25849363526994407 -0.31373690185166342;0.12359280360881408 0.51561450921359209 0.86049687258915131 1.501787463408772 0.32435058245438059 0.38726692806612584 0.1952444265680495 0.97712444560525713 0.84857725899528247 2.0662987235899775 0.3265451565116067 1.3186309830180059 -0.16833854788324737 0.79843638802609207 0.81090322989680008 1.0956329279916002 0.079074042211343371 0.60505142063114903 -0.29606467805460107 0.98546127154506502 0.27816451728787478 1.3564339978244695 0.73996071860591994 -0.070067491809875967 -0.42102403391495263 0.79756854708942437 -0.26870312606675972 0.20564456913402854 -0.20499702645849482 -0.50949688867969289 -0.17109506894420762 1.1208766515622401 -0.33604261291705484 -0.31883736977614741 -0.10257844211128951 -0.53509103422777649 0.11839384662441241 0.44972699824302498 -0.39277642673386065 -0.80002670345600924 0.84901334374661519 -0.34466891526505505 0.26833486651701105 -0.38010503271933171 -0.33573405475934742 -1.7566393264837801 -0.39349509638393299 -0.22378526866098808 0.18203007954394113 -0.83965211670771234 -0.62321328673784726 -2.0521495052690919 -0.55446292855738966 0.1120181651548648 0.24832214424524349 -2.1617326545965034 -0.8984336120872527 -0.97831790472654279 -0.35890959206343243 -0.099830905526286234;-0.035449945016555955 -1.1472368337680778 0.8834769257000662 -0.64833291129002091 0.4090438052688789 1.1327186522966244 0.085675881664636924 -0.98575351558400925 0.81101481924861962 -0.18195060898094925 1.2535591676962266 1.0894461304665937 0.0046476620917049998 -0.78449146032728445 0.5524655933731446 -0.85637433763235182 1.0091095406021862 1.6680318271053713 -0.17010559541789236 -0.23264567137374972 0.81779764159648349 -1.6839123762448531 0.86970237124140171 1.0674873314124214 -0.15525451926347539 0.24030273758323051 -0.19637028611052604 -0.67484364554623466 0.6668493421740419 0.3240899797658619 -0.33987300322323361 0.19618475210092409 0.56661069504575345 -0.3983080759724002 -0.059886479223608735 0.055528304617945931 0.40717651395202936 -0.61550712452970879 -0.32534941000130968 -0.69931773228213479 -0.27659916802889456 -0.55217537042574871 -0.284000924827915 -1.258573036952171 -0.19406162571499569 -0.876859155085431 -0.39638846932568844 -0.58834530228928372 0.13210651788821814 -1.0761480495827593 -0.006895260627468534 -0.17432162760203546 -0.84935362211784127 -0.2316717566363008 0.1695709168507093 -1.3244762716279153 -0.17946357692735582 -0.13439458330348489 -0.60805998386204207 0.63749985239776641;0.31600554891669158 -0.27732320065764787 0.84355659386616988 -1.8007509317966215 0.031757816639842409 -0.58686364801578095 -0.32579710145163454 0.18748235976068786 -0.016936388508993726 -2.6381096715430359 -2.1000308535372856 0.61498051375087803 -0.71842892772603539 0.11902944519073536 0.029206569746337004 -1.0569841270979923 -1.005443152836051 1.5423077835639873 0.17987811456200961 0.32717274357551768 -0.27466169915002436 -0.82557500943198392 -0.85738624669028307 0.81908494504053375 -0.019645542757621967 0.085134060331832073 0.032684178495248337 -0.1517996958276179 0.10955461059443315 0.81996122116479553 -0.33487833114249066 -0.10983692843297863 0.078698187178742343 -0.017811943597052706 0.42564155897411493 -0.10115967920028252 -0.29381351653220239 -0.093402590159226043 -0.085336438505651299 1.0007884899323529 0.87333930762691292 -0.45024614243856981 0.29805226281818015 0.073386253248602859 -0.51899686589302485 2.1776913014226293 1.5683987518548037 -0.23878007205208243 0.29969543818034561 0.86880549602651824 -0.32669489459400941 2.642898812841282 0.66511520124607737 -0.61969100209842842 0.17723767419178593 1.1482963990604276 -0.26528980812231351 1.4861209141601037 0.55863720473256617 -0.85177334929828985;-0.015342043699005593 -0.47237079753862643 0.70946731294433463 0.97490531827667926 -0.32984969998510005 0.65508490002516662 -0.27974556555766023 0.080250101036035054 -0.13157707782254027 0.95065087717468355 0.38624562951133679 0.18741165335170254 -0.40751675733201204 -0.020916694574253099 0.27430962789081659 0.3709345584293407 -0.083177366421725962 0.41204441601414732 0.20508742555179596 0.10995899239971814 0.075631281562187722 0.10009763936413039 -0.63052551449425653 0.8512400711140824 0.036356440101621069 -0.29046122679483316 -0.27376922401583781 -0.40382408867366176 0.083890148975680312 0.63563601321177765 0.24078644465693455 -0.36177329781315243 -0.042020256042530568 0.3075912186952301 0.090626877981287393 0.28015432549029434 -0.2377339237551854 -0.56600168144252749 0.37722798729616847 -0.14809033239833522 -0.066255116009938025 -0.23986639470038293 -0.470808046888192 -1.0875195405185734 -0.15293571833516451 -0.60956627143766062 -0.076992796583979575 -0.36648992610909414 -0.27749900269104721 -1.1404828532499867 0.42045944127650153 -0.68040442436144644 -0.085402596628521454 0.040414314082598587 -0.13241538920226842 -1.23219860381241 0.34802240383961125 0.25286527194383912 -0.36138983890450371 0.71758889226838585;0.42610011806568093 -0.30930634131873014 -0.3409547931805319 2.1619934445838269 -0.86281674334418323 -0.93812605430784957 0.31962849426210105 0.089904799575289601 -0.22389291265692951 2.126334372401931 -3.2851275477195312 -0.49573285927230887 -0.070995245562404788 -0.38467720747316325 -0.44910891291539434 0.85953493978860651 -2.1777854822358522 -0.4888214177009445 -0.018819372014844155 -0.44652387831450469 0.12788929373719213 1.2246188522941286 -1.3716866232344314 -0.11367756495020127 -0.62763898257080974 -0.59142245326572251 0.81603895828048356 0.69107980631648358 -1.0931949444634708 -0.22224456015637603 -0.14744945514125676 -0.37232529393248759 0.64486887086535882 0.46810268618562229 0.62512236793902598 0.16507345446290314 0.12460275678220317 0.11401220154027904 0.61960409122400173 0.16050678068687307 0.61437364404237027 0.20981810829539616 -0.32338561204999194 0.50042370886234566 0.034969445491638086 -0.8299561699814566 1.1086106571241667 0.10776824632873704 0.22846186235347687 0.45468177489477096 0.26961358905387783 -0.84389571563005927 1.1553332324802885 -0.048230128099211067 -0.058062000705889356 0.76280267866188145 0.3662945725813368 -0.65650994407525343 1.177457366070632 -0.36811196344430835;0.032343003756789314 0.82190923368375612 0.94743535958014946 -1.0095269337891355 0.14476760917338255 0.80134831380774563 0.025725734280431903 0.50698341569077587 1.1489318057867157 -0.68692204190490991 1.4337490839608296 0.67183734846245491 0.23613053343601068 0.41886590485443354 0.54820585547223089 0.2954480717214325 0.97109688497796021 0.75101593684475243 -0.29239046579204497 -0.046851362326557962 0.7608175558077136 0.44906351556340057 0.56970562306945582 0.31631070735244726 0.0093101073802951372 0.10209605131584464 -0.53340276993149249 0.20044537469960563 -0.13887769873773362 -0.069797937399546872 -0.05218394685841167 0.090392618987544693 -1.294674788565731 0.2845678092305447 -0.33641681990995659 -0.47411668851692512 0.078456883562406335 -0.43376092514826653 -0.47237084939874002 0.61330140143603795 -0.17750364881346137 -0.45068496522593426 0.045945881981654273 -0.73692559989244533 -0.36221993752245674 0.87902029867000009 -0.92832229762992258 -0.4776322249560952 0.17787255881550487 -0.62638411060719468 -0.29333068599768286 0.4759851257533112 -0.7555193681196859 -0.43021669830135634 -0.026855001560892273 -0.39379293244648422 -0.39879581612277493 0.088596972132992058 -0.62428004851402463 -0.35991339204000555;-0.028863580583421391 -0.033049930251977958 0.057907065886219043 0.1232275237015471 0.064177479038738855 1.387821865936848 -0.34754889070301909 0.1652522617826436 -0.29807282367236954 0.53758091818843945 1.1867363629252456 1.1936108283343732 0.72524192409980504 0.50130386655896064 -0.022995549295757423 0.26523546150624583 0.76494137914562932 0.90897968269283203 0.36188465925504465 0.36233360868226727 -0.017031940805950576 -0.30429063127455303 0.024973158957258192 0.74143222096502781 -0.20114945379251276 0.32464632078611394 0.25647621475551913 -0.14216384936544563 -0.12584868991506057 -0.10464079442039737 -0.1976694971468384 0.22501287405757803 0.49007375626966554 -0.2542755936029456 0.12543921487782067 -0.75981295055122999 -0.11731218381769748 0.05323218496735458 0.36462939499835439 -0.5080213599899529 0.051695521872300976 -0.42075355126365138 -0.0043325412961052051 -0.18158180727195822 0.36610732077225294 -0.16605385639071166 -0.21968773293196978 -0.4584132153577673 -0.080784876097870911 -0.4508571273063402 0.027750202149217116 -0.76534073526033908 -0.3692127912400604 -0.19168502171181556 0.06375617031213654 -0.33232314910086846 0.41839244495360861 -0.70269193539292329 -0.86550668644510287 -0.35441626974147372;0.043056238490446826 0.3316289490878977 -0.64364444613567195 -0.4891565137853357 -0.13931059220197411 0.059255771131450828 -0.49997864432304456 0.57608291500891895 -0.45410305710705173 -0.1056936199487036 -0.20993361326439341 0.57733097296757507 -0.090287129686361906 0.032466430331131772 -0.47374848585418833 0.092786378787534721 -0.15420784013611635 -0.11067789458668242 -0.6847230310439969 0.15128880966709835 -0.3019603633088388 -0.37560023687814864 -0.00045933966007745208 0.11903243145893759 -0.24913290499899107 -0.19144459997975868 0.44068872059848929 0.14082172768966869 0.15456379806926762 0.097444614342024144 -0.20322704645805964 -0.3160778588627024 0.69381265309503504 0.097782548623299062 0.0023280136377779523 0.18909453988924138 -0.0062457294373554446 0.10252007076438857 0.693395399989582 0.21900169362386515 0.41575093409333325 0.20365912440523878 0.24993422420295755 -0.30680395603737559 0.9775033939043275 -0.25051720048649301 0.34894180383128304 -0.077265364075362553 0.67540906763944319 -0.25419039013005779 0.68801860617796629 -0.10769165508297021 -0.33368517199598341 -0.008664751489854251 0.69590443808880975 -0.16575764372857185 1.018462022547344 -0.18468813919387439 -0.33275323761312231 0.19799870225370103;0.18006171338019358 0.67270238784756142 -0.30065230903615697 0.14007247978001525 0.14682985292409451 -0.11520482093225436 -0.18864366487082784 0.50009083941216537 0.018587623885003762 -0.0064054273145498905 -0.31972597533589125 0.023811088465262156 0.48634445429650569 -0.015861525657775398 -0.27946656703389117 0.18017921243955182 -0.16092789338201388 0.22150515566577919 -0.013913121824158645 -0.072666709285153161 0.38866895168621451 0.3476693111306462 0.16813812070938852 0.19414286271591646 -0.15899120033972086 -0.17715225290835615 -0.0851383786546899 0.25761281831775662 0.094324770871111907 -0.066818789168666792 -0.26638298141040134 -0.013135271960974292 0.05454318047331249 -0.14263024606555538 0.073727753232748522 0.14436059449131239 -0.032086537030388315 0.29007168940322314 0.023055840444623894 -0.22386933267756168 -0.1290612888390423 -0.23470929665695719 0.02655294951748146 -0.075360828051444145 -0.19423996121413903 0.084995616542906036 0.15404662960207854 -0.18841785347965961 -0.012570584359938632 0.12010232182621215 0.24172870936756854 -0.3144564145765279 -0.35428212531051284 -0.25038035331096065 0.11370658931122966 0.17025617425776426 0.079589688974576869 -0.16532865107420572 0.16860011644742795 0.09671161534766666;-0.31309228052520788 0.27685889575936651 1.2229328401561794 1.0872826783326084 0.0067171851226734492 -0.67432939818544535 -0.11799384652279656 0.31887360435836987 1.1040698504524673 1.2724412502687061 0.75149160056039777 -0.49581674067506176 -0.33887607030851519 -0.0089843790698847514 1.3067589022075488 0.47052615115081231 1.0171838726685201 -1.5305559582063821 0.20682715309630798 -0.37976645085726718 0.44121931579610751 0.9160975827144171 0.67622904609424017 -0.91748845645846155 0.20516122083391519 -0.46575276689070866 -0.70217706522244849 0.33996765718466332 0.026137231157608406 -0.21194668971010905 0.53230762496257056 -0.077067289496536934 -0.94198404361106214 -0.14109777121089173 -0.25323328909504811 0.3184672085915915 -0.23691535550256224 -0.28377841947410681 -0.89650143781577696 -0.54605067327343471 -0.31480882938660809 0.83169389077533984 -0.25060938129976823 0.026324288014185487 -0.48990342940955517 -0.30953589654837865 -1.4968863661351446 0.44471136790062965 -0.021342782862313794 -0.02123612304605059 -0.72007013816277565 -0.44200514782533978 -1.0489109159729553 0.17158338276065252 0.20616997415758015 0.031507282206582062 -0.78975404985404152 0.12129912890148853 -0.39890745702393132 0.51829162135067108;-0.0010050666123428051 -0.67147602073527624 -0.72042833930727701 0.82947088921058287 0.40439711077953228 -0.81530910534151424 -0.1038059398164721 -0.25657278111246351 -0.42702139739722467 0.57912421206263198 0.095916715944087502 -1.4379666928235708 -0.081858283359448225 -0.335643522216585 -0.288847816267987 0.049831070311172322 -0.28503374951067045 -0.24886600779885582 0.3312640151528119 0.15983704622098241 -0.24267782075732106 0.10433744798612379 -0.49387558367612372 0.30825653126523683 -0.051287622432020188 0.0092057643388311818 -0.19731003898025837 0.33129599898085993 -0.0053836975957947501 0.68197848127179139 0.47937049641173141 0.41905895241048285 0.21978847232123946 0.27303932061272951 0.07380272438304325 -0.025776032640978816 0.062605954716225307 0.45754873500805548 -0.30302690806060795 0.086317815440107651 0.03647017296664444 0.30683273485502371 -0.0073020954270251797 0.76604842555568864 0.008462440084281481 0.15323586214918652 0.079950595712006203 -0.092356947846432433 0.32367340342199791 0.33091106512083707 -0.38170847497900479 -0.068226323663781591 0.12985493440910842 0.052365768226270988 0.033167537008312591 0.50576246536586889 -0.17571126326226105 -0.25726579365844982 0.22038060520095684 0.53322411290095062;0.16232394587654631 -0.42470733104572755 0.80503153230979851 -0.74586719555481573 -0.18690792160774822 0.25655774511961799 -0.07769786381008241 -0.74736762864357031 0.063981586806419438 -0.81109187191341747 0.31056074584817506 0.13391535609704855 0.6784571835486759 -0.45384524986320512 -0.058112774296024225 -0.39975311833519928 0.52331053505168956 -0.86091554611367271 -0.058478547134500077 -0.65699714460935665 0.03598167531218166 -0.21362752851928896 -0.14401397637170341 -0.031620091623060703 0.095330476886001922 -0.74924802151237602 0.15626296242808158 0.5530763782870366 0.13011229427015705 0.39134423048206746 -0.68902093411687115 -0.039441925959265912 -0.39320966864376106 0.86225253268821622 -0.55579912549535437 0.38357358424147014 -0.053841696142030625 0.25914767994213406 -0.037577733938676985 0.82680037864966349 -0.82542870188106954 0.33270091647528638 0.041514071597105698 0.66303691479260507 -0.092097030792676809 1.31174792741121 -1.0202016778351979 0.47969712143917276 -0.2374558643262149 0.92593511560164055 0.56298073799688886 1.4415932542531433 -0.71867281168261876 0.38760440058089402 0.37437182824470461 1.7826831533870386 -0.35858145228365917 0.73213168847288923 -0.28662298165975381 0.38013239375815666];

% Layer 2
b2 = [-0.27386089022271359;-1.2609437197690765;-1.818353463496035;0.15745261547770137;0.33254756791037493;0.31442641701278834;0.25182598203514112;1.3739282249040967;1.374083161195258];
LW2_1 = [-1.6760384180471088 0.2312599874829781 0.16595508603400466 1.1428530068898062 -0.39912700940990625 -0.14658544643013016 2.5727932817262573 1.724051376612326 0.70532336784087279 -0.14813134306425779 -1.2265055506725864 1.2479598120330793 -0.22566745917494377 -1.0790296049905361 -0.0040588674557969218 0.22303118118219711 -0.21701540447263171 0.32569217434804104 -0.2620658356019821 -0.90032643116028699;-2.3272475414005305 -0.8387557294873107 -0.21230638633078228 -0.16287582876826867 0.24310502961455074 0.33864579999708005 2.2439790396072232 0.67869055612794449 -3.0453252780085318 1.8929539806510123 3.4659619496307452 -0.93208127477910863 -2.7686450871689789 -0.68412624457914906 -0.43947123055604853 0.84679148001203874 -0.80324068429167939 -1.0667032649844088 -1.9356123693176812 1.2644987969695574;1.5557473598425779 1.5426218688495497 0.71529363291342996 1.568324995664617 1.0194649557385345 1.7794590226179094 -0.64315599348453845 0.96734013444595157 2.5609687098880882 -0.15558224303751489 -4.259101085066189 1.1702591953357848 2.4331024598581323 -2.3638852842719329 0.55149140620167281 -1.0283229231718682 -0.38993872670824331 1.2155220362114505 0.10688843495460386 -1.3466464672276421;1.1723759032294057 0.8934565179602485 2.4455962162922216 -0.11364041173952921 -2.5496676026999419 -1.3219132869636969 0.66967616014463627 1.2543863526348265 0.30172852075670042 -1.9580574135203004 2.6115171761899232 -0.63087571010681531 3.6426011293907057 -0.96420210126542094 -1.445157434097406 -0.55996634229459896 -0.5299508046292466 -0.49259914866384796 0.5296624945678241 -0.802462126792714;2.0208303485399077 -1.5852529239661597 -1.3088211859856744 0.30580335681882159 1.2051351616444643 -0.54903667082290797 -1.0470684308360003 1.6297293829549917 1.4105686326560853 1.069334321619263 -1.8478610126985742 -1.2730987474210298 -2.9755924048193361 0.98752708748484852 1.0098039149634579 -0.24142228642735028 -0.47015078911191149 1.5009614799364122 -1.1479779078352927 1.3389527279116666;1.4524809305611546 0.23265206909954028 -0.79500702244925703 1.7145356244361836 1.1612725275476705 -2.069559252410365 -1.1046029208401176 -0.40859587299047823 -1.4999828477125101 -3.2394399178066036 0.40524363173075395 -0.04676759560016433 1.318646521576299 1.2124212272990056 -1.1417700825217214 0.34198690863093273 1.1637919204856677 1.3937798508253187 0.26660726341231195 3.162922890981767;-0.12485683369403548 1.5136652316657082 0.30684354298568473 1.9880015263107942 -3.0186590278311973 0.41680083775377985 -1.7790123711859498 1.3142629415751292 2.0399921759720399 1.534747970524297 0.91799469839793191 1.5659610118237328 0.24952401776022176 1.1175111140533789 2.5474614759053718 1.1880735334148034 0.63832141217311034 -1.691998297971679 -1.5529184656512565 -0.45380344567478015;-2.6866291649195224 -0.34950954875494039 -3.0313461160994013 -3.4350218428960964 0.16243639784324118 -1.3854934722577132 -0.57055516653283711 -3.2319877586900874 0.81456514552884551 -0.53399215631416941 -1.10591765080102 -1.8059639797763256 -0.54985350977777248 2.1443370851584818 -0.07726554344109253 -0.89746796019768182 1.0988127967218209 0.53260413032469889 1.1268974332976924 -1.4141872075779822;-1.0346889327030064 0.45997144580449212 1.7553632423956349 -1.0393688701078627 1.1533790748920332 0.30367572193971226 -1.6523063993514078 -1.503629354828625 -1.4502962197786158 2.0004924928530636 -0.13087543793790476 -0.64953064871897426 -0.57847734738401335 -0.25456710921522402 0.17427522477038543 -1.413035146875218 0.60010021422509752 -1.8095761910237425 2.1189382976700721 -0.84194848945185885];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
