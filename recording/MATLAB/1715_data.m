function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Oct-2016 11:51:19.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.3125;-84.8125;-179.5;-9.96;-12.03;-10.33;0.75;-88.875;-179.625;-24.89;-15.38;-15.21;0;-84.1875;-179.9375;-25.58;-21.45;-35.66;0.6875;-86.75;-179.375;-22.08;-25.25;-42.33;0.0625;-87.625;-179.4375;-16.06;-27.97;-44.65;0.125;-87.375;-179.375;-19.82;-25.72;-42.46;0;-87.8125;-179.4375;-20.46;-28.91;-43.54;0.125;-86.125;-179.3125;-13.09;-29.9;-35.77;0;-87.8125;-179.6875;-10.51;-17.61;-25.88;0.1875;-87.0625;-179.6875;-5.17;-8.34;-18.4];
x1_step1.gain = [0.00556328233657858;0.0129764801297648;0.00556909154194222;0.0822706705059646;0.0983767830791933;0.0662251655629139;0.00557103064066852;0.0124465188642552;0.00556424969570509;0.0376222723852521;0.0577200577200577;0.0431034482758621;0.00555941626129256;0.0127186009538951;0.00556231531374935;0.0336530371866061;0.0474721101352955;0.0303536196691455;0.00557200069650009;0.0125293657008614;0.00558171986743415;0.0413992962119644;0.0446428571428571;0.0274687542919929;0.00555941626129256;0.0125097732603597;0.00557394182198223;0.03813882532418;0.0337894914681534;0.0259437021662991;0.00556424969570509;0.0125638005496663;0.00557200069650009;0.0322268772155978;0.0415282392026578;0.027311211252219;0.00555941626129256;0.0125539427226363;0.00556618542355192;0.0316906987799081;0.0355808574986657;0.0270160745643658;0.00556134862704206;0.0126532226176354;0.00556909154194222;0.0382409177820268;0.0374041518608566;0.0299625468164794;0.00556038227628149;0.0125146656237779;0.00557977332170881;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00556231531374935;0.0125934671389217;0.00556231531374935;0.0446229361892012;0.0906207521522429;0.0408496732026144];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.1299834690542667;0.99240010398054246;0.87411055486480471;0.83837439559490823;1.1715855378270243;-0.12231637239730267;-1.6375249138181305;1.11550853745084;0.00050870866816622382;-1.0602264860575765;-0.082655730731097998;0.62501568846558131;0.21696902620610745;-0.46385311634158144;-0.94353515064900118;1.342233838154719;1.6266140738961519;-1.3925947057173573;-2.2449813493327166;1.5848004340261621];
IW1_1 = [0.30031703153091088 -0.096164563413052781 0.28955515054072467 0.20052004486526101 -0.087499949996656487 0.015362997405233898 0.014966918367015285 -0.080389327706368988 0.25162265890960184 -0.21130215494802454 0.28485262513587367 -0.40305035334282568 -0.38203708783294582 0.18790255733063072 -0.28514476762172242 -0.039794244637762113 0.14801666244529596 0.17321451990112696 0.15994954893646637 0.077801045106446143 0.0047143568260204823 0.2336300461340215 -0.1814485408997091 0.098451430334261764 0.024958032257978151 -0.42039587583289367 0.044812107393244448 0.062093577009972797 -0.28728098200024382 -0.20830483201033592 0.033859935468566027 -0.44309265214776344 0.03321560346504316 0.32321141168141321 -0.13357409537286558 0.26129508702693105 0.14597185062077006 -0.16643314836634693 0.10803229361603224 -0.17105723692333827 0.07259827474264495 -0.3325586338382942 0.27357820588477549 -0.36916897553402428 -0.3856318338973635 0.27492567410466101 -0.20968902961189656 0.18115483793029347 0.16596414043399216 -0.091057059804751372 0.034270774701394176 0.28805346219730293 0.30882061582660325 0.3631898754638454 0.40411297896914261 0.17394597486236371 -0.24246228968252992 -0.27768296052192315 0.083649778219229531 0.24013584649962136;-0.17813654429610906 -0.50172117058163146 0.43182780437190887 -0.76411179256313366 -0.2718622757911795 1.0004209845441583 0.47209704383187046 -0.58720538419741353 -0.27151546317944752 -1.094096346049712 0.58198064957085338 0.61138448161380388 -0.2363765417410772 -0.65558539131247118 -0.36652644445936289 -0.94569137072300813 0.27861319650598726 1.0902787060775514 0.067278111843297198 -0.18760566313777857 0.3561787942297725 -0.38309989621306806 0.81334721549280986 0.028063637220129174 0.16929747142840587 0.43348195382660926 0.10623236795282685 -0.1136958574577579 1.0358855938368239 -0.11241452770297009 -0.028961765009277676 -0.094853293595171209 -0.21352676282935668 -0.37117131072662313 1.0154723074000458 0.10812208567747432 -0.42429404818575162 -0.072928789686057455 -0.61916717362819318 -0.49658025628122027 -0.15634702447732216 0.075989676535987705 0.32111375293784966 -0.60960705337401455 -0.42304510733570722 -0.051967436094280547 -0.35998404865417505 -0.3411645000063428 -0.14893600661703052 -0.97712709036556378 -0.20577979336672148 0.021671151657435873 -0.50970508477707022 0.015810007982122662 -0.23928577280862967 -0.58711977849166253 0.017251315102436559 0.35216114887470135 -0.014585205830002328 0.6434059989749763;-0.29571477033070048 0.71896190764761136 -1.0520411129162857 1.6445531673517142 -0.093014173685004656 -0.11618961770272174 0.34916082094806428 0.096467599031598572 -0.72625189895027298 1.7528560471740857 0.52210123077884074 -0.40622078557164315 0.10149848971566754 0.30201213220794071 -0.27597087759079086 0.79920797135220356 0.58729779448720554 -0.89689051312966084 0.24468013576870171 0.23621112889456786 -0.543441665354783 0.8956732129252134 0.37092530848304944 -1.1499122192774345 -0.46196545655846621 -0.24923955845773632 0.26103864006476141 0.38631487990473878 0.083200719720510019 -0.33314751833819795 -0.021956456633214043 0.051075939079980134 -0.75682764963593507 0.14998490879215454 -0.93352216342944039 0.023109674717968251 -0.4486373560105224 0.18533934945276581 -0.27190337300277184 -0.29977395626491476 -0.97639415993630063 0.1473453650407183 -0.070938951554318772 0.037484375822345525 0.3689365157779102 -0.52432848175066271 -1.3085910047487042 0.025752783860451871 0.16245211704251292 0.20665940967229895 -0.13987392140764612 0.042801722576425665 -0.87746034804018591 0.21200510169570913 0.43705947667933193 0.52164409073585838 -0.13524933610087125 0.38651590819123888 -0.095779709854804523 0.46528346414334748;0.11588797700322229 -0.021059652235433952 0.65483978099058826 0.82594335109011607 0.030822021048611127 0.32359656413758958 0.048246501659100306 0.070028385071427543 0.8007379176572863 0.89277356250660567 -0.19616620490125269 -0.17818982170491357 -0.13596447590671254 0.22860427524204843 0.24516469680933908 0.46183046696453017 -0.60753765534013637 0.53284715642314073 0.028029413715358123 0.080958007722788952 0.28098593624299606 0.78458945204515773 -0.50905591452785004 0.63771930285487177 -0.059882483720397992 0.49385727477587771 -0.69919512890761859 0.25172319201639087 -0.3138363615938165 0.1217047770174997 -0.078529265413225385 0.036933534350009768 -0.49049971533575276 -0.29717499707303291 0.50077573084119553 -0.15585866974585616 -0.27598417752346394 -0.13302693469413829 -0.62482057374331734 -0.37545659523681874 0.51516733229663503 -0.047419000266248172 -0.18082288301159247 0.024545738740608655 -1.0275835697835061 -0.16087628437791598 0.3898150829538396 0.20749749516451557 -0.1667565055855135 -0.17223842737221989 -1.2089824176871751 -0.052745037160767144 0.11032508976677864 -0.0047789071566164514 -0.048073672304385223 -0.42002527303114112 -0.85515234698722054 0.17076695185966889 0.31454712837036025 0.026651299617399336;-0.39856419846779811 0.24667579150266344 -0.55333454693536432 -1.1719493197427231 0.35607600205845991 0.39220500952143461 0.034533285239379222 0.21451968611029548 -0.59500780807192222 -0.94591898885848047 -0.28418688213270127 0.72548448338754168 0.093396372755842214 0.19364401633896497 0.50945002319024912 -0.025235025324436611 0.18438817637407146 0.36673230827138797 -0.26013240169033391 0.092316681392224181 0.027286355745229252 -0.71593923872685761 -0.36244349493571182 0.16041013629553089 -0.63047289123398631 -0.13781322246951619 0.26209331337441172 0.077770439774036013 -0.43802366194112985 -0.27472485079892034 0.041994106469597753 0.038317337316165011 0.020018008735212655 0.7489885097367196 0.0002845410876148729 0.011017481540155383 0.20594283262650712 -0.3420562603204948 0.055573558914927657 1.3744579798438428 0.31671307248715536 -0.00047104746938769499 -0.048727709920299636 -0.55664770453712764 0.25491228092836465 0.66242134412253906 0.58235710856061063 -0.13489357520707104 0.077181792850387676 -0.62615431698035007 0.037192345406190888 0.35569971194977501 0.19415763980675277 -0.02187833199339026 0.11440619254243331 -0.29917036326201946 -0.56324052236737232 -0.035980885491139154 0.14848567635966822 -0.39162050524706271;0.51123166338171655 0.68198934234496855 -0.057823926645867607 -0.89345120215720586 -0.27374244531587899 -0.46009495729657085 0.077803985003059101 0.66836289366343316 -0.97906044081766119 -1.0400644294050274 0.60906803580544111 0.29637912987317122 0.077875437651752116 0.3163132089753975 -0.67834041760925468 -0.81861256728471865 0.79780822208176339 0.54268308800904841 0.028069202538997647 -0.59051569949346594 -0.45935429211662304 -0.35714433449434396 1.0336189448065198 -0.028753613564938621 0.30530670202574228 -0.37137391829891825 -0.0099325693500612964 -0.55768614419619678 0.06292687689363341 -0.37768287146644358 -0.35073904670909567 -0.3960979996773436 -0.16881371272874696 0.90972773986775834 -0.31719006199478517 0.16314237461203956 0.049102786650567651 -0.27177386564277833 0.15915299425120827 1.1590973949695118 -0.48710038959573237 -0.19987449648920275 0.37301047458024011 -0.29594135319648018 0.79708267392465582 0.58235789150973682 -0.62660160448813118 0.23499075741081629 -0.072829884433157452 -0.10331522708638106 0.37763315053383961 0.50802688969588394 -0.73557030913320964 0.38194864234964765 0.15771211031782881 0.35579183094515576 0.33837680526036945 0.08534020514723685 -0.25973575414926353 -0.25874230284678001;-0.15937679888506481 0.093991590999181696 0.10516077658572937 -0.65859027709816098 0.29128618771030174 0.47388823015809234 0.1693165980849867 0.015979653922780234 0.19985442260284839 -1.2745927966680324 0.39759423003021238 0.24860353141579233 0.079133723098723935 0.20538190580508484 -0.42191438879933651 -1.7151354751017645 0.63723071133922038 0.7348140199238703 0.08160324371453867 -0.031710248930350945 -0.15076043122001606 -2.1524268286879851 0.43892068662968331 0.13600734712353882 0.014763294206003141 0.15627401307655092 0.020950004573433136 -1.0973477724527396 0.23279748993691804 -0.19318438689024472 0.029603813910307145 -0.14664014020579169 -0.16089562393300275 -1.30262594894454 -0.027172066755824724 -0.28478143893671259 0.70409746353946634 -0.098979392990156803 -0.47666702401682304 -1.024196708670994 0.23506886437712121 -0.14822415297132835 -0.13929507499428767 -0.12662995710548405 0.0019565138365025443 -0.64072343808850618 0.39250048609663202 0.35420891053984555 -0.36837247901962644 -0.28236878426984341 0.3722569129887589 -0.51751310237181714 -0.3067761518627557 0.24675356364682394 -0.20982153215723268 -0.5501289093153372 0.25453655122949059 0.16620801057494999 -0.56171164915546179 0.10810961608266656;-0.25015984098406863 -0.32635864485216143 0.63013488299551035 -1.0778551105414531 0.21740750735961401 -0.51326535212002633 -0.12119114147569289 -0.38785145089335543 0.57480801838613582 -0.85555858072713131 0.92472663631337315 0.070112772927408168 -0.17599142368603166 -0.84496758519689918 -0.44853789997041438 -0.6752805825083682 -0.053462140185070159 -0.25688470329690349 0.78500430859134318 -0.46764479561677286 -0.02528348801899442 -0.065382316847503674 0.072639531173387215 -0.034213946170829443 0.13030069421050139 -0.28613475369066188 0.66074786142387754 -0.38313201954243614 0.59670412383491211 -0.09782749748381929 -0.39578281811400662 -0.02406214838539128 0.108373345770076 0.75281983619843673 -0.45303918868086074 0.27762873613897981 -0.41947630560038374 -0.043312048357968855 0.3234403572199116 0.86375174355874884 -0.14430643162008361 0.74059985244281878 0.16386057021659745 0.32159208651499438 -0.2952055006632911 1.326741625064739 -0.096901401062210027 0.20570945329530915 -0.57030691841571335 0.80935183271908329 -0.089746315072839894 0.39523534979931402 -0.6884930716201868 -0.33035679717153033 0.067762296513378437 0.92339429056442168 0.23167342877619129 0.24578445630897905 0.009159741426958249 0.68097049439933355;-0.082569314481720849 0.37141833353994191 1.0880156543775981 -0.13482982685548262 -0.26304759811028866 0.36238776342854012 -0.12649532736414168 0.61507845368349578 0.82649848151625704 0.4285502919359902 -1.0778424785603342 0.50708655819929949 0.075506999621305457 0.50267063315924265 0.77458013215488364 0.61221029196576515 -0.73573110449666679 0.4377916371457462 0.047848640861235407 -0.18239750432323645 0.25645785432854429 0.15170143303569966 -0.10241078668492659 -0.11919051035057963 0.16948675854655679 0.053998186630310342 -0.59454456966508729 0.3605928772040623 -0.36012228866003948 -0.6532119003924004 -0.19944429981563644 -0.25710919157074003 -0.63574216930236749 0.29913559308777554 -0.17443235506230975 -0.35339885758548339 -0.46657167718196352 -0.22460785665998886 -0.90916204516187848 0.1821776641889154 0.40608211400989169 -0.68154225040031879 0.27568412626440253 -0.067448044408243008 -0.83291771080120758 0.34572630184572301 0.61169240237802891 0.16904181501426321 0.00070255979271845051 -0.40389939421294735 -0.68869458005105233 0.061924597095395002 0.29078387269905809 0.16524652936757875 0.25726176024952652 -0.20490303898287701 -1.4433479537642555 0.18851854975383878 0.31552412385520384 -0.45977827414899697;-0.56068832156708093 -0.29784723013468911 0.19314153818906624 -0.89145514533964421 0.17142159668988785 0.38924144706505709 0.028548662271471528 0.083326897280596834 0.0071958872374760239 -1.5093805610649287 0.17347212903681947 -0.014284144823427856 -0.098034025362139163 0.088928400235908173 0.52429921398989077 -1.5670167024113588 0.55264668375474124 0.25652684545980181 -0.50028692143909415 -0.0084183984743578348 -0.020044741020787914 -0.65350689403764817 0.68920851507752245 0.057449276615921481 -0.5302543946523367 0.3676813215516776 -0.17640436089966097 -0.59741325251418709 -0.22987876174258684 -0.48245723691246312 0.6173139625552484 0.36360282807521838 -0.35586947422980747 -0.69922139978981734 -0.12792336392378167 -0.46603656406570892 0.27052877025254551 0.33338922701071966 -0.050518433175176708 -0.86112454594286258 0.17938418328458916 -0.23897459007812144 0.040837415077436413 0.46656025180937777 -0.15668551819468388 -0.58409359042194575 -0.098926731816028152 0.23900056908169873 0.27574556595351829 0.42240277037569135 0.25961100922772767 -0.15012311626618546 -0.44609050538646122 0.29819127797050943 0.18020781518969683 -0.058748215888574103 -0.031364256482776437 0.23833354020942171 -0.32761200133844048 -0.23420790738396216;-0.53486209248930161 0.51042480324671591 -1.1515600550917302 0.89706276870849533 0.31010687958004102 -0.053397071492871685 -0.65131537009805152 0.67790466241903824 -1.0298563375523087 0.68584563724074377 1.1869080631991935 -0.16112888499726472 -1.0516813207475397 0.020137933617142119 -1.65671054883306 0.20625673789124099 -0.071413969354530676 0.27424863927975779 -0.25046271828816546 -0.022010876321374329 -1.0624801290453465 0.34267575219751417 -0.21639577763356899 0.32316600389990197 0.60180274331046901 -0.041409244507580219 -0.069609628672091944 0.63206103420747628 -0.056041736882190052 0.27858543403100111 0.20184687114944302 0.066724073890083863 0.61796264442478022 -0.43284636865244136 -0.12480204504003142 -0.023615852187190207 0.16807029085332695 -0.1443380643708744 0.49100299798959179 -1.0229681678285785 -0.55662162104879476 -0.298472145854704 0.50140068929283055 -0.23000697691810634 1.1682437582077676 -0.58754641359799209 -0.74547820104323226 0.039171302969823095 0.46979815793191765 -0.18707508767126543 1.3165726591702684 -0.52940201749951643 -0.73575461714847623 0.15199581630950959 0.57873435516892813 0.16098166475582087 1.3009908807859094 0.12308264381037839 -0.022346033984003096 -0.20397499110949946;-0.45270624568462925 -0.78903339803246908 -0.65013517396997966 -0.4179956109346758 0.082532461452324984 -0.98238879821863667 -0.45674424020650878 -0.55571864404365867 -0.22532216425035181 -0.43212267092779977 -0.54246968448099997 -0.941713820900559 0.047091290282072665 -0.81362489693764561 -0.48923594675866616 -0.27427022932955591 -0.88026672454576704 -0.58604736781085665 0.38711681099529482 -0.8465896604819485 -0.74648114629770579 -0.81468757149712256 -0.67543369088720262 -0.40127782931069628 0.0632913748148205 -0.80881982089443749 0.71250897676864755 -0.96887611124153639 -0.76674699130784429 0.12004499176760783 -0.025293700119082295 -0.15910086472219692 0.10535752317005961 0.52286167939494721 -0.4096819801389896 0.43798171225984989 0.47648931925784987 0.46566765581559505 0.14640412997949434 0.80306221163900615 0.43217655352268547 0.66921454572036365 0.015346609738242822 0.62949357929591376 0.38396859453304732 0.58234864453234048 1.0961095196516679 0.60680452177456545 -0.16902925109632447 0.91103876532878947 0.060110441885904253 0.44430039299920437 0.99004218757037576 0.67546778138861008 0.17007200263514743 0.8020216665357055 -0.41330197522396439 -0.1024619386847756 0.29040204562578675 -0.2016509602943522;0.35469450835525812 -0.26850589353821841 0.43764178796963316 -0.4240260077275837 0.31717376561544097 0.13205946825891854 -0.0080551124998765669 -0.37097898088378339 -0.056131353494646583 0.20342416257773679 0.3332784747970024 0.39707897306463286 -0.33774512823763747 0.15965997473355503 -0.080298841563690923 0.20183342495822917 0.25929462226389111 0.2903363236817515 0.17780601102491445 0.36103587452771829 0.036390881011715268 -0.32110286144735395 0.12526875588654479 -0.1114702951719901 -0.096576221134624635 0.52762199651238395 0.32124671121368698 0.18147808442365398 0.13440872087672012 -0.32782971322248683 -0.1991229843322764 0.18822559749541307 0.69280721162408321 -0.20240779177859225 0.29756529885099425 0.066111707261679281 -0.031024958965907203 0.30887473227990841 0.48484154864854551 -0.42359929313406181 0.39035888598453494 0.10400879284756044 -0.24100180250788136 -0.099984808199448535 0.77900074293361554 -0.4119850355502136 0.44781280903513454 0.079324187708711455 0.15326940627191532 -0.60842209055756802 0.67453353879643541 -0.16558780293364464 0.61490924474601227 0.121480567642055 -0.03838344449105513 -0.59964813384145332 0.22758796097365111 0.054065888443184773 -0.11660455870565939 -0.34183460279641881;0.47247223744515165 0.19965413786134356 -0.22698166671439332 1.1112624490431269 -0.12954629730634235 0.28903276025187041 0.54467319262273073 -0.21687272429182627 -0.69231513590221605 0.74423016505618622 -0.9614968883747792 0.68831844535810949 1.1807744233407782 0.42076077779261412 -0.056401771085803375 0.77229973357761073 -0.70034156011990167 0.12962146282706058 0.65595985500509046 -0.034565802725110541 0.12515441529554353 -0.046249450635688097 -0.38899435654942205 0.32809200839198166 -0.54946703633433946 -0.1530125028871766 -0.082591117132502653 0.057230534990066702 0.044692463757976184 -0.41382483402371045 0.091438463156842592 -0.09920872244493667 0.22570124354560209 -0.86776178325882336 0.62942399667558513 -0.061805875782413956 0.04233262699608039 0.0748118330493064 0.29559066706752302 -1.4695931749791089 0.71231356623281383 -0.26935440829002916 -0.79783556697114888 -0.39592295385791676 0.38669670453370314 -1.3992770184775916 0.54083776478899792 0.1411983730487551 -0.50991585610904555 -0.84851890420665965 0.45960092401315356 -0.25923819343388738 0.69237104004781036 -0.17791553937251489 -0.8450441944984175 -1.2696522554707841 -0.050153775305444917 0.1072516962424625 0.4657535425442843 0.047958685587421737;-0.11555751274023511 0.21671211280831179 0.17428081349023128 0.24993430477849984 0.39220220272737388 0.2385825210321538 0.16691985899819628 0.17983316365011906 -0.24315321245508589 0.61221395169439918 0.48581197972243556 0.052776778860624429 0.099637544748007026 0.069628448120195724 -0.11809588195197934 0.31856083299353943 0.38755261962716903 0.7986628796530556 -0.057222420009514045 -0.060843608815809747 -0.16274353892153307 -0.1269890509024868 0.034491622626377366 0.81812675934669765 0.21152075835056533 -0.35049192582416328 -0.5161396976294198 -0.24406218376106947 0.40284731294512799 -0.14574690363533374 -0.21925215746643531 -0.20928461388996858 -0.20953163345682271 -0.55380840780002893 -0.1255384283039557 -0.25093952233893746 -0.33819749323144077 -0.30163220053962353 -0.73266573379568567 -0.6775440853445156 -0.19934828588381134 -0.36087337553755611 -0.0076486809448487285 -0.21710559887206582 -0.16655105408793286 -0.92722547409370026 -0.077597457256552524 0.064114594826693835 -0.19625106096184711 -0.10682526661944458 -0.35066518079151704 -0.34951803660474334 -0.75056203910574748 -0.079621095742786058 -0.030820144100801063 -0.58140718555228676 -0.59120248083472271 -0.082787220048214052 -0.44385492269196331 -0.30670586396253141;0.42169421198556939 0.059119276401826237 3.1943659023221795 -0.70115767240016658 0.29486014556227669 -0.23351110926634783 0.060969996579531838 -0.082151999048029195 1.8757941609770303 -0.85547743396053122 -0.067802868235328287 0.63442396063449846 -0.27336529472485221 -0.16665231876254824 1.226630360400194 -0.56469672838197904 0.57330481149917856 0.41914963963949842 -0.32053904195592875 0.15316373019901905 0.25564611299931828 0.060740286582989661 0.084340531926902995 0.10905655701201598 0.0019747941000400199 0.043443661181902987 -0.46779907754860206 0.14538115628897597 0.049645968412552276 -0.16600405066061036 -0.1366603354579114 -0.35579511056418761 -0.6362216320106453 0.24191338814259183 -0.16842472978392414 -0.017088202930945165 -0.098834471172267777 0.11621071491200106 -1.1006455656938476 0.46191135486576651 -0.43412645102109765 0.11854952860453821 -0.23807537319720018 0.39828746152781869 -1.2068005989257646 0.25529366577273893 -0.48478414580355966 0.10225001868124194 0.19485801005094669 -0.10680666040815873 -1.2258480187085636 -0.079491276048176671 0.056841742107724372 -0.40999526470619801 0.096677159449569255 0.1638386588719474 -1.7912810517593729 0.048241190738289946 -0.30223348222504876 -0.50774322566988361;-0.113814647941631 0.44278821147184966 -0.60692309335827066 -0.2523737781493795 0.057302833140597885 0.74211503635250209 -0.21694701311095241 0.37393958650415438 0.17605522466722415 0.60932011021915911 0.33554367804471441 0.68877760285616096 -0.033657674632458959 0.85315357583641338 -0.13339530665344887 0.39768150530484159 0.082818497286404114 0.56898821900032615 -0.44713760347685749 0.84440174645222743 -0.41151211682967354 -0.12953072160002072 0.041788944958199431 0.65998138764312952 0.08467006743818023 0.33463637274959895 0.10236189240343807 0.16014599593040346 -0.28091167416572244 0.20624883935306715 0.44251545827410327 0.2514392240147007 0.072944434558856866 0.73224085453057353 -0.10050766445132786 -0.85163463107326354 0.46823385010220947 -0.87533523551498016 0.10063004056396345 1.0339178819316044 0.30099827895510906 -1.195681007567384 -0.097428167359234985 -0.89663904226982982 0.38495954055458032 0.73716226980833122 0.1491626587712121 -0.39590599996011638 0.28956474484175959 -0.73748451855975783 0.14679736145203062 -0.09789842409479102 0.42355252552061778 0.041638468459814545 0.073079718513749239 -1.0385811463131633 0.16797316504826607 -0.34071109435351682 0.42004000300582894 -0.61383437143822939;-0.51155008870666474 0.24646792095163586 -0.10129853878360598 0.00010381997223942244 0.20251156564850539 0.11417921224306843 0.032343527527884247 0.33450335258435682 0.044643119487191255 -0.064781955469869534 -0.031450451483985342 -0.22627334069456212 -0.22851431251080762 0.22882315656970287 0.012608789202266477 0.30446661465386504 0.048367670700167509 0.048724254446457262 -0.39316017622467442 -0.21517293332031623 0.074777665902213256 0.040507527851883135 0.098142195196854451 0.32735257901301928 -0.48137060105726437 -0.25333097756622874 0.12209285975731299 -0.13129888583986021 -0.14995412329468069 0.054248912340408219 0.39270606399263464 0.14331297749056476 -0.03009239063244222 -0.53296491238688848 0.19854789090042677 -0.37148316956337757 0.020282296989529089 0.15580815762609945 0.092645485080568482 -0.59971727966406496 -0.16698581082402944 -0.2663012384844981 -0.12702253397098331 0.082155740072754779 -0.087747293633223242 -0.71759760984172638 -0.029550135306466579 -0.21099715340179523 0.19048468386238709 0.018546547489719824 0.35706730270555359 -0.45370880233841465 0.39136498065239761 -0.030221535027928917 0.40773109659943846 -0.5116798709139212 -0.17401314934542286 -0.32282459452925077 -0.13399772810645194 0.12044667498062911;-0.59016327610891173 0.45586428890586472 0.18571665284846162 1.4324864017210956 0.40022102582326713 0.19619081067368846 -0.090279560571158005 0.71840763127375018 0.58861759268923752 1.5847179089724057 1.144967020475101 -0.14270898383022576 0.25917814281188783 0.32760007328580981 0.88304869297426924 0.21082482639858063 0.85170899652310472 0.44154536712412018 0.19565857749253027 0.1342089987580326 0.75218461676688286 0.20394741393140092 0.56387634116043839 0.16578337066953713 0.10334232558614478 0.09528116312513793 -0.24510552089213616 0.28000067879547369 0.40248744766127131 0.072200253593053335 0.033048029501305511 -0.011607010497837814 -0.21714438887516696 -0.46446882163411785 0.031815400668342694 -0.17467661630259257 -0.19754484988557638 0.14531813227713647 -0.23288959919393931 -1.4093860583465614 -0.91486937064947049 0.058826762110307428 0.35052165553341386 -0.28405326367600697 -0.17371807570409872 -1.2333534764007457 -1.6179421926312421 0.38670366030854808 0.003602356065296017 -0.91717830528213695 0.02492433242106731 -1.3109965705230433 -1.1660859467374598 0.12128844402536891 0.038988302740534574 -1.1159465715006518 0.23530272036355943 -0.56635423936312324 -0.82256280909618884 -0.56916579293677627;-0.29288594583532485 0.55189981672954747 0.51225257830397386 0.19694175672154923 -0.21037251460680187 0.077143475078954429 -0.48292865296954568 0.67858106672704843 0.64330721360789422 0.61576720305742538 -0.22042543404693196 0.23483628084121425 0.13204573997869376 0.44421026241950506 0.22710470058315127 0.31447489585661609 -0.71643187074815851 -0.46019400543065092 0.1688668685866643 0.33805235425925423 -0.20478491658603887 0.3693882289321524 -0.49101867949457562 0.11612431837264442 -0.44518880311140024 0.31970653720895958 0.041547955982820073 -0.31018667886081241 -0.53340494244259951 -0.21629125596877075 0.50739915753105291 -0.025587875143600246 0.20452299214605865 -0.24525875248920062 0.096925497956392062 -0.3885336348322147 -0.21339243184522061 0.13827503883168674 0.1324870900868669 -0.34086575249990714 0.23674313630824767 -0.35947183046763498 0.089944138507750626 0.051525904254541982 0.072706108051386775 -0.14507075283856161 0.18992202218936496 -0.1339028976588475 0.10942253154941728 0.72406892976612469 -0.18548524330038052 0.39391161180364836 0.024742491867446585 0.13088138626021339 -0.038228839704855196 0.56550216300743339 0.1669213985687226 0.33479019560109224 0.44065628652634137 -0.082702516247780258];

% Layer 2
b2 = [-0.84228612727963392;-1.0337646300043188;-1.5061047315236686;-0.19085654781039599;0.039299177282347809;1.0526542619296244;-0.57017454690704572;1.5085217166005807;-0.12396626919619079];
LW2_1 = [0.15688548603286079 -0.13670940533298154 -0.72954001924993128 0.39236667803172165 0.33885810027953989 -0.28783341935126538 1.7220735788068766 -0.54361952271399483 -1.6233366108243545 0.051586878846942817 0.94887920248357782 0.93874094379668338 -0.097092918046779622 0.3925740011615565 0.13441484188573932 1.4586721565495315 -0.94322654554760788 -0.12848670037402543 -0.17600354792066394 -1.4460812143417694;0.34705925862031328 0.8800583228991038 -1.7481961033237379 -1.2120426171049901 1.3344985420014899 1.7361217256046946 0.44133499436220824 1.7479486463049287 -1.1676282585183404 1.1277739856804496 -0.78029504838800878 1.1711228752519836 -0.78742226155244954 -1.5121624414800177 -0.81737548351226086 1.8016049671481702 -1.0957614323858713 -0.43873494996076662 -3.0118886217214014 -0.71554348448198413;0.55556088233050327 -0.51309226401903019 0.54266502788106774 0.78166104892403154 -1.9861122815584493 -1.3893906309742936 0.098054093804253298 -1.8333732628439507 -1.0357919745805708 0.33164242817467215 2.296167782320881 -1.2541923198425606 -0.64819577730577094 2.0878753996673387 1.2325706864001491 -0.17097625877188499 -1.6618035206673119 1.1841234033058601 2.1637971332170123 0.2692786181937159;-0.13608615216715197 -1.1693904835213971 -0.84281515812716556 0.61551532955240329 0.56963975073419215 -1.4307356111896503 -1.9500544597127563 -0.30294544830517234 0.32081881087230196 -1.1231822506165532 -0.89678451134252712 1.0546087561537205 0.17476192687566616 1.1512998536570842 -1.3597401870423991 0.57521218681728692 1.7297469411559383 0.033678563210824269 -1.9737259626468415 0.5980806757404864;-0.63131914135675182 0.75076287240606776 1.5466769769574606 -0.13543153095476435 -0.71919622813832007 0.77609585111579948 -0.7745107579613173 0.47252550733771542 -1.4879223719062364 -1.0734697922026741 0.70712295419414017 -1.419931525835344 -0.26844031582850841 -1.9012890234683828 0.32905449042573087 1.2801744222934004 0.22040682157191993 -0.61596651689074122 1.676116181758051 -1.0118117297931815;0.37824842976338879 -2.0968687271536406 0.96885546976773274 -0.72152288008871368 -0.28358487868879184 1.6649752850723729 -2.1482521967618822 1.539950250312081 -0.72519050447800903 -2.2055604606384205 0.61084715163786829 1.3709958353863518 -0.97147251495531783 -0.77435601061865567 -0.56698312061321099 0.51732534975241817 -1.0230003432351056 -1.1636733159403418 -1.9422608647850366 0.82386421691487022;0.16913786473545867 -0.24723341323970363 -1.3767946230909478 0.79547078068375865 0.9968932237695608 0.80600984850141855 0.52819642653848631 -1.2696704226900295 -0.44199574811881381 -0.58261166069076886 0.92904562794915291 -2.0264402623839191 0.56086516388890773 1.0727126881060021 1.2009625190276068 0.84276051048320544 2.3092425715562479 -0.30032063822312566 0.47775990396321888 -0.79023956300026632;-0.8927327962685917 -0.23608355935262454 0.8533066528596901 -1.7467960818881885 0.24939732575516521 0.98054441843648954 1.1718943718000951 0.19781776443639865 1.6217327843416842 1.9369706342388779 -2.9448020519424856 0.45589264605872953 -1.0437380263762381 -0.27848371010842243 -0.36261750343458582 -1.8130258847058827 0.28847532080518196 0.32868458335921213 0.37728418758779925 1.3472062087619432;0.040081404771513361 1.5040585187278228 -1.5141732059264841 -0.57848339776888535 -1.6239592457569387 -0.0514852393987364 1.718837892562401 1.1733602830930876 0.81798593757520444 0.41352355018111192 0.73303631387438084 0.33013218564902375 -0.79866515386359127 0.086433748586254647 0.24894634029933088 -3.3255077562672386 -0.46248688351521167 -0.81679001369174853 -0.41932604903491943 1.2079224872908954];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
