function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Oct-2016 13:06:21.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [1.25;-21.25;-79.625;-5.65;-4.33;-1.22;0.6875;-26.875;-81;-9.41;-11.36;-9.54;0.3125;-39.375;-88.5;-12.03;-14.36;-12.8;0.0625;-77.5625;-106.4375;-9.43;-25.86;-10.05;0.4375;-86.1875;-119.375;-6.21;-13.26;-7.21;2.125;-89.5625;-179.875;-8.35;-11.81;-7.31;5.125;-87.9375;-178.875;-5.87;-13.09;-7.12;7.125;-88.6875;-178.6875;-3.95;-7.33;-5.94;11.4375;-87.875;-178.5;-3.96;-4.64;-3.09;0.125;-87.625;-177.875;-5.94;-2.9;-5.75];
x1_step1.gain = [0.00557977332170881;0.0645161290322581;0.0131470829909614;0.1230012300123;0.169491525423729;0.555555555555556;0.0056012602835638;0.0539629005059022;0.0130505709624796;0.104384133611691;0.0944733112895607;0.0693000693000693;0.00560322185256523;0.0404551201011378;0.0123552123552124;0.0959232613908873;0.080032012805122;0.0674308833445718;0.005621925509487;0.0231884057971015;0.00940623162845385;0.0776096235933256;0.049862877088008;0.0720720720720721;0.00556618542355192;0.0204996796925048;0.00870985302123027;0.0702247191011236;0.0655522779416585;0.100959111559818;0.00566772936592278;0.018348623853211;0.00563976031018682;0.0892857142857143;0.0811688311688312;0.122324159021407;0.00566973777462792;0.0183591508892714;0.00560714911512178;0.103039670273055;0.0985221674876847;0.195503421309873;0.00568282720653525;0.0184331797235023;0.00562884784520668;0.144508670520231;0.0898472596585804;0.205973223480947;0.00575850278927479;0.0187793427230047;0.00561502017897877;0.171379605826907;0.168350168350168;0.178731009830206;0.00561502017897877;0.0188014101057579;0.00561206594177482;0.174216027874564;0.247218788627936;0.0969461948618517];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.9903830742611538;1.392642798811049;1.1899362823084121;-1.3151659179049218;0.12407372087356262;0.71980545374510452;-0.40224034254806013;-0.89317741909864123;0.75569287034634658;0.41694125088213957;0.43009807984897236;-1.403106898667992;0.3109754766049867;1.0443420601989508;1.218053985091573;-0.87652668282483792;0.7199587841258851;0.75067583163874885;1.1897414594342266;-1.4254174868042198];
IW1_1 = [0.36040313977964566 -0.11374880442066033 -0.10116819580757325 -0.12987597655667402 -0.2760340765989085 -0.3584220498853255 0.39300748253091872 -0.13964498276488493 -0.072339053728800423 -0.070679830953134681 0.26845834729812112 0.091487633105021851 0.089462381161572152 0.023993687463458854 0.24542031070229223 0.16383090502092479 0.022021405582451803 0.16485983606528895 0.0041597348150458971 0.035914907304857267 -0.22782020881712647 0.23893222248122964 -0.29558883706258293 0.099392384015903251 -0.1348822051925623 0.33563900572335092 0.14584156101361048 -0.080676784791907472 -0.33577243329817758 -0.06126077607264236 -0.021481442993828974 0.25736570857783159 0.076354939757351026 0.27362994423776643 0.0572585835077822 0.30550387124202116 -0.075776810242214568 -0.16226367865289934 0.16993366545068272 -0.14013787862642693 -0.08191933625076718 0.21832807005004323 0.11229057935835775 0.090906166061513721 -0.11640465547513489 0.34399338287014103 -0.31096716431983423 -0.090440499006439037 -0.3651645834911062 -0.48092948156792881 -0.17476610665230571 0.34060062146437337 0.12528133105580078 0.027627969691228219 -0.39083693801088853 -0.48004076182515659 0.23181551437837364 -0.040381232628679237 -0.0077184851158106083 0.022489814079964358;0.26841093270798194 1.2487869666698204 -0.63876154435927723 0.22068885271191768 -0.94589941543767997 0.1221108962126823 0.15298879285435726 0.54451190110875669 -0.52140417332837674 0.65372556853542851 -0.89668185486471375 0.46876618319408608 -0.29991829870518494 -0.17610748630445577 -0.23635126385053537 0.040889988160179754 -0.83870156189345424 0.51349354597648744 0.0082080225904105058 -0.5410573530293461 -0.065843435026716454 -0.078622130601170792 0.412137614720537 0.60927232882323956 -0.16232736601665063 -0.17951597077688305 0.3549421049269299 -0.46787193130203802 0.81182841778541304 0.46290608354390833 0.084380672648943542 -0.2260013212624154 0.13596381536589253 -0.34662343785634325 1.0701092973288042 -0.040263147723299537 -0.0036552153293524696 -0.026564478019379154 0.31664880398700956 -0.37359787871159411 0.52521206853517977 0.018904836435815808 -0.066073485057788719 -0.33284577773466761 0.41601963375049639 0.21686254941187222 0.54628252759528295 0.0067272833011413928 0.15415557369316565 0.19879585017881726 0.18733501639544783 0.074004649404573547 0.92098715835517364 0.060612862116799851 -0.45722281379863444 0.089176044301511923 0.57590066384014393 0.32658463403413457 -0.084120091199199026 -0.050616547965690407;0.0083418228508240957 0.21790909027954061 0.29441902288130856 0.052400484745473201 -0.33023763497118869 -0.33699906238326732 0.13227687677218394 0.40988953201962647 0.41094974918803479 0.81441596238198144 0.019728095718515568 0.24193470885041821 -0.21533844759945572 0.28368103537016665 0.6463005553147454 0.66976205262307664 -0.17394953287484841 -0.12358368410429972 0.13361710903653895 -0.12190247994310051 0.37051506949383056 0.44561683827946619 -0.075661619735526611 0.2592721421822613 0.054703583825354833 -0.22839345372245137 0.67926168244218554 -0.27940252364608525 -0.13621188423736386 -0.035429037088256198 -0.044925790164581168 -0.29836688824968932 0.070848825277017247 -0.073772424574630915 0.33293853750501901 0.24984193516099612 -0.18196088424095255 -0.38905792721704269 0.16636926227614079 -0.17667585142200676 0.31485581203541996 -0.026653878565726655 0.030837223012631046 -0.30786353397255678 0.28216152067347738 -0.5966595342191533 0.076708638207538093 0.0676858983746811 0.36526976447155113 -0.14948117065670052 0.20064700934215052 0.026649501467165403 -0.142841846937966 0.066036775013249505 -0.21504292989092086 0.18464927221734234 0.085902160920161216 0.32444099048338276 0.13456159414687283 -0.18835020333417066;0.2445161356006596 -0.12295682581541736 1.0567093263341643 0.021490649556225025 -0.15262770190723998 -0.12530563700947683 0.021195339307655311 -0.30405286675899729 1.1159878916125245 0.19966966442190415 -1.2885276439814906 -0.31127822792014637 -0.28580432082925727 0.76255302016635651 -0.097136157645555207 0.57739957932671349 -0.33150386820017441 -0.36941689029493646 -0.15719602236702848 0.46161199982433526 -0.18235163529097506 0.16548295324477022 0.055813196311034131 -0.23289932296401766 -0.13127080387068235 0.13515696135542463 -0.52099120832280643 -0.5755396522659556 0.5148928211250321 -0.3889672121712438 -0.23313099338033016 -0.12966202287265169 -0.1560368696637334 -0.8083955864295963 0.64880775620872422 0.021084867291460443 0.12289760484678268 0.09003059130095159 -0.66343212668698781 -0.60702646945498862 0.64807914514239218 -0.56648794072825881 0.27745807339825007 -0.042233416550714512 -0.15565857200434416 -0.68391686710189858 1.0159623779032925 -0.31897089763256503 0.28093337672771124 0.21842305301589621 -0.45631079162994914 -0.33926202055770699 0.65618677565760364 -0.36212749708553332 -0.23265589804157025 -0.23104362664363631 -0.57717775119566694 0.44777703583669093 0.22571318952219097 -0.17527253242634186;-0.34231549712379344 0.43875386053467064 -0.67274182068996369 0.32150560315267579 0.005491508695564651 0.21277001424643072 0.16244621162324893 0.24137148964037303 -0.50556964918653036 -0.036721325777424124 0.094376206994126882 0.15110642632637922 -0.0081754812426404547 0.062954204822979101 -1.221459288308087 -0.7874984286022263 -0.012508712752256051 0.092595075743765617 -0.021612769916586411 -0.49416104764602675 -0.79382992464501723 -0.22446309841224693 -0.13291758769785558 -0.15882126358444121 -0.015504471296495997 -0.32085165817375405 -1.3660958107052734 0.24586429303363208 0.25253197371901043 -0.053560617469798032 0.13529390807242825 -0.049936701477484767 -0.67301182802340953 -0.068691421259852337 -0.4219878341660866 -0.1472127998304964 0.21721165345400004 0.25577948619131008 -0.52145064052984602 0.38600964640302782 -0.45610156009566227 -0.4092662233164085 -0.45619883976588771 0.14958588083525845 -0.69738282146425545 -0.075107285323387507 -0.32084079142588745 -0.10462351210618036 -0.34831065003536793 0.028752045124453954 -0.423978746638078 -0.13808796177767965 -0.16647799926894014 0.17297672329747144 0.21807991994952294 0.37730809304122237 -0.90870000961033315 -0.16791532346758967 -0.11149039872745062 0.3801056810881992;-0.028671618458646807 0.5432575047797189 0.11840183845380377 -0.066120217989050101 -0.59784181644668377 0.020069833913497571 -0.32787473185779631 0.2001989405567649 -0.21943373269498243 -0.19976627892810073 -0.25038131659132268 0.065035200200331364 0.15610776373782664 0.24110114938540483 -0.30965971763746447 -0.18454793201475836 -0.38688624629453833 -0.046754178292969018 0.16649559368301881 0.066860667105079832 -0.39747689938166869 0.15187784836179677 0.0086367395151860805 -0.19210675180007303 -0.33586605591866719 -0.20785475096454589 -0.51792286756155104 -0.044757644587297772 0.13190578091961985 0.046198087508303655 0.07908106535137624 0.045397039467530459 -0.53752327549200385 0.18556898273922129 -0.2599047290981642 0.20814441110068388 -0.42263390769543058 0.0056871774571385448 -0.078544595933583816 -0.15727446460493774 -0.38545662007930581 0.029792916109175106 0.24337220057737405 0.10098912193844203 -0.45712254234902727 0.22587469872520635 0.019408960570559412 0.2719299979970754 0.14683078536065802 -0.35672237418620445 -0.29926312089402024 0.22162049435570103 -0.18661601410182449 -0.089112575532951072 -0.19849496771126862 -0.31461459437874051 -0.3681864437399035 0.21863352533914418 -0.046749259149200174 0.016151965732928594;0.27446017672641237 0.72072714200856247 -0.1421517070738432 0.45036117321033992 -0.44184542013904449 0.10452849856480903 -0.41208662934459905 0.42112652491047542 -0.0087418130452829781 0.75790839839537705 0.27371901007807425 0.26316790645632626 -0.096180062954689324 -0.24749948644872827 0.003918070303972095 0.084840716775227809 0.22864246333333624 -0.091048574483507311 0.12333979363239948 0.16867228647059182 0.48384175572403804 -0.32578398634264932 0.25810328538621191 -0.10296874348232736 0.13756927855081189 -0.10156508053786738 0.28460880582244402 -0.71447521935019753 0.064282352685064978 -0.34331957738838537 0.24651521621897327 -0.52185945930475353 0.40142194072994969 -0.15596309984259971 -0.42903776680263767 -0.29610740681717784 -0.14521536635828711 -0.31101660195302561 0.20989799623486893 -0.11885913501778203 0.14764290860180904 -0.19471620914886265 0.18338026450453884 -0.38028236357095335 0.42440817360616362 0.4034317550198806 -0.11585305325855227 -0.081070093123013276 -0.049333804401841784 -0.25259203727010077 0.22343360592568864 0.27218866098531397 -0.0067448294994839194 -0.16355414012382113 0.075776361061661843 0.2657712900555132 0.54385943272391479 -0.079612775549281478 -0.069882493508492557 -0.13493257513261267;0.0022597719920410889 0.41938894639919455 -0.60056100401012513 0.10239902223233634 0.53067069546111112 0.61484348178681458 0.070440141997899497 0.084242807114225854 -0.62038995528567908 0.0041676696326969388 0.74829507059895639 -0.17727873568886207 -0.21100199334738731 0.28556494424645879 -0.40763253702610708 0.12942297912418776 0.47944404372624805 0.38072265390678484 -0.084365842155976423 -0.28817659882227353 -0.60685385779792889 -0.12225607745137254 0.058029680078735442 0.44491541985726235 0.029423500919340293 0.3086445278933031 -1.0495553538984217 0.030355597285358384 -0.43092002952434266 0.28031905639401405 -0.095742414498815653 0.36961900010030024 -0.95189517330425133 -0.45036470662733602 -0.34136540196648657 0.10864104795414245 0.034249798521505059 0.44379005907319174 -0.73706697657886833 -0.1287730286570852 -1.1857068810080091 0.09589852955355091 -0.079617314969313971 0.800147796288881 -0.65186038087365439 -0.10576998215896012 -0.7419705136240764 -0.23335928927188265 0.0081160210691839513 0.30464351930368588 -0.48471857302739368 0.20055453079206692 -0.35604988747882688 -0.0055392208969006276 0.3300996203743814 0.4512148834647835 -0.65652215259967173 -0.23175473148696552 -0.25511324055129553 -0.0057785748905394962;-0.59161026393205762 0.10327348872736346 -0.29515761089613396 -0.31207789809881675 0.64294331851851294 0.35248751839370634 0.034373027480265279 0.11604344322549208 -0.54755637817581593 -0.81160221395422982 1.6363463588771912 0.2233694475673195 0.39106635146451157 -0.10066118641557292 -0.0060635932871827541 -1.0715134743376551 1.0805229342356826 -0.11652319869988435 0.31048097279672904 -0.2130568139782007 0.4323541975603703 -0.95780689692827736 -0.067745752452763416 -0.38515901211315351 0.24569560205222488 0.08631648456949409 0.61852976582639074 0.055382207927689102 -0.79832246988572964 0.060099573433033564 -0.16686144092651164 -0.095362031606645872 0.19270177363852167 0.39458371025766165 -1.0985708005049197 0.014522067781595241 0.39559855698356483 -0.086338768537400357 0.089637335684112765 0.53816315972711048 -1.2200948005462662 0.47364194541891386 -0.22496598891828612 -0.11683488669695644 0.18049713241970633 0.71992707530108335 -0.8013445666667387 0.43924388397954772 -0.066182049867080858 -0.59129196015220353 0.62231680180312399 0.45091485715700041 -0.58767249214770478 0.6463695603486711 0.14131451736381245 -0.23828019528090449 0.26406974427558305 0.086549246171127941 -0.55388351207231423 0.029471908609678139;-0.38460728910083947 0.88370396925359895 0.18250385216452938 -0.11149612240754803 -0.77566620441359224 0.46580644523686743 -0.068870489744591118 0.68792592404263231 0.093303279913246662 -0.40750067518773175 -0.83425684084932261 -0.32764734848855748 -0.3248301423621513 0.00015204316977750546 0.038778369254867738 0.10357898265365498 -0.60919929279053542 0.11664494851330724 0.12088050361152934 -0.051398453957949709 -0.72975072175349764 -0.10917372930614749 -0.2064144921951529 -0.34722779225671718 0.035447865700163908 -0.23619701971693252 -0.24919669607471856 -0.43677616834766603 0.096502173524313825 -0.54125195777178614 0.03043628864901288 -0.12473653068942903 -0.36829878304547115 -0.23371130316613051 0.59162798155955509 -0.085483493251262907 -0.10096666216566909 0.15461404167386097 -0.5951021121621809 -0.11109513853553134 0.31321213098130812 -0.0040636255153207379 0.041175048290003312 -0.26401646699578957 -0.1307939905351885 0.34920387608148462 0.15914109444209018 0.01222592960950924 0.24807617941909851 -0.2639149726537513 -0.069004583032289638 0.14058655901711006 0.53331315494958009 -0.27266695989260226 0.058980052021156262 -0.52887166935241348 -0.38129785737941313 0.23257502979307473 0.21966479748962051 0.20155197310589862;-0.21151468825106165 0.33022789675227715 0.21923221228650341 -0.7883775530367727 -0.15140958279339065 0.36091783488943008 -0.44395450358727068 0.49875128641559463 0.29783538042841551 -0.59915842943532505 -0.23755133471530135 0.05115963247004645 0.15298737378785401 0.13855625955580306 -0.42591154290071004 -1.0357516452343083 0.030616749842971427 -0.21205512777858443 0.027970032575239036 -0.48988706032837648 -0.7761293877649349 -1.0360386842078817 -0.43757163622708933 -0.48299123965039092 -0.019900924392275175 -0.3520912480641557 -0.63269801320223429 -0.067377676614430296 -0.43523477168376973 -0.65913501731511726 -0.11283384511121571 0.076042223900001385 -0.63238749146116491 0.38228549355660252 -0.56966123142841374 -0.11400776493018375 0.11418987715362554 -0.092037339472789026 -0.45796435900011961 0.23965077852069933 -0.21510739515121538 0.22069089507628334 0.35612094527500826 -0.47746818976788635 -0.39394873550221327 1.0126623463058824 -0.12745007384684742 0.52614666261884013 0.10323080560278566 -0.51427820265529078 -0.1085734263599249 0.76857247404272022 -0.37539884314952532 -0.22581125933570395 0.021551978007563328 -0.49825138039871902 -0.54895609594686723 0.062975115192804493 -0.19897677348175241 0.14832021954648539;-0.12296263224421286 1.0148259972036107 0.021712176197794107 0.61823316218734536 -0.38109337138649108 -0.22626169039650371 -0.23548434773987478 0.43973804549078455 -0.49307831810366293 0.48308908395627037 -0.26845303791358133 -0.075925253241253876 -0.49111509751312737 0.22241513660259701 0.02855148997924601 -0.33302613425774891 -0.20951362001713797 -0.40107786523391631 -0.1802807079958561 -0.56879176880013216 0.23923999400652199 -0.13423054562007186 0.068739799021820036 -0.17412550755918565 0.03652268760135019 0.26617327124153345 0.5070177615489686 -0.3688509347626307 0.34529006862874201 -0.20580659004833818 0.19332498588289437 0.42920438918938431 0.10282017474965977 -1.3959602642533753 0.55080141959912299 -0.098134374467464758 0.035061200716250164 0.2427929471846707 0.36353023886896929 -0.81003837362807463 0.28862383239750677 -0.64936393739054865 0.043596397327439668 0.54447971497845793 0.13509793616018509 -0.60065713434869361 0.7006163656096932 -0.20775055187000779 0.19951742981740139 0.7002009650158505 0.39218095480915022 -0.57789280837788293 0.99751748358589831 -0.1131851796603895 0.25628311702186407 0.47507755635066518 0.62226915429502194 -0.1688322968338816 0.27664293135314671 0.081293996561380921;0.2128715211941769 -0.62831812898264439 -0.020580693782918706 0.27647640322361877 -0.068280426593775326 -0.016824312745112313 0.27651471987345916 -0.37478666212652789 -0.28394191825792614 0.15777695896037477 -0.25099080676920715 -0.19139706915287646 -0.093923836174306538 0.13879532891615246 -0.69550142438796081 0.26293537012424611 -0.48463594124700898 -0.0083197832804041954 -0.2809731222491666 0.062789038677413117 -1.0191172397894064 0.38353565601188661 0.19289561167089928 0.40799160882339131 -0.025311627427833196 -0.035780297894277432 -1.007852230204501 0.19673748230249896 -0.11725294257959638 0.5025530642517595 -0.26320606053248718 0.24931282734456975 -0.72526537750051434 0.25774851566899826 -0.032026888476489185 0.38712521663920124 -0.0079966119996088703 0.23628512442551058 -0.57130346250785513 -0.31526553604407931 0.19758830364929444 0.46829413229402322 -0.31995728254692551 0.43133480437689614 -0.5613449665594995 -0.050076882127752666 0.23448940607234023 -0.090858808203445898 0.16806873532985542 0.11369269897224425 -0.89947695260156035 -0.27749798360661632 -0.12119508921487847 -0.57968499074736679 -0.22531876413017426 0.073048858407240666 -0.53649497215253084 -0.27417680064157468 -0.067668954553518457 0.03246019516502819;0.25144942894339001 0.81377543071333047 -0.27048379658622707 0.57679800851124563 -0.20604760398479441 -0.221409665460684 -0.22972913604487682 0.31764776537899381 -0.30701313155657162 0.68150279740539987 0.49320660582028703 0.3601151422773442 -0.20864129305389018 -0.021082204635078101 0.71807533767558784 0.8182639866679311 0.0019834179381661159 0.55612693775464428 0.31655191007452893 0.05475549153247377 0.63952022394193642 0.34936740348666534 0.35873556991987471 0.53387692399492748 -0.1371423329484116 -0.25084342299552326 0.85397434581345677 -0.16265771941656126 -0.32230526276120014 0.5599591797744693 -0.16420990660043386 -0.61471798489574969 0.1834179548421544 -0.30158969531447027 -0.051475621813575713 -0.078065777881373186 -0.045321791698076097 -0.30395297375590785 0.52155448353400746 -0.54853287615796775 0.15403113047776509 0.55601127404650807 -0.016271561519926935 0.10263024631218565 0.92485919714194809 -0.28818107929648795 -0.18890212505143497 0.22869985772483326 -0.13673270987604752 0.09287274611958736 0.53851751503107415 -0.18717200072692947 -0.17419555934817621 -0.012581240865301949 0.14730862678513848 -0.023158203071452131 0.29510070202417726 0.08425014040986567 0.10572245775127845 -0.15128227172734909;0.037950669698799441 0.27605006303468754 -0.73145936327213956 -0.50111778944280527 -0.26923741077627877 0.22768839754549328 -0.19211354120985072 -0.17894050499048711 -0.34166601063975865 -0.69562130056300531 -0.098629684077409518 0.15321061638312009 -0.10878621365250316 -0.49775865387894214 -0.21182130099604071 -0.78272070970123864 -0.47491875192531724 -0.074570406218853344 0.24538981383803901 -0.61294602953665189 0.27075592150131605 -0.47253556382801803 -0.11966171600768048 -0.65674378610032036 -0.073351166832426415 -0.41746643145249074 0.49546857169475345 0.21271312141673465 0.1561049035005222 0.09467417255257804 -0.12130175966155768 0.33266190656537598 0.6252547365832124 0.31086941148495256 0.74447404306715914 0.19801665118987732 -0.04435768579098482 -0.21643310684038122 0.11988151707083999 0.67090404356631617 0.40514401922744175 0.059334225771844759 -0.034251073519368805 -0.17266934738183337 0.11750925990485167 0.86024876621142299 0.29803625702368369 0.29493903434676605 0.29292123195510372 -0.042897782613287562 0.031441314706141338 0.15249132445397648 0.29553509987433707 -0.23031139945576165 -0.013242037959740339 -0.075453429402311131 0.046975821038997348 0.12531256914015018 -0.11571570804756896 0.026859130471560463;-0.039606076922691885 -0.1176702207732967 -1.1589962905166906 0.68502728174304428 -0.11520095426518118 -0.1882724027380038 0.13217062373463848 -0.037797153192334329 -1.0219383361445211 0.40543000496567183 0.61087079008158041 4.5035459806166793e-05 -0.19112923812946106 -0.81169030849032953 -0.27959393233077068 -0.071418932999335313 -0.075277543150018625 0.33772945631176637 -0.11934642672122753 -0.36927945833776282 -0.31295940086074553 -0.19209759592736297 0.10840327133440486 0.24183068889759829 -0.28061677455448308 0.10037464141428991 0.0085904053203098695 0.063806970923705714 -0.047067545902306829 0.13914089443134015 0.16719274663972328 0.14380623503734211 -0.098726846691870776 0.14349414353677087 0.11741418802948364 0.18323376452892168 -0.13542934733520143 0.18912259516121133 0.19028950358074057 0.30607700282143951 0.14267358671432689 0.30318493866821267 -0.051901744016244172 0.5985016364691349 -0.019287647552598087 0.407596226937882 0.019175642910987983 -0.22368005025408746 0.34891633338560391 0.41804265626832743 0.27499452129872781 -0.38553036795718265 -0.16098595949544237 -0.034731216205637218 -0.07602137576016739 0.46935431397391236 0.24162283648559041 -0.39246055332218965 0.19523356276053022 0.20917091222832734;0.054799906860833671 -0.48364176821158167 0.053812509485602407 0.12725762935370805 -0.027014792908820744 0.22555080659308108 -0.2246981805575079 -0.42366815009941128 -0.041132521917322355 0.19452591542330552 0.24060457094079454 0.32780286513224971 0.16848237472980263 -0.48780431562296706 -0.25563760877262132 0.27355500197915594 0.039209007363096599 -0.35800485316358072 0.092317368257079938 -0.40607644589018532 -0.35860821809107257 0.26786807671161961 -0.10671822285484088 0.042725696659469146 -0.13528182401095701 0.36596927835530763 0.020372322866811451 -0.16926031999069174 0.26562833974727823 -0.30335879909499314 0.046211993907250941 0.064851531855767572 -0.22976020294318195 0.10061554722040486 -0.18129076580333062 0.16352466650290121 -0.14523716575373324 0.58013089276215246 0.10882916876555444 -0.047061104466619728 0.17056195749941547 0.16091956203087726 -0.15972740050739997 0.76962555316369552 -0.33176860614973536 -0.12007489967031462 -0.32137045072788545 -0.034002609813710519 -0.15504088550738396 0.46391798633469028 -0.11370103287077338 0.016448032250572085 0.21913643868471244 0.065716631598691413 0.01473351423479136 0.41893051049194624 -0.19194555984548159 0.1123214163837136 -0.091844845060097657 -0.19806586683077862;0.057091103268042585 -0.86174287991683607 0.21384618270520206 -0.69122285668594308 0.13841316706974049 -0.22263113234361112 0.14210927883375912 -0.28427514164168988 0.35178250821826229 -1.156894988666505 -1.4809572866354312 -0.41945059349787345 0.15534852945661443 -0.45991963651077999 -0.06141803459391313 -0.93908457077848284 -0.80843715764245772 -0.83258798905201792 -0.16492483958885124 0.065754528878769702 0.29011648179826427 -0.91832582674989416 -0.28084445885093912 -0.97443678204459494 0.18024793864669156 0.25115402999679809 0.058198197683752881 0.26764303366484249 0.94937382947905458 -0.53202205108592127 -0.15718237375269536 0.16378631713850167 0.20330332855539399 0.60673305738388472 0.6649178543852049 -0.13671976125169744 -0.3578015351099616 0.40058125210605283 0.1003744567905506 0.70411780967292104 0.67037064889876108 -0.45281656611461613 0.5050847646652703 0.087218523604982806 -0.25725410813178279 0.68166926145806173 0.86882951431915556 -0.6154900790333635 0.041967289114966638 0.20413046553250877 0.069888070220277473 0.12707411036821475 0.55908653109569595 0.46641748549413975 -0.087407415411700787 0.17859261369616597 -0.082114052086837433 0.071356975937947723 0.4489614334939328 0.13472926021294745;0.14783915833340025 0.66345843555790451 -0.29857762580585639 0.71954410794035784 -0.20670560119462517 0.18926452520221601 -0.40888622220646331 0.66875528767169024 -0.084552358077256876 0.11448941069635536 0.73117073179412373 0.53866031909536871 0.092936782714647642 -0.05266259847793537 0.016538763029602378 0.35543744331864496 -0.15487063067323259 0.64353080505959803 -0.13215145941799517 -0.11479156090909534 -0.35576704150027499 0.22451526800390351 -0.17636296265360576 0.79972206467845075 0.17784225001954723 -0.14021337976143419 -0.49638966025617881 0.24639487568229204 -0.4264205986363897 0.14781174151587401 0.10266237319823063 -0.1080932656256406 -0.27245927740976417 -0.078913071167322948 -0.56504490328186607 0.1500016137246491 0.14091318922281934 -0.17841782056298225 -0.77694186577906454 -0.20320095264952401 -0.62272499219117061 0.097877882028810079 -0.18901404776687578 -0.028232565008384787 -0.24237943620761368 0.21311020460185093 -0.10168716588042584 0.10541221175049013 -0.16113827110212636 0.089847417355927675 -0.65692194103905743 0.35132909107388199 -0.11130767300799084 -0.36064521231727287 0.0059339880528821998 -0.1690859397848252 -0.068089566825862022 0.027556592883913211 -0.14072232587553454 0.083443254078094692;-0.27758396547697617 0.2170991141349532 -0.91411817498810488 0.044124763714315313 0.12309297697685159 0.22033569492274371 -0.10763493950046353 0.098919700786886625 -1.2316760100829061 0.10357649409042986 0.6853856344393755 -0.048246180709842615 0.10882313883498361 -0.15515056972366176 -0.040921609104113424 -0.60252234581613207 -0.056018934112242944 0.071759348656699154 -0.33612874871121279 -0.32774912487694713 0.11649076127311313 -0.41891317015696372 0.048021254478506949 0.12560105812022485 0.13662764606990838 -0.16823190048014602 0.70522256193279997 0.23815019058108722 0.03876027357153318 -0.32189801364537973 0.28751937826948698 0.16826169761501431 0.387010842967139 -0.19803967877557416 -0.1381809517914549 -0.34779651843467091 -0.19535847511842144 0.75641393392896517 0.54828586036622251 -0.36737155241356012 -0.21861333520774678 0.13209752766546379 -0.082197365573547412 0.53775460528963048 0.57497950963463307 0.032758535339071068 0.00045926328305305724 0.03322316417107013 -0.14474072664318322 0.90445709327965318 0.32830377856550563 -0.18023605430344747 0.30900273900796976 -0.037870515848482389 0.30549761043054457 0.90897280539995107 0.60839337185365538 -0.17462740169148114 -0.2441032072001619 -0.15111150339291687];

% Layer 2
b2 = [-1.0210994555713762;0.43318845507731901;-0.097650672700697216;0.40176490176319313;-0.087903675979273149;0.50953866935192049;0.85342340242943227];
LW2_1 = [0.13927986956329616 -0.33840108811988301 -2.2308716202797241 -2.2205194191105506 1.963404446730693 0.96204412567582964 -0.28447187337362656 1.273037552809549 1.9503577217758836 -0.089493493606560989 1.3046269895230134 -0.69666117488780588 0.46446220613480849 -1.5805406006186513 1.6987742621040316 1.2763923388834859 0.33316816246395714 1.2682763197409765 0.41336726605445251 0.74110786871951206;-0.51109586559034825 2.1211563265259437 0.22090302919321247 0.80906816740880338 1.0145083771261327 0.74822027881209219 0.81745739146823804 1.3270892236694427 -1.8191765742260579 0.43506977558142002 -1.6800573372918914 3.1522481763861969 0.30481487898630155 1.2137616967577141 -0.75616392481869887 1.2135243217827709 -0.33205037375350799 -2.8066490040737526 1.2291634821452857 0.84669489220302629;0.34499866785771371 0.30252080530512726 1.1048660474715655 1.0488199534687244 -1.6233075633550795 -0.61235565886187604 -0.67850004476111148 -2.3559682519087231 -2.2004908915455799 0.009792960160471471 -1.6724952037906353 -0.22278603301296829 0.98879199633337989 0.25371266420510868 0.58975926219712416 -0.21125500523316398 0.33828958512512708 2.9106239685292441 -1.12105776023173 -1.2440256251702928;0.41920530173401505 -2.3644238603577903 0.54023164784392275 -1.6159819437484428 -0.51478740655183164 -0.55529432664572165 -0.31036588603554033 1.1364325925607552 2.0256355047433372 -1.7526203573799 -0.54723534329659596 -1.8943634726476257 0.75041007135819826 1.2565146013063808 -1.586554740509851 0.037310840476380419 0.87579428583386087 -2.1594462518296731 0.76246107761403237 -0.80271150826096005;0.54761561420168814 1.6265415593670169 0.92078133072203949 -1.5222738546154904 -0.16348750488508254 0.37493100758249487 1.8613776100391155 -0.93072413854307146 1.1769506274755117 1.5157573188899647 2.0648323108115543 -0.7234884005769262 -1.0672253595745154 1.5743361077785052 1.4945257203981699 -0.099346423454475224 -1.5479557989260249 -1.0082129819417993 0.7218807893762178 -0.62780041260623476;-0.24975194533627187 -1.1510651994686638 -0.71650264887957094 2.5230721160971679 2.2449099990757895 -0.30095749928377402 -0.24719452438202769 1.3291687233960447 -1.0845006793812839 1.3802220225168136 1.6461772046577101 0.75927230115116473 -0.022657378530019406 -2.0519305377573782 -1.0571161296003568 -1.6822577822440161 0.13092296925813432 0.87015050686375828 -0.20626089460260619 -2.1099579418442955;-0.76462990673506759 -0.58611012561759757 0.064018761394168816 -0.9127830557286678 -1.4096730794095049 -1.6023883240873871 0.89621741336978933 -1.6281742164890145 2.0189087650948538 -0.98197210107039401 -0.89980018729275013 2.4335821594952942 -2.6174439184459497 0.31322725628364617 0.24459544670017463 -0.43876728632526152 0.48753880565519536 0.44756850792052405 -1.6888675604933572 1.8983832232982221];

% Output 1
y1_step1.xrows = 9;
y1_step1.keep = [2 3 4 5 7 8 9];
y1_step1.remove = [1 6];
y1_step1.constants = [0;0];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = removeconstantrows_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Remove Constants Output Reverse-Processing Function
function x = removeconstantrows_reverse(y,settings)
Q = size(y,2);
x = nan(settings.xrows,Q,'like',y);
x(settings.keep,:) = y;
x(settings.remove,:) = repmat(settings.constants,1,Q);
end
