function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 25-Oct-2016 12:50:00.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx60 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx9 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;-84.8125;-179;-13.73;-15.62;-10.33;0;-84.3125;-179.3125;-17.67;-15.86;-17.23;0;-86;-179.9375;-25.58;-30.52;-35.66;0;-86.75;-179.375;-21.97;-25.86;-42.33;0;-87.625;-179.4375;-17.01;-23.64;-44.65;0;-89.5625;-179.875;-17.05;-25.72;-42.46;0;-87.9375;-178.875;-14.29;-28.91;-43.54;0;-88.6875;-178.6875;-13.09;-19.96;-35.77;0;-87.875;-179.6875;-10.51;-17.61;-25.88;0;-87.625;-178.1875;-5.94;-8.34;-18.4];
x1_step1.gain = [0.00555652022920646;0.0167890870933893;0.00558171986743415;0.0744601638123604;0.0655952771400459;0.0662251655629139;0.00555652022920646;0.0167890870933893;0.00558561703613196;0.043535045711798;0.0569313976658127;0.0413052457662123;0.00555652022920646;0.016268429079817;0.00557491289198606;0.0336530371866061;0.0390625;0.0303536196691455;0.00555652022920646;0.0154365653642065;0.00558464223385689;0.04;0.0404122044857547;0.0274687542919929;0.00555652022920646;0.0142729705619982;0.00557394182198223;0.0367647058823529;0.0364564345607;0.0259437021662991;0.00555652022920646;0.0128;0.00556424969570509;0.0337325012649688;0.0415282392026578;0.027311211252219;0.00555652022920646;0.0134964150147617;0.00557588430040077;0.0351246926589392;0.0355808574986657;0.0270160745643658;0.00555652022920646;0.0133779264214047;0.00557880055788006;0.0382409177820268;0.0459453250631748;0.0299625468164794;0.00555652022920646;0.0137575236457438;0.00557977332170881;0.0363438124659277;0.0485201358563804;0.0345901072293324;0.00555652022920646;0.0145520691223283;0.00558561703613196;0.0438692695766616;0.0906207521522429;0.0408496732026144];
x1_step1.ymin = -1;

% Layer 1
b1 = [-8.8312649647974659;-7.5184018071971481;-4.6789918867981211;-0.45004445067212201;-7.3418598833075635;0.95808887197716508;2.5327491461790643;-0.56692914389399562;0.53772969338667942;0.99390383555370854;-1.7457771095698986;0.96218620272287025;-3.3322832463116088;0.21410862988196538;-8.2831802027632708;1.4297394449992635;2.7965182407394473;1.594690335081143;2.0442836187892239;-2.0457616530311098];
IW1_1 = [0.0062445000701014932 0.9988465309566219 1.3360095833107353 -2.1393312739172066 -0.39630054891514921 0.89113265152742827 0.025515455490824096 -0.039508714404285092 2.1186813669568667 1.8816430520451475 2.7361396760605174 -2.1113243070654102 0.0027350682453528316 1.3485875355889436 0.16081320524916057 0.015009489980881944 1.7641878184476854 -1.5355068298070107 0.026973197743440473 0.51593130708021995 -2.0075393887572912 -1.4223283678985019 -1.4660966221111758 -0.97943077380780319 -0.092929582939872649 -0.60477375982640302 -0.73591038498790284 -1.7549398256275552 0.068749443436538452 0.27917527250178714 -0.081922228327362789 -0.33130359234928586 -0.88024726165647582 -2.7422887363081592 -0.9341144130604998 -1.0140625170913276 -0.10133224662743355 -1.3131122977593843 -0.73704659044094567 -3.0885618632264271 -1.0587783874735597 -1.9160305997733262 0.023347064310701549 -0.47076089446359642 -0.39962300497526299 -4.9527749537922867 -1.2121329947942121 -1.2310084751856682 0.33852578320768417 0.37998047222866205 1.3472622919803754 -3.3115764825440128 -1.7798165208177388 0.65306170259852392 -0.11110504620837296 -1.1552478403459616 0.82237874246545895 -2.3455788061727945 -0.85635091049287215 0.53987585682712047;0.20602015991324077 -0.28378777760530222 -3.1507357905958995 -1.0053495121088736 0.98740563143012128 0.61897302423967393 -0.24586286006714747 -3.1073291983367151 -0.36834181063476551 -5.2149378374012878 1.1787871422372826 -3.1911322501556931 0.025701498903709891 1.4473752243169187 -0.56066817435799898 0.86826666677014697 2.8196968214703357 -0.69034540710858217 -0.043965759364212265 2.3532171944208167 -0.71187437729555603 0.95220201008310268 2.6409237700869541 -4.9373843336479588 0.031674373973542821 -1.0049170565516465 3.605271297231829 0.43847493860621661 3.0924834709501265 1.0757679638067634 0.050785923436236412 0.8754733276801453 1.1925405239296176 -3.5238661714924473 -1.1373442023204885 -1.571111761742878 -0.020132101803799665 4.0834371890021863 -0.33101675191793439 -1.2332721216188509 -1.3714444013104494 -0.13462400522797716 -0.07103622573763195 4.6751477878387373 -1.7939298992627482 -2.5590218684513966 -1.8220313571439686 -2.0925927755720579 0.24703521898001879 3.4487225400280437 -0.16358914619903225 -2.9351545210578873 -2.8423633925490477 1.2596033718384632 -0.16921763715054305 0.020839866260308725 -1.1800146263510498 -0.56100488507223656 0.78640014128683544 1.238815789056479;-0.020472397692508904 1.3025242131245414 -3.7430653715672406 3.2313692312500368 -0.83937737150298264 2.4025871809602508 0.019781692628977738 0.078114167676383503 -1.37836706156349 0.86166048860346622 0.36869633097072679 3.6073183167796858 -0.062398966198980887 0.75771871967821636 -0.30586737473680076 -3.6126843104678676 -0.37916928649741288 2.0333681986991081 0.14834542407899157 -0.29475238664830117 -0.36127387064118222 -4.1254256655025605 0.90870060046483569 0.16590950226555182 0.020689942702136272 0.021509638149611727 2.1919404567571137 -2.4647172391061694 -0.47320145581420664 1.2815184847625152 -0.14441692646854876 0.70320649014606917 1.4429365387992075 1.1118686328923983 0.89042276286390176 -1.4778817967333147 0.047492634032783691 0.7199143513269185 0.80776008643541386 0.9780053026830503 1.6502152683639137 -0.94713605543713664 -0.0036994380122296043 0.41609445409060508 1.0345612157145512 -1.2473421114651237 0.85559366179244634 -2.374147385443151 -0.013051535376092549 0.22325439032321792 2.1622926918443914 -1.7250389587948343 0.33391481798587724 0.42285946919139711 0.022423126387626151 -2.5592677782377429 0.8587032311792876 -1.7292092847413039 -0.25778530577016545 -3.8507796070523366;-0.1497470942499545 -0.33243266134484484 -3.5385944434862036 -0.78822881162109226 -0.0080395967146870417 -0.21331588435679164 0.088228809943395173 -0.35632688790580425 -0.20711804048325369 -0.48346664937688844 -0.67367785594048946 -1.0000911336917657 0.095590561200879137 0.87857180366363408 -1.5713384817812559 -0.046040019657562055 -0.026760584697365974 -1.170850729558252 0.18846029302562861 1.875669545001065 -1.3034881788957469 -0.62908563199650425 1.4101044445354614 0.1734216487688231 0.076888611235844825 1.2798867362383157 0.97119655958128281 -0.53108147488554258 1.6965653008030515 0.8516474894227033 -0.18588093053972093 1.3267175687696762 -1.1055188432308694 -1.7539650210365676 -0.49311662968647452 -0.54326893558120326 -0.095978368444994189 1.7300667648363082 -0.63416021423110136 -1.3456933730182907 -0.22586285349584201 0.00052962482792769257 0.095306311904869656 1.241164055538668 -0.72399991427141763 -0.57568758731307923 -0.12908236792313976 0.34060649315476976 -0.042544136133246126 1.1283296792919684 -1.0974045307878544 -0.015911759025119088 0.12618961140246887 0.66131687260787864 0.036717738652102885 -0.010402335932154857 -0.65749425840117848 -0.13924804530490478 -1.1251139090083404 -0.61286529032795156;0.006380532071731105 1.8041760524386437 0.37441138299260412 5.8812380524010033 0.36073896453241527 -2.3924993064854605 -0.040272667252808814 1.0364050284937885 -0.38799212442883968 1.8796607563116079 -1.5457813034966275 -4.0386635749572015 0.066476842885060922 -2.1525296347958895 -1.5566609929788324 3.4775345460683083 -4.1759059970252554 -1.1761325756282337 0.011736045768431758 -2.3269195097171855 -1.895784631689533 0.52400458823918084 -1.4358516229070659 -1.0703640383410191 -0.0027435980602638702 -2.5790072731266149 1.4764308346451793 -0.68253519473299618 -0.064693078436165535 -0.68605839865163754 -0.013174579766967546 -0.44592175404725259 0.11968928355430948 -1.0018497278325069 2.0756412161992208 2.0172754371021511 -0.029574576350530509 -0.40756161036750099 0.35732857902978765 -3.265052877566855 1.8788728697006669 1.8062523024337713 -0.23834056185786304 0.1020036716369257 0.053075303104107519 -4.7114571602026052 3.1825395339231157 1.3848846930046184 0.12331914466571825 0.052755849895716293 -0.18222635520707597 -3.1581781385258907 -0.031991309224290665 0.81652982829988019 0.10406092259724908 0.50001030710873384 -0.58333377913116513 -3.0737875763827534 -0.25318350286828589 3.3103422102156004;-0.0080262872629077789 -0.42774596025250572 0.64591196004384965 0.26830862427565566 -3.9066568563702253 -1.8632981338723218 0.045224111168913152 -0.022785518428766242 0.39439689247508325 -2.0919281589261511 -2.4645139522090744 -0.38736175694710512 0.11230228264668696 -0.56836375459043031 -0.035760153526115286 -0.80318148567229297 0.20451414681123084 0.66104412308947358 0.021187511006234953 -0.88272009325448408 -0.70937358863933275 -0.99079800330718448 7.0055096025907435 0.72776842746601889 -0.043661603442870435 -0.31545510807084703 0.25338802150715439 0.035173343794499629 3.4407183732749167 0.33020371731213449 0.08210894754033235 0.050054303102387787 0.4693334037358331 -0.17864815227290654 -0.2390214145976389 0.40295441891811551 -0.32925275037330287 0.22149280338364233 0.46975490948927739 0.51864168558730406 -1.482487266349793 -0.18884234351055171 -0.30669613124443534 0.35820032656869316 0.48894824189005887 -1.5151956734805248 -1.018358030445639 0.094931092331871858 0.216551906941889 -0.051628476361150998 0.30669007420456118 -0.75131065207550329 0.75883774503848711 -0.062620840571892503 0.13372995281926159 -0.41512439961701908 0.31622751625229184 0.20703378833066194 0.48857502761750787 -0.38803563554889486;0.14250430716341195 1.3010061547444396 -2.101814483841534 0.31599577057139383 -0.1244547388429751 1.1575223197312501 -0.056136883951367872 3.2513887797284458 0.57733218261369101 1.8843691993916467 -1.0532538729998615 -0.51398513752070785 0.14766054600275566 3.9908443183529401 0.4892290789037127 -0.25133856462187054 -0.43802859951047562 -1.2978942092636438 -0.053064385958759924 -0.55539315379068366 -0.028016776772089452 0.97262448386545142 -4.5137729284889136 -0.99180086923899557 -0.046344524871416826 -1.0942516016022736 1.684682264338407 1.9294495556917746 -1.1219191019466208 -1.9909366471363437 0.24753073415872551 -2.5610763307405344 -1.7020287226510298 2.5554893710369022 0.37209764622775165 -2.7343795888986349 -0.16310737583551224 -0.91690058815979203 -1.6632206553999871 0.71366340952332574 -2.4974681681035635 -1.6325474637612232 -0.40415497276757339 -0.42049334202050204 -0.17761883936686071 1.2977802226257193 -2.7933546089301595 -0.4069002172602198 0.21760176279726057 -0.18878859564528194 0.67181226570997365 0.8548816296461349 -1.688172450463779 -0.25422563556223926 -0.032233600304847891 -1.3217471315621168 2.0089906521096164 0.94587569150324136 -1.9478900887569803 -2.5252970511361967;-0.23654043474101158 1.3197279502900079 -1.3766276584911301 0.69788767701710963 2.338184848031176 -1.0323980739894907 0.28167769976518536 0.38158437111162175 -1.3244417234690458 -1.2655909150961921 2.2721456779800095 -3.8519073429086195 0.0019088358847105821 0.54040739706705576 -1.6831234979092735 -3.1059972032492049 1.5903264695898367 0.38769806891606134 -0.10187459221795678 -0.45063350566087101 -2.3029322321013401 -4.4990827092322689 -0.0090965861450626653 -0.54305814117128859 0.015706860609312413 -1.2721380303005569 -0.92509700693649433 -0.89012634070111663 -0.38323680994424808 -0.1779048571208412 -0.014317771003264269 0.30698525320417624 -0.3319224961183867 -1.1415933719166764 -1.2955129348266152 -0.80755160694561035 -0.0093555635698135929 0.80035817313140789 0.84864383037617819 0.56197267167158593 -3.1424115394852907 0.55281703485037681 -0.037571853928803474 -0.092121313784893161 1.860385520997029 1.5402936083505487 -3.1574818667950479 -0.46962892453168886 -0.038488772228142634 -1.1916733800841233 2.4770179244055468 2.0475270308322147 -0.60543134430679613 0.46023128382251555 0.13896961726416077 -0.83161281826747713 2.2690531265456197 -0.13163619199085522 -0.51820384255376362 2.6976934684159848;0.12841217487687781 -3.2887544995404183 3.5801185131678959 -4.8386895422565104 0.16426623248879632 1.8292634516197517 -0.04500032011009987 -1.8644100918848163 0.47975238410479759 -2.5577335287040968 -0.85536721900141155 3.3932339139729142 0.023456412892365039 -2.827536354134395 0.85998974490747604 -1.5494337081459943 1.4943409746702008 3.4005388049102794 -0.06205283497017796 0.54099682729071585 0.61656660962234511 -6.8832391588087125 1.7354234812076614 4.1117595160128602 -0.013445797442441029 2.7354515739628211 1.1884549275592224 -1.9485676137626597 1.4232976107854174 3.0620163743036177 -0.027394977670649287 1.5001771190131943 2.9895974784164272 0.87492904951796713 3.4828323518420441 -1.4065634552845017 -0.00067246880490803417 0.47470292137793746 1.3673419489534597 -0.37623829633891548 1.8639617747548538 -1.1291011586795998 -0.33848944725677627 0.9240830335956538 -0.47993265098109072 1.2628553144072414 0.16529807000735267 -1.2305063986058955 -0.3132140348315946 0.13174012613745872 -1.2680111986746354 2.1633566854001205 -2.6636782538029218 -0.38877479324986824 0.61457299248361241 2.1821460808222279 -3.5846720217186148 -1.5913221120404681 -0.36857413157910873 -0.31602118226909975;0.24049127698711403 1.8905371662340769 -5.1435984445084655 -0.5914855098638726 0.78121713497756429 -0.75320119116428341 -0.048907333027519082 0.62144124845198789 -2.1957042359996186 1.0061011042803907 3.5242525852368298 -5.2683637122023708 -0.0029794185949856868 -1.2286866308410642 -0.52668231717015312 0.5711681374855313 0.94985319587198591 -3.1463774771110744 -0.014946266038057173 -1.2701879791443882 1.0792831303540165 1.9900778108071346 2.1218873991438745 -1.4222116086911263 -0.088918902504679528 -0.24023088465368569 1.1741554740660798 1.7000455955739417 -0.95100433986583988 -0.48794939742724791 0.18866849620069978 -0.021429249705837976 1.4472012013230333 2.7843867078518398 -2.7554710387241017 1.0223169799685294 -0.15900963795953829 0.33156037351003048 2.1433124048623715 2.2048959475654879 -2.9321991292214609 1.3560260100634043 -0.1215468369787021 0.0045183426990013549 2.1817778235676761 2.7157945107243822 -2.2767830463042342 1.771444903578379 0.04895534409021212 0.39204856526390558 3.1637586544298308 1.7773982065478537 -3.0283682483511631 0.3221577461639718 -0.0060215595741198724 3.0011276286965778 2.1031777355886532 -0.32154370141169186 -3.1722061921717382 2.2004398781161285;0.047775859889389066 -1.7534183038811668 -0.14098761728758652 0.31542854541171539 1.5572285284083296 1.787153740162448 0.01811519119989647 -2.1900091272543354 -0.49884290886507671 0.11122459629703953 3.3082834279212321 1.5095261373050175 0.0059285205761174251 0.55465067063491014 -0.058174287055443495 -1.65553917215708 1.8837353224642004 1.3410245405019543 -0.034901355892159119 1.3588752745373216 1.132179482008083 0.38707208018261308 1.597062731849183 0.69047349273752512 -0.083944210011071815 -1.5346175935355559 -0.86742554700602381 -1.2452192766069698 0.52787295151856417 -1.17975328493017 0.068419109512771165 -0.42448103091804218 -0.81059855492877175 0.10677130600065335 -2.0648823997953745 -0.23511365397930736 -0.09761076992040682 1.0858285479503937 -0.86725419225295575 -0.16746750407402106 -2.427201573482229 0.2658294995797244 0.08914183668362867 0.39566399442242994 -1.2371741114589492 0.022955839892709835 -1.5437586717902065 -1.5054232364030613 0.018164118818808098 -0.80985181682520269 -0.55269828092720874 -1.4097574974931888 -2.2129743802453614 1.1698398980415214 -0.029107687279756451 -1.2941751349126069 -0.87870121134001111 -2.7929873561605087 -2.9885885519700675 0.94140860599574105;0.018650564155586118 -3.7346936101459529 1.6119604094579427 -1.1664951743914267 -0.99993458607636487 -2.5684602922047985 0.023055705280132878 -3.3631104796628968 2.0449706192743258 -0.5834775099272197 0.66822579414451566 -2.8408417287899064 0.034675427083374323 -1.9880033067530569 0.72755813883031129 -0.14682255562982663 0.50277647685184046 -1.6680111513689879 0.05370773350698213 0.81949806512459289 1.3361986703966575 -2.656052641526689 1.6402310892753809 0.21299489292625054 0.15116204044993231 0.57881518520938735 2.4931591917849558 -1.6353263639832918 -0.77958518914892261 -0.25413402954997105 -0.027951257826828602 0.22905007259022062 -0.95233819212078075 -1.087186134535022 0.63043825793084596 -0.73592067145422024 -0.084642652523304163 0.38471036230700267 0.058855104555964481 -1.8604959692457386 -1.4098263225475818 0.63530684053433528 -0.051944689120239619 0.90669894999097056 0.097051556986789203 -1.8917732083223204 0.33084069912046071 -1.6043082589899293 -0.14030914349997337 0.99290826980552938 0.85045054848916168 -0.17700365655284689 0.64067302587186914 -0.89111772968796354 0.073711803201981077 1.8351932767130894 0.75848662047591997 0.21104996069710524 0.015988324338870527 1.0403197045552441;-0.18112296841614303 2.0485218337193536 -4.3381689593051842 1.2590953805104861 1.4017515079852572 2.0411564940833125 0.15031737680936569 0.6898341230131998 -2.5787570269537419 5.6081199551453436 -0.59072662884698168 1.1110564856612337 -0.057201853652356652 -0.52452958006230543 -1.3788635361176298 1.6963384213253299 -1.9361200207592935 -0.59305240439383722 0.17391354047787777 -0.48165822840749228 0.68891093834734418 3.0222500567514112 -0.91151451002735417 -2.0019243744218942 -0.28304168473922386 -0.22934426836958294 2.2497517814945089 0.22217737874245566 0.099172449351642267 0.42519947299750938 0.25906518849812543 -0.0072239856848618699 2.8767223862054783 1.3580559673591364 0.3047189891116156 -0.2220128690993606 0.24074292485731874 -1.5322534430921471 2.2460602985030342 -2.1163916678319401 0.060183293421431777 -2.0801477645207944 -0.28578053647066076 -1.3385836345219508 1.5932183276458187 -2.6281097691266524 -0.082977185585360727 -0.71800188173101231 -0.38501185024474593 -1.0009992783553057 1.2352480810118067 -2.3530101077977474 -0.95827859736539844 0.69270937961108603 0.30129016973378536 -2.2224667711901271 0.94808318464388164 -3.2761027886899043 -1.4232251668792861 -1.0166662859743232;-0.03810172046365945 1.0473263622416684 0.95425596138428015 0.99709538483858262 -2.7469646377978787 -1.796228959346382 0.11772359240037099 1.1787851428518668 -1.3367722174523655 2.5824113009395977 -1.4325598219604143 -2.4773681178234641 0.0091084184197911498 -0.048577565927443611 -2.5142743194620092 0.50478545729375834 -1.4163673025532608 -2.2330795310263634 0.059766780786692494 -0.18135396682355412 -0.47284503574376674 -0.0078376932224712911 -0.48134067021367899 -0.74372419206916585 -0.025581269836843213 -0.43523965977610174 1.6716779336917018 0.12321588339800543 -0.14545487149417283 0.17631097011350233 -0.27497886213608796 -0.72007527366105506 -0.28521931458790517 0.48486378591683954 0.29393192896379294 0.13804488318598579 0.15984684812879335 0.52400699097939807 -0.30499702016935071 0.484319924380197 0.18811782097892574 1.3018626703418315 -0.078251216813665703 1.2769099461013376 -0.11574509623678708 0.8832643716519929 1.6181366563132824 1.0929088873020958 -0.1966357809395429 1.0824164350334498 -0.52053475119811066 0.57372515902503318 2.4969906771766306 -0.11991467610728165 0.096352020483183656 0.65412507036326561 0.32330492549614043 0.97382234394036826 1.4771637253904171 0.34441933486338028;-0.085140875261635857 -0.87516825468022752 1.7529603322128586 5.8278642346609164 -0.78029119863667029 -0.95530040584427711 0.13161287809036948 -0.4923342017338212 2.0718349186171392 5.9109427261163212 1.0443337029990165 0.25471401072583794 -0.050787630858475333 2.0538193000095304 -0.053155129051301403 0.99923939011724627 0.45887211593907945 2.003395214848561 -0.064551229535892152 2.9281935463735649 -0.087167632046081162 2.1893531851427142 1.9894933973977413 1.9502209448512473 0.31230527044287076 -0.91475959462642509 -0.8711830830047429 0.98685118061656152 0.066658463401436122 1.4157810355306268 -0.24629966241177342 -0.69598423650998809 -1.3037353568303778 -1.2535454524928042 0.57868643933475872 -0.91915440411630633 -0.014614272632909132 1.2766883278815611 -0.94488317564825974 -5.4390965210759008 -0.28430534334316471 -0.95665024837508261 0.074766929371850435 0.36679486480584284 -0.69739655630474617 -3.0986244579458466 -1.096200822832472 -1.0058585538404834 -0.4417494479372267 -0.92702106449410782 -0.82389577891810173 -4.1595422819405385 -0.64096969655892277 1.0188420365443076 0.33589905003142739 -2.0224592370844965 -1.3010223092609901 -3.0181940295750285 -0.49938031168313085 0.37143424347868215;0.12158471181055698 -1.0635524830322061 4.6994918240905577 0.43566959748351008 -4.0861350892492849 -1.0793660044287463 -0.20293686943925193 0.31696560149475045 2.8983037513018672 0.11700266093723379 -2.4144175758255262 -1.05177596669221 -0.030669114762765116 0.70918032428078404 0.12457852637809137 1.3961729252897905 -1.2733150464185612 0.018446869901992513 0.1222799691247972 -0.069890589035598263 -1.8568490643985325 0.82902499256095141 2.071361363019808 -0.24319051487581531 0.26980682512861098 -0.13877713007696874 -1.8322425593632821 0.82004485224282675 2.0552693784286045 -0.83516242071742042 0.39390704023384615 -0.74625026677837691 -1.4605488312525972 1.5099047729128361 0.45236491162018999 -0.88100325774512889 -0.49539572507037472 -0.62765207135149614 -2.0845620125984969 1.0095958228684541 1.7248682226920697 -0.19571714629744505 0.053556494709930964 -1.0434557494417209 -1.9920837235946844 0.62012242486481906 1.4377369446232926 -0.66623264338319088 0.029840196335706833 -0.93970001523137381 -1.3597116087777381 0.62655073714400933 0.50907716509020984 -0.73736473340393427 -0.21753790529533817 -0.59628839274574619 -1.1356777246371648 0.76304483804677703 0.59222833654349039 -0.73387409310513474;-0.062136163746679324 0.19707600261925445 3.0742060983571902 1.9508517285750222 -0.082956469243355882 -1.2562535676841684 -0.19099915678913248 0.21715842764378498 2.4132085995732573 -2.1746690314539334 -0.0040850428296567249 -4.9814972332883549 0.10482147753250447 -0.15628791693584132 0.59851982195771547 1.4725663962381192 -0.14722909582679658 -3.4605717034926204 0.0018934441822662687 -0.50399884702738318 -0.94973915138851916 0.50006420718917632 0.070953978116182884 -0.37650766155047627 -0.082808817748525693 -0.40184423312509915 -1.8316209758689237 1.1021623454561851 1.0902484045187368 0.030522950026014097 -0.28008751984207569 -0.71824485786179681 -1.3407402419947974 2.344468637540873 -0.28886649443302609 1.3677248977792593 0.10141548953706336 -0.21218875692225209 -1.2242993916502902 3.0988426810627474 0.35267136081201272 1.9253808717507426 -0.0082681758000356619 0.08127191971109704 -1.7927315038041542 2.8339951558560217 1.5552289553898293 1.9884465211899276 -0.019546521416423879 -0.270539399216295 -1.7740344958140402 1.7704353057473343 -0.46687295010166269 0.55407585021309169 0.45926231364920367 0.0026564083417518047 -2.2861326129994373 0.52338878942588662 0.039221860157751427 0.1028171191202812;0.63085721016738727 1.4388781735456584 -0.73232218296063645 0.13031465322086366 0.5109634865563597 -0.73942806083231849 0.1479390924235652 1.2470921098581269 -0.26718858367465997 0.057086360196932202 -0.05198303531569376 -0.049005031770919201 -0.05694221630156289 1.0084030242855557 -0.49168038055754032 0.3003539680810437 0.36089580149614542 0.10131185182015658 -0.12987443060331158 0.59007238259528627 -0.24465216084138011 0.088332687672423096 -0.19070635673934136 -0.10191401354391226 0.17051036996002503 0.70932871701864431 -0.48415828198432748 -0.73620575166855307 0.20235773511741462 0.033775368718881107 0.25885050088469569 0.313020359837617 -0.14883003404429662 -0.94679909348077951 -0.00971793444812598 0.32637087142662374 -0.043150234809534109 0.38575531296788557 -0.3900886897092149 -1.3931040621184785 -0.21227023329378222 0.4647754871719087 -0.15525795138995335 0.32902247672575297 0.12696946281507568 -0.90480207958985959 0.025422448534619398 0.33197913319732891 -0.11272050400939272 0.38467558493919418 0.6147391218407332 -0.5208453540340553 -0.45599606247087776 -0.055802195247989322 -0.86428870901150123 0.2096662934812997 -0.53284250245150999 -0.17768291641228623 -0.62765298636948486 -0.030145370585262756;0.024970205701295017 1.3947064180481092 -2.2934061073402989 5.2486876351498957 -0.68211323996322482 -1.0122782151532654 -0.24329006836763117 2.0616741006397459 -0.9163371048379052 3.9199358008178353 0.64976871391881674 -0.10842348110238959 0.10739339064051924 0.053685369907584518 0.93411740933604259 -0.0021876150408589069 -0.85051951003994464 -1.2962448404762881 0.035639081164621285 -0.7846186809484742 1.5306247099576245 0.030340681636304021 1.2589192344981082 -1.6285630340835826 -0.15535761209608109 0.25613980963061789 1.698229254791255 1.326882783007487 0.42046738793015909 0.3072264701837209 0.027502296998899008 0.57040261667730219 1.1918116600267328 1.0216451120265739 0.095871681663105807 0.083522727859979523 0.053468512021671175 -0.23123523870801396 1.3862249818476335 -0.0013713821001809122 0.23256407238872923 1.1147508340629957 0.047952250546059005 -1.4157035543570939 1.3658816260375395 0.078817410155224366 0.58236463025229446 -0.22019765208682915 -0.0030081329082854119 -1.6570032743340508 0.77750128334644364 0.17031991887509429 1.302065425921241 -0.52366798691157268 0.074323878333951765 -2.4569420342252255 1.2590843633459328 -0.66417428283889812 -1.0761667957858285 -1.1679560899597561;0.04984903851867379 -1.0884091381078449 4.1324737475140161 -4.9996152776216745 -1.771369739204643 -0.36528677435716678 0.018227547034349385 -0.31089321797759567 2.7636976554685333 -2.8122001783663264 -1.0537421217599958 -1.6966884597154539 0.15019310606779729 0.047051758909121805 -0.016578758312246894 -1.4145806261457139 0.70347331515644307 -0.36550518637025359 0.041368501111918039 -0.0095972578418522646 -1.2197939817710091 -2.1966737070402895 0.20078442665305168 -0.32339650761742261 -0.24096133700154646 -0.59427045714311622 -1.0462291902754124 -0.65927351087939456 0.24714730399336673 -0.46460903790193214 0.042802951977441162 -0.25706593551253565 -1.4332163032448006 0.74556145747183755 0.50762433597572865 0.86877978625295926 -0.11742041600621846 0.27022416402262783 -1.1870518289239356 0.49968832811802538 -0.21199842189143273 0.72097877394609244 0.068731409157609585 0.45420570727919563 -1.1373770170575566 0.47749637340839896 0.77912791083604849 0.48633365517384725 -0.23853449024953496 0.48718126079086155 -0.44479928176058109 0.17367226646202152 -0.22107101974414986 0.26788276037100761 0.091572569439229604 0.50897826514224653 -1.7135920189155192 -0.0070089834728364634 0.18948093261602894 0.15953117296125002];

% Layer 2
b2 = [-1.8958201553474876;1.0157506216847072;-4.5997036650511793;-0.86055477012674597;-0.93248033157119903;6.4328102298824037;3.8310905878213375;1.0850361147837728;-2.6768948308075537];
LW2_1 = [2.8882646394178031 2.2296579876999241 -5.0884418107592806 -4.0197567219934829 4.1115023673521485 1.2920339878423814 -0.19683476122253452 4.0176298135492869 1.938533926220936 -4.4769147477100395 -0.1727108218003835 -1.9667729648695484 -2.6707828840112633 0.55002086199729405 0.028991419589108256 -2.7283076257490348 -6.4724550055216081 -3.245120510620489 2.2590929185586983 -0.57322467135051969;-5.3901214839656628 -0.42548098935706075 2.7122679569855772 1.9238132805398256 -3.6465733331092638 1.2539373511127037 -0.42271287036736321 3.6734575919529218 -0.62443533831886944 -6.6456007682665392 0.66580927625247044 1.5100556066286577 -1.7192704011501574 -1.3090061131955786 -8.1407253683074394 -1.04911087049563 2.423907440566027 1.3719310177918487 -2.1981600856709589 2.6153683587475198;8.7759225343172034 4.7051506170239987 6.5693365351424609 1.0683781446636367 7.6669008722616008 2.3785029010153576 -5.3400759654835657 -4.6300271545118958 -1.743530136827937 -3.631813026828334 2.3324013127239493 -0.059893726424742347 5.2840068265884037 0.62309693396778254 10.274403347090153 -5.585918361211534 -4.7884572418160332 -3.1853425791624113 -1.6497904145332896 0.10479602857351042;-4.1485941452197412 -4.994143559595976 -4.0822597287748321 1.9561768934869497 -1.299089219564219 0.70181250756194868 1.1257864286547936 -6.822004638103027 -2.1473450389223481 -3.1299478203774118 -4.313687032057496 3.6874737060817169 -6.3361917787263602 3.3003537208936713 -6.855050802484624 4.4603355907929689 1.6839030350604105 -3.043904618042609 6.0237051102776293 -3.7492322477079552;-2.5582171579710331 -3.723796777168026 -6.1269023157010878 2.6845090300717711 -4.8955614225031105 -7.2071210393786309 2.6338036764836312 2.6581894071704695 0.62176152034484522 5.8011096507516271 6.9292100986609171 4.1484374157878783 0.014657038803515432 0.33035219819150879 4.6139567118726745 -2.9363993297891513 0.51025651056630927 -1.2564994602200501 4.3604844080215379 -0.25898088008548986;-3.3480134676371938 -1.1673844052292108 -6.7858853091706095 -3.782027490713932 2.2544379352652499 1.0484911800743952 -4.3720291069580579 -0.31450229901355559 -2.449248614132157 8.6786365136661185 -7.0581276647286044 -5.3662635370260228 -4.3526169739168949 5.160433941071088 -3.6614692138215323 1.5861387163084455 4.1899243764259584 3.8999438594064544 -2.1285193583354429 -2.7393253961640056;-1.8354028866497105 -2.1110457762389347 4.3116816002676455 -8.0738068336497939 -9.2960407310739868 0.63879233431018112 2.8456489905181552 -0.59883978692764417 4.1883396767489076 -6.8801241755171745 1.8071175026514912 -7.99377982282817 1.0452749058371344 -6.222502431380077 4.7464834849974169 -1.1656825168373521 -0.20372913844562701 4.8322253927386374 -0.86423822297743025 -4.4612708842797826;4.4963409427265111 9.890560168014046 5.9868836428114944 2.1492443875127938 -0.082504556468991561 2.7552276032752228 5.9296886673902121 -0.56336006043261322 -7.1574126853125692 2.0985881739391585 0.25685913701094243 5.9124758696975137 4.0787295022057561 0.57376562249527119 -0.65330221837868374 6.7062294647678353 7.0509530471986874 0.92887786790713411 -3.7900260221072184 7.3123164633026683;-1.0011206430984652 -5.6944609164999358 1.9301038125543735 5.4013531150551888 3.1840423275097796 -2.7650960133393143 -1.8242183718041094 3.4769795377461881 8.3537668619641767 8.1029132304014251 0.028681243505652199 0.89664380035919267 5.8214174542915771 -3.6620052482377297 0.61207750906937641 0.86485794578634456 -2.3075159609518168 -0.89482330523745923 0.14198318948081293 1.7722995700115383];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
